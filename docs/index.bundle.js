!function(){function showOpenFilePicker(){return new Promise(function(t,e){var i=document.createElement("input");i.type="file",document.body.append(i),i.style.display="none",i.click(),i.onchange=function(){t(i.files),i.remove()}})}var getEventHandle=function(){var o=[];return function(){var n=o.length;return o.push({}),{on:function(t,e){return o[n][t]||(o[n][t]=[]),o[n][t].push(e),!0},off:function(t,e){if(o[n][t])for(var i=0;i<o[n][t].length;i++)if(o[n][t][i]===e)return o[n][t].splice(i,1),!0;return!1},doevent:function(t,e){if(!o[n][t])return!1;for(var i=0;i<o[n][t].length;i++)o[n][t][i].apply(null,e);return!0}}}}(),util=function(){"#extdheodqp2eidhjwe"==location.hash?(console.log("插件模式"),window.isExt=!0):(console.log("网页模式"),window.isExt=!1);var n=[],o=0;return window.addEventListener("message",function(t){if("xhr_cb"==t.data.type)for(var e=t.data.id,i=0;i<n.length;i++)if(n[i].id==e){"function"==typeof n[i][t.data.fn]&&n[i][t.data.fn](t.data.data),1==t.data.finish&&n.slice(i,1);break}}),{deepClone:function(t){const s=new WeakMap;function a(t){return"object"==typeof t&&t||"function"==typeof t}return function i(n){if(!a(n))return n;if([Date,RegExp].includes(n.constructor))return new n.constructor(n);if("function"==typeof n)return new Function("return "+n.toString())();var t=s.get(n);if(t)return t;if(n instanceof Map){const o=new Map;return s.set(n,o),n.forEach((t,e)=>{a(t)?o.set(e,i(t)):o.set(e,t)}),o}if(n instanceof Set){const o=new Set;return s.set(n,o),n.forEach(t=>{a(t)?o.add(i(t)):o.add(t)}),o}var t=Reflect.ownKeys(n),e=Object.getOwnPropertyDescriptors(n);const o=Object.create(Object.getPrototypeOf(n),e);return s.set(n,o),t.forEach(t=>{var e=n[t];a(e)?o[t]=i(e):o[t]=e}),o}(t)},requestByExt:function(t){o++,t.id=o,n.push(t);var e,i=this.deepClone(t);for(e in i)"function"==typeof i[e]&&(i[e]={_t:"fn",_n:e});parent.postMessage({type:"xhr",data:i,id:o},"*")},addStyle:function(t){var e=util.element("style");e.innerHTML=t,document.head.appendChild(e)},initSet:function(t,e,i){var n=t.get(e);if("object"==typeof n&&n){for(var o in i)n[o]||(n[o]=i[o]);t.set(e,n)}else t.set(e,i)},joinObj:function(){var t=arguments,e=t[0];for(var i=1;i<t.length;i++)e=function(t,e){for(var i in e)t[i]=e[i];return t}(e,t[i]);return e},loadimg:function(t,e){var i=new Image;i.src=t,i.onload=function(){e(!0)},i.onerror=function(){e(!1)}},element:function(t,e={}){var i,n=document.createElement(t);for(i in e)n.setAttribute(i,e[i]);return n},query:function(t,e,i){return t["querySelector"+(i?"All":"")](e)},getFavicon:function(t,e){try{var i=new URL(t)}catch(t){return void e(!1)}var n="https://api.xinac.net/icon/?url="+i.origin;-1!=i.hostname.indexOf("bing.com")&&(n="https://bing.com/favicon.ico"),this.loadimg(n,function(t){e(!!t&&n)})},createIcon:function(t){var e=document.createElement("canvas"),i=(e.width=64,e.height=64,e.getContext("2d"));return i.fillStyle=this.getRandomColor(),i.font="bold 32px Arial",i.fillText(t,20,40),e.toDataURL()},getRandomColor:function(){return"#"+Math.random().toString(16).substring(2,8).toUpperCase()},fangdou:function(e,i){var n=null;return function(){n&&clearTimeout(n);var t=this;n=setTimeout(function(){e.apply(t,arguments)},i)}},jsonp:function(t,e,i){var n="a"+Math.random().toString(36).slice(2),o=this.element("script",{src:function(t,e,i){t=new URL(t);return t.searchParams.set(e,i),t.href}(t,i||"callback",n)});document.body.appendChild(o),window[n]=function(t){e(t),document.body.removeChild(o),delete window[n]}},xhr:function(t,e,i){var n=new XMLHttpRequest;return n.onreadystatechange=function(){4==n.readyState&&200==n.status&&e(n.responseText)},n.onerror=function(){i&&i({status:n.status,statusText:n.statusText,readyState:n.readyState,responseText:n.responseText})},n.open("GET",t,!0),n.send(),{abort:function(){n.abort()}}},checkSession:function(t){return t.isSession&&"Hvm_session_token_eoi1j2j"===t.session_token},getRandomHashCache:function(){return Math.random().toString(36).slice(2)+Date.now().toString(36)},copyText:function(t){var e;navigator.clipboard?navigator.clipboard.writeText(t):((e=document.createElement("input")).value=t,e.style.display="none",document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e)),toast.show("复制成功")},getGoogleIcon:function(t,e){return'<span class="material-symbols-outlined'+(e&&e.type?" "+e.type:"")+'">&#x'+t+";</span>"},checkDetailsCorrect:function(t,e){for(var i=0;i<e.length;i++)if(0==t.hasOwnProperty(e[i]))return!1;return!0},checkUrl:function(t){return/^(https?:\/\/)?([a-zA-Z0-9\.\-]+(\:[a-zA-Z0-9\.&%\$\-]+)*@)?((25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[1-9])\.(25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[1-9]|0)\.(25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[0-9])|([a-zA-Z0-9\-]+\.)*[a-zA-Z0-9\-]+\.[a-zA-Z]{2,4})(\:[0-9]+)?(\/[^\/][a-zA-Z0-9\.\,\?\'\\\/\+&%\$#\=~_\-@]*)*(\/)?$/.test(t)},b0:function(t){return t<10?"0"+t:t}}}(),toast=function(){var i=util.element("div",{class:"toast"}),n=null,o=null;return util.query(document,"body").append(i),{show:function(t,e){i.innerHTML=t,i.classList.add("show"),i.style.animation="toastin .3s",clearTimeout(n),clearTimeout(o),n=setTimeout(function(){i.style.animation="toastout .3s",o=setTimeout(function(){i.classList.remove("show")},298)},e||2e3)}}}(),iconc=function(){function t(t){this.content=t.content,this.width=t.width;var e=util.element("div",{class:"item"+(t.class?" "+t.class:"")+(t.important?" important":"")});i[t.offset].append(e),e.innerHTML=this.content,this.element=e,this.width&&(e.style.width=this.width+"px")}var i={tl:util.query(document,".topper .left"),tr:util.query(document,".topper .right"),bl:util.query(document,".bottomer .left"),br:util.query(document,".bottomer .right")};return t.prototype={getIcon:function(){return this.element},setIcon:function(t){this.content=t,this.element.innerHTML=this.content},setWidth:function(t){this.width=t,this.width&&(ic.style.width=this.width+"px")},getWidth:function(){return this.width},show:function(){this.element.classList.remove("hide"),this.element.classList.add("show")},hide:function(){this.element.classList.add("hide"),this.element.classList.remove("show")}},{icon:t}}(),{storage,getStorageList,getAllStorage,dbTool}=function(){localStorage.quik2||(localStorage.quik2="{}");function t(o,i){function s(t,e,i){if(!e)return a()[o][t];if(!l)throw new Error("indexedDB is not support in this browser");r.get(a()[o][t],function(t){i(t)})}function a(){return JSON.parse(localStorage.getItem("quik2"))}function c(t){var e=a();e[o]=t,localStorage.setItem("quik2",JSON.stringify(e)),n.doevent("storage",[{key:o,value:t}]),i&&!i.websync&&i.sync&&n.doevent("websync",[{key:o,value:t}])}if("string"==typeof o)return JSON.parse(localStorage.getItem("quik2"))[o]||c({}),e[o]=i,{get:s,websync:function(t){n.doevent("websync",[{key:o,value:t,sp:!0}])},set:function(i,t,e,n){if(e){if(!l)throw new Error("indexedDB is not support in this browser");s(i)&&r.delete(s(i)),r.set(t,function(t){var e=a();e[o][i]=t,c(e[o]),n(t)})}else{e=a();e[o][i]=t,c(e[o])}},remove:function(e,t,i){var n=a();if(t){if(!l)throw new Error("indexedDB is not support in this browser");r.delete(n[o][e],function(){var t=a();delete t[o][e],c(t),i()})}else delete n[o][e],c(n[o])},list:function(){return Object.keys(a()[o])},getAll:function(){return a()[o]},clear:function(){var t,e=a()[o];for(t in e){var i=t[e];"string"==typeof i&&i.startsWith("^")&&r.delete(i)}c({})}};throw new Error("ck is not a string")}var n=getEventHandle(),l=localforage._getSupportedDrivers([localforage.INDEXEDDB])[0]==localforage.INDEXEDDB,r={get:function(t,e){localforage.getItem(t).then(e)},set:function(t,e){var i="^"+util.getRandomHashCache();localforage.setItem(i,t).then(function(){e(i)})},delete:function(t,e){localforage.removeItem(t).then(e)}},e={};return t.checkIDB=function(){return l},t.on=n.on,t.off=n.off,{storage:t,getStorageList:function(){return e},getAllStorage:function(){return JSON.parse(localStorage.getItem("quik2"))},dbTool:r}}(),dialog=function(){function n(t){this.options=t;var e=util.element("div",{class:"dialog"}),i=(e.innerHTML=`<div class="d-b"></div><div class="d-c">${t.content}</div>`,util.query(document,".dialogs").append(e),util.query(e,".d-c"));t.class&&i.classList.add(t.class),1==t.mobileShowtype&&e.classList.add("mobile-show-full"),this.element=e,this.id=s,s++,e.setAttribute("data-id",this.id),e.querySelector(".d-b").addEventListener("click",function(){window.innerWidth<=650&&a(this.parentElement.getAttribute("data-id")).close()}),o.push(this)}var o=[],t=1,s=0;function a(e){var i=null;return o.forEach(function(t){t.id==e&&(i=t)}),i}return n.SHOW_TYPE_FULLSCREEN=1,n.SHOW_TYPE_DIALOG=2,n.iframeDialogBuilder=function(t,e=1){var i=new n({content:`<div class="material-symbols-outlined closebtn">&#xE5CD;</div><iframe src="${t}" class="dialog-iframe"></iframe>`,class:"iframe-dialog",mobileShowtype:e}),t=i.getDialogDom();return util.query(t,".closebtn").onclick=function(){i.close()},this.closed=!0,i},n.getDialogById=a,n.prototype={open:function(){this.element.classList.add("show"),this.element.style.zIndex=t,t++,this.closed=!1,this.onopen&&this.onopen(),util.query(this.element,"img[data-src]",!0).forEach(function(t){t.src=t.getAttribute("data-src"),t.removeAttribute("data-src")})},close:function(){this.element.classList.remove("show"),this.closed=!0,this.onclose&&this.onopen()},destory:function(){this.element.remove(),o.splice(o.indexOf(this),1)},getDialogDom:function(){return util.query(this.element,".d-c")}},n}(),menu=function(){function t(t){this.options=t;var i=util.element("div",{class:"contextMenu"});t.offset&&(i.style.top=t.offset.top+"px",i.style.left=t.offset.left+"px",i.style.bottom=t.offset.bottom+"px",i.style.right=t.offset.right+"px"),t.list.forEach(function(t){var e=util.element("div",{class:"item"});e.innerHTML=`<div class="icon">${t.icon}</div><div class="title">${t.title}</div>`,e.onclick=function(){t.click()},i.appendChild(e)}),document.body.appendChild(i),this.element=i}return t.prototype={show:function(){this.element.classList.add("show"),this.element.style.height="auto";var t=this.element.getBoundingClientRect().height,e=(this.element.style.height="0px",this.element.style.transition="height .2s",this);setTimeout(function(){e.element.style.height=t+"px"})},hide:function(){this.element.style.height="0px";var t=this;setTimeout(function(){t.element.style.transition="none",t.element.classList.remove("show")},200)},isShow:function(){return this.element.classList.contains("show")},destory:function(){this.element.remove()},setOffset:function(t){this.options.offset=t;var t=this.options,e=this.element;e.style.top="",e.style.left="",e.style.bottom="",e.style.right="",t.offset&&("number"==typeof t.offset.top?e.style.top=t.offset.top+"px":e.style.bottom=t.offset.bottom+"px","number"==typeof t.offset.left?e.style.left=t.offset.left+"px":e.style.right=t.offset.right+"px")},setList:function(t){this.options.list=t;var t=this.options,i=this.element;i.innerHTML="",t.list.forEach(function(t){var e=util.element("div",{class:"item"});e.innerHTML=`<div class="icon">${t.icon}</div><div class="title">${t.title}</div>`,e.onclick=function(){t.click()},i.appendChild(e)})}},document.addEventListener("click",function(){document.querySelectorAll(".contextMenu").forEach(function(t){t.style.height="0px",setTimeout(function(){t.style.transition="none",t.classList.remove("show")},200)})}),t}(),mainmenu=function(){var t=new iconc.icon({class:"main_menu",content:util.getGoogleIcon("e5d2"),offset:"tr"}),i=[],n=[],o=new menu({list:[],offset:{top:40,right:15}});t.getIcon().onclick=function(t){t.stopPropagation(),o.show()};return{pushMenu:function(t,e){(1==e?n:i).push(t),o.setList(i.concat(n))},MAIN_MENU_BOTTOM:1,MAIN_MENU_TOP:0}}(),setting=function(){var t=storage("setting",{title:"设置",desc:"QUIK起始页的各项设置",sync:!0}),e=(i.prototype={addNewGroup:function(t){this.groups.push(t);var i=this;t.on("change",function(e,t){i._dochange({type:e.type,details:e.details,id:e.id}),"it"==e.type?i._dochangeGroup(t,e.details):"add"==e.type?i._drawItem(t,t.items[t.items.length-1]):"change"==e.type&&("reinit"==e.details.attr?i._reinitItem(t,t.items.find(t=>t.id==e.id),e.details):"reget"==e.details.attr?i._regetItem(t.items.find(t=>t.id==e.id),e.details):i._dochangeItem(t,t.items.find(t=>t.id==e.id),e.details))}),i._dochange({type:"addgroup"}),i._drawGroup(t)},setTitle:function(t){this.title=t,util.query(this.dialogDom,".actionbar h1").innerText=t,_._dochange({type:"changetitle",title:t})},open:function(){this.dialog.open()},close:function(){this.dialog.close()},on:function(t,e){this._events[t]&&this._events[t].push(e)},_dochange:function(e){var i=this;this._events.change.forEach(function(t){t(e,i)})},_drawGroup:function(e){for(var i=this,t=util.element("li",{class:"setting-group","data-index":e.index,"data-id":e.id}),n=(t.innerHTML='<div class="setting-group-title"></div><ul class="setting-tree"></ul>',util.query(this.dialogDom,".setting-root")),o=n.children,s=!0,a=0;a<o.length;a++)if(parseInt(o[a].getAttribute("data-index"))>e.index){n.insertBefore(t,o[a]),s=!1;break}s&&n.appendChild(t),util.query(t,".setting-group-title").innerText=e.title,e.items.forEach(function(t){i._drawItem(e,t)})},_drawItem:function(t,n){for(var e=util.element("li",{class:"setting-item","data-index":n.index,"data-id":n.id}),i=(e.innerHTML='<div class="setting-item-left"><div class="setting-item-title"></div><div class="setting-item-message"></div></div><div class="setting-item-right"></div>',util.query(this.dialogDom,".setting-group[data-id="+t.id+"] .setting-tree")),o=i.children,s=!0,a=0;a<o.length;a++)if(parseInt(o[a].getAttribute("data-index"))>n.index){i.insertBefore(e,o[a]),s=!1;break}s&&i.appendChild(e),util.query(e,".setting-item-title").innerText=n.title,n.message?util.query(e,".setting-item-message").innerText=n.message:e.classList.add("no-message");var c=util.query(e,".setting-item-right"),l=function(){};function r(){var t;"null"!=n.type&&((t=n.get())instanceof Promise?t.then(l):l(t))}({string:function(){c.innerHTML='<input type="text" class="setting-item-input">',l=function(t){util.query(c,".setting-item-input").value=t}},number:function(){c.innerHTML='<input type="number" class="setting-item-input">',l=function(t){util.query(c,".setting-item-input").value=t}},boolean:function(){c.innerHTML='<div class="check-box"><div class="check-box-inner"></div><input type="checkbox" class="setting-item-input"></div>',l=function(t){(util.query(c,".setting-item-input").checked=t)&&util.query(c,".check-box").classList.add("checked"),util.query(c,".check-box").addEventListener("click",function(){util.query(c,".setting-item-input").click(),util.query(c,".setting-item-input").checked?this.classList.add("checked"):this.classList.remove("checked")})}},range:function(){c.innerHTML='<input type="range" class="setting-item-input">',l=function(t){util.query(c,".setting-item-input").value=t};var t=n.init();function e(t){util.query(c,".setting-item-input").max=t[1],util.query(c,".setting-item-input").min=t[0]}t instanceof Promise?t.then(e):e(t)},select:function(){c.innerHTML='<select class="setting-item-input"></select>',l=function(t){e=t};var e,t=n.init();function i(i){util.query(c,".setting-item-input").innerHTML=(()=>{var t,e="";for(t in i)e+=`<option value="${t}">${i[t]}</option>`;return e})(),l=function(t){util.query(c,".setting-item-input").value=t},e&&l(e)}t instanceof Promise?t.then(i):i(t)},null:function(){c.innerHTML=`<div class="setting-item-input null-click">${util.getGoogleIcon("e5e1")}</div>`,e.classList.add("just-callback-item"),e.onclick=function(){n.callback()}}})[n.type](),r(),n.getacb=r,util.query(c,".setting-item-input").addEventListener("range"==n.type?"input":"null"==n.type?"click":"change",function(t){var e;this.classList.contains("null-click")||(e="checkbox"==this.type?this.checked:this.value,"function"!=typeof n.check||n.check(e)?n.callback(e):r())})},_dochangeGroup:function(t,e){var i=util.query(this.dialogDom,".setting-group[data-id="+t.id+"]");if("title"==e.attr)util.query(i,".setting-group-title").innerText=e.content;else if("index"==e.attr){i.setAttribute("data-index",e.content);for(var n=util.query(this.dialogDom,".setting-root"),o=n.children,s=!0,a=0;a<o.length;a++)if(!o[a].isSameNode(i)&&parseInt(o[a].getAttribute("data-index"))>e.content){n.insertBefore(i,o[a]),s=!1;break}s&&n.appendChild(i)}else"show"==e.attr&&(i.style.display=e.content?"block":"none")},_dochangeItem:function(t,e,i){var n=util.query(this.dialogDom,".setting-group[data-id="+t.id+"] .setting-item[data-id="+e.id+"]");if("title"==i.attr)util.query(n,".setting-group-title").innerText=i.content;else if("message"==i.attr)i.content?(util.query(n,".setting-item-message").innerText=i.content,n.classList.remove("no-message")):n.classList.add("no-message");else if("index"==i.attr){n.setAttribute("data-index",i.content);for(var o=util.query(this.dialogDom,".setting-group[data-id="+t.id+"] .setting-tree"),s=o.children,a=!0,c=0;c<s.length;c++)if(!s[c].isSameNode(n)&&parseInt(s[c].getAttribute("data-index"))>i.content){o.insertBefore(n,s[c]),a=!1;break}a&&o.appendChild(n)}else"show"==i.attr&&(n.style.display=i.content?"block":"none")},_reinitItem:function(t,e){var i,t=util.query(this.dialogDom,".setting-group[data-id="+t.id+"] .setting-item[data-id="+e.id+"]"),n=util.query(t,".setting-item-right");if("range"==e.type)i=function(t){util.query(n,".setting-item-input").max=t[1],util.query(n,".setting-item-input").min=t[0]};else{if("select"!=e.type)return;i=function(i){util.query(n,".setting-item-input").innerHTML=(()=>{var t,e="";for(t in i)e+=`<option value="${t}">${i[t]}</option>`;return e})(),cb=function(t){util.query(n,".setting-item-input").value=t},guaqi&&cb(guaqi)}}t=e.init();t instanceof Promise?t.then(i):i(t)},_regetItem:function(t){t.getacb()}},i);function i(t){this.title=t.title,this.dialog=new dialog({content:`<div class="actionbar"><h1>设置</h1><div class="closeBtn">${util.getGoogleIcon("e5cd")}</div></div><ul class="setting-root"></ul>`,class:"setting_dia",mobileShowtype:dialog.SHOW_TYPE_FULLSCREEN}),this.dialogDom=this.dialog.getDialogDom(),util.query(this.dialogDom,".closeBtn").addEventListener("click",()=>{this.dialog.close()}),util.query(this.dialogDom,".actionbar h1").innerText=this.title,this.groups=[],this._events={change:[]}}n=0,s.prototype={addNewItem:function(t){this.items.push(t);var i=this;t.on("change",function(t,e){i._dochange({type:"change",details:t,id:e.id})}),i._dochange({type:"add"})},setTitle:function(t){this.title=t,this._dochange({type:"it",details:{attr:"title",content:t}})},setIndex:function(t){this.index=t,this._dochange({type:"it",details:{attr:"index",content:t}})},on:function(t,e){this._events[t]&&this._events[t].push(e)},show:function(){this.show=!0,this._dochange({type:"it",details:{attr:"show",content:!0}})},hide:function(){this.show=!1,this._dochange({type:"it",details:{attr:"show",content:!1}})},_dochange:function(e){var i=this;this._events.change.forEach(function(t){t(e,i)})}};var n,o=s;function s(t){this.title=t.title,this.index=t.index,this.index<0&&(this.index=0),this.items=[],this.id="seg_"+n,n++,this._events={change:[]}}a=0,l.prototype={reInit:function(){this._dochange({attr:"reinit"})},reGet:function(){this._dochange({attr:"reget"})},setTitle:function(t){this.title=t,this._dochange({attr:"title",content:t})},setIndex:function(t){this.index=t,this._dochange({attr:"index",content:t})},setMessage:function(t){this.message=t,this._dochange({attr:"message",content:t})},show:function(){this._show=!0,this._dochange({attr:"show",content:!0})},hide:function(){this._show=!1,this._dochange({attr:"show",content:!1})},on:function(t,e){this._events[t]&&this._events[t].push(e)},_dochange:function(e){var i=this;this._events.change.forEach(function(t){t(e,i)})}};var a,c=l;function l(t){this.title=t.title,this.index=t.index,this.type=t.type,this.init=t.init,this.check=t.check,this.callback=t.callback,this.message=t.message,this.get=t.get,this._show=!0,this.id="sei_"+a,a++,this._events={change:[]}}r=new e({title:"设置"}),mainmenu.pushMenu({icon:util.getGoogleIcon("e8b8",{type:"fill"}),title:"主设置",click:function(){r.open()}},mainmenu.MAIN_MENU_TOP);var r,u=r,d=(new iconc.icon({content:util.getGoogleIcon("e8b8",{type:"fill"}),offset:"bl"}).getIcon().onclick=function(){u.open()},new o({title:"通用",index:0}));return u.addNewGroup(d),{Setting:e,SettingGroup:o,SettingItem:c,mainSetting:u,tyGroup:d,settingSto:t}}(),Setting=setting.Setting,SettingGroup=setting.SettingGroup,SettingItem=setting.SettingItem,mainSetting=setting.mainSetting,tyGroup=setting.tyGroup,omnibox=function(){var{on,off,doevent}=getEventHandle(),sg=new SettingGroup({title:"搜索框",index:1}),core=(mainSetting.addNewGroup(sg),function(){function e(t){for(var e=0;e<a.enter.length;e++)if(a.enter[e].check(t))return a.enter[e]}function t(t){a.enter.unshift(t)}function i(t){a.SA.push(t)}var a={SA:[],enter:[]},n=setting.settingSto,c=(null==n.get("ob_justsearch")&&n.set("justsearch",!1),[]),o=function(){var n,t,i,o,s,e;if(storage)return n=storage("search",{sync:!0,title:"搜索引擎",desc:"搜索引擎配置",compare:function(t,e,i){var n=s();for(e in i.typelist)n[e]=i.typelist[e];i.typelist=n,t[e]=i}}),e={bing:"https://cn.bing.com/search?q="+(t="%keyword%"),baidu:"https://www.baidu.com/s?wd="+t,so:"https://so.com/s?q="+t,sogou:"https://sogou.com/web?query="+t,google:"https://google.com/search?q="+t},n.get("typelist")||n.set("typelist",e),n.get("type")||n.set("type","bing"),i={},o=function(t,e){i[t]&&i[t].forEach(function(t){t.apply(null,e)})},e={getSearchType:function(){return n.get("typelist")[n.get("type")]},on:function(t,e){i[t]?i[t].push(e):i[t]=[e]},setSearchList:function(t){if(0==Object.keys(t).length)throw new Error("newList is empty");n.set("typelist",t);var e=n.get("typelist"),i=(o("typelistchange"),n.get("type"));e[i]!=t[i]&&o("nowtypechange")},getSearchTypeList:s=function(){return n.get("typelist")},setSearchType:function(t){n.set("type",t),o("nowtypechange")},getSearchTypeIndex:function(){return n.get("type")}},Object.defineProperty(e,"keywordText",{get:function(){return t}}),e}();function s(t){return!n.get("ob_justsearch")&&util.checkUrl(t)}t({check:function(){return!0},enter:function(t){open(o.getSearchType().replace(o.keywordText,t))},icon:":searchtype",submit:util.getGoogleIcon("E8B6")}),t({check:s,enter:function(t){-1==t.indexOf("://")&&(t="http://"+t),open(t)},icon:util.getGoogleIcon("E80B"),submit:util.getGoogleIcon("E89E")}),i({check:function(t){return!!t},get:function(t,e){e=e();return e.unshift({icon:util.getGoogleIcon("E8B6"),text:t,click:function(){open(o.getSearchType().replace(o.keywordText,t))}}),e}});var l=null,r=(i({check:function(t){return!!t},get:function(e,n){return new Promise(function(i,t){l=util.jsonp("https://www.baidu.com/sugrec?pre=1&p=3&ie=utf-8&json=1&prod=pc&from=pc_web&wd="+e,function(t){var e=n();l=null,t.g&&t.g.forEach(function(t){e.push({icon:util.getGoogleIcon("E8B6"),text:t.q,click:function(){open(o.getSearchType().replace(o.keywordText,t.q))}})}),i(e)},"cb")})},interrupt:function(){l&&(l.abort(),l=null)}}),i({check:s,get:function(n,o){return new Promise(function(t,e){var i=o();i.unshift({icon:util.getGoogleIcon("E80B"),text:n,click:function(){-1==n.indexOf("://")&&(n="http://"+n),open(n)}}),t(i)})}}),new SettingItem({title:"搜索框仅搜索",index:1,type:"boolean",message:"打开后，搜索框将失去打开链接的功能",get:function(){return!!n.get("ob_justsearch")},callback:function(t){return n.set("ob_justsearch",t),!0}}));return sg.addNewItem(r),{getSA:function(t,i){0<c.length&&c.forEach(function(t){a.SA[t].interrupt()});for(var n,o=[],e=a.SA.length,s=0;s<e;s++)a.SA[s].check(t)&&((n=a.SA[s].get(t,function(){return o}))instanceof Promise?(c.push(s),function(e){n.then(function(t){o=t,c.splice(c.indexOf(e),1),i(o)})}(s)):i(o=n))},enter:function(t){doevent("beforeenter",[t]),e(t).enter(t),doevent("afterenter",[t])},getType:e,addNewType:t,addNewSA:i,searchUtil:o,initsto:n,setJustSearch:function(t){n.set("ob_justsearch",t),r.reGet()}}}()),ui=function(){"use strict";var t=util.element("div",{class:"searchbox"}),e=util.element("div",{class:"cover searchcover"}),i=util.element("div",{class:"searchpadding"}),n=(t.innerHTML='<div class="box"><div class="icon"></div><div class="input"><input type="text" placeholder="搜索或输入网址"></div><div class="submit"></div></div><ul class="sas"></ul>',t.addEventListener("click",function(t){t.stopPropagation()}),util.query(document,"main").append(t),util.query(document,"main").append(e),util.query(document,"main .center").append(i),util.query(t,"div.icon")),o=util.query(t,"div.input input"),s=util.query(t,"div.submit"),a=util.query(t,"ul.sas");function c(t){var e,t=core.getType(t);":"==t.icon[0]?(n.setAttribute("data-teshu",t.icon),(e=":searchtype"==t.icon?new Promise(function(e,t){util.getFavicon(core.searchUtil.getSearchType(),function(t){e(t?'<img src="'+t+'"/>':'<img src="'+util.createIcon("s")+'"/>')})}):"")instanceof Promise?e.then(function(t){n.innerHTML=t}):n.innerHTML=e):(n.innerHTML=t.icon,n.removeAttribute("data-teshu")),":"==t.submit[0]?(s.setAttribute("data-teshu",t.submit),s.innerHTML=(t.submit,"")):(s.innerHTML=t.submit,s.removeAttribute("data-teshu"))}function l(){c(this.value.trim()),a.innerHTML="",core.getSA(this.value.trim(),function(t){var e=(e=util.query(a,"li.active"))&&{icon:util.query(e,"div.saicon").innerHTML,text:util.query(e,"div.sa_text").innerHTML};a.innerHTML="",t.forEach(function(t){var e=util.element("li");e.innerHTML=`<div class="saicon">${t.icon}</div><div class="sa_text">${t.text}</div>`,a.append(e),e.onclick=t.click}),e&&util.query(a,"li",!0).forEach(function(t){util.query(t,"div.saicon").innerHTML&&util.query(t,"div.sa_text").innerHTML==e.text&&t.classList.add("active")})}),doevent("input",[o.value])}o.oninput=util.fangdou(l,300),o.onkeydown=function(t){var e;"Enter"==t.key?(e=util.query(a,"li.active"))?e.click():core.enter(this.value):"ArrowUp"==t.key?(t.preventDefault(),(e=util.query(a,"li.active"))&&(e.classList.remove("active"),e.previousElementSibling)&&e.previousElementSibling.classList.add("active")):"ArrowDown"==t.key?(t.preventDefault(),(e=util.query(a,"li.active"))?e.nextElementSibling&&(e.classList.remove("active"),e.nextElementSibling.classList.add("active")):util.query(a,"li").classList.add("active")):"ArrowRight"==t.key&&(e=util.query(a,"li.active"))&&(o.value=util.query(e,".sa_text").innerText,l.call(this))},o.addEventListener("focus",function(){e.classList.add("active"),t.classList.add("active"),doevent("focus",[o])}),o.addEventListener("blur",function(){this.classList.remove("active"),doevent("blur",[o])}),document.addEventListener("click",function(){e.classList.remove("active"),t.classList.remove("active")}),s.onclick=function(){core.enter(o.value)};var r=util.element("div",{class:"searchtypeselector"});function u(){var t,e=util.query(r,"ul"),i=core.searchUtil.getSearchTypeIndex(),n=(e.innerHTML="",core.searchUtil.getSearchTypeList());for(t in n){var o=util.element("li");o.innerHTML="<img/>",!function(e,t){util.getFavicon(n[t],function(t){e.querySelector("img").src=t||util.createIcon("s")})}(o,t),o.setAttribute("data-type",t),e.append(o),t==i&&o.classList.add("active"),o.onclick=function(){var t=util.query(r,"ul li.active");t&&t.classList.remove("active"),this.classList.add("active"),core.searchUtil.setSearchType(this.getAttribute("data-type")),r.classList.remove("active")}}r.style.width=36*util.query(e,"li",!0).length+"px"}r.innerHTML="<ul></ul>",util.query(document,"main .center").append(r),n.addEventListener("click",function(){r.classList.contains("active")?r.classList.remove("active"):r.classList.add("active")}),core.searchUtil.on("nowtypechange",function(){":searchtype"==n.getAttribute("data-teshu")&&c(o.value)}),core.searchUtil.on("typelistchange",function(){u()}),u(),c(""),null==core.initsto.get("ob_autofocus")&&core.initsto.set("ob_autofocus",!1),core.initsto.get("ob_autofocus")&&setTimeout(function(){o.focus()});var d=new SettingItem({title:"自动聚焦",index:1,type:"boolean",message:"打开页面自动聚焦搜索框",get:function(){return!!core.initsto.get("ob_autofocus")},callback:function(t){return core.initsto.set("ob_autofocus",t),!0}});return sg.addNewItem(d),{setValue:function(t){o.value=t,o.focus(),l.call(o)},focus:function(){o.focus()},blur:function(){o.blur()},isblur:function(){return!o.classList.contains("active")},setAutoFocus:function(t){core.initsto.set("ob_autofocus",t),d.reGet()}}}();return function(){var si=new SettingItem({title:"自动计算",index:2,type:"boolean",message:"搜索框输入=自动计算后面的内容",get:function(){return!!core.initsto.get("ob_cal")},callback:function(t){return core.initsto.set("ob_cal",t),!0}});sg.addNewItem(si),core.addNewSA({check:function(t){return!!core.initsto.get("ob_cal")&&"="==t[0]},get:function(text,getsa){var a=getsa();try{if(text=text.substr(1),!text)return;var e=Math.E,PI=Math.PI,ln=Math.log,lg=Math.log10,sin=Math.sin,cos=Math.cos,tan=Math.tan,asin=Math.asin,acos=Math.acos,atan=Math.atan,sqrt=Math.sqrt,abs=Math.abs,result=(text=text.replaceAll("^","**").replaceAll("π","PI").replaceAll("[","(").replaceAll("]",")").replaceAll("{","(").replaceAll("}",")"),eval(text));a.unshift({icon:util.getGoogleIcon("ea5f"),text:result,click:function(){ui.setValue(result)}})}catch(e){}r(a)}})}(),function(){var i,t=new SettingItem({title:"自动翻译",index:2,type:"boolean",message:"搜索框输入非中文时自动翻译为中文",get:function(){return!!core.initsto.get("ob_tran")},callback:function(t){return core.initsto.set("ob_tran",t),!0}});sg.addNewItem(t),core.addNewSA({check:function(t){return!!core.initsto.get("ob_tran")&&!util.checkUrl(t)&&(e=(t=t).length,!!(t=t.match(/[a-zA-Z\u3040-\u309F\u30A0-\u30FF\u31F0-\u31FFйцукенгшщзхъфывапролджэячсмитьбюёàâäèéêëîïôœùûüÿçÀÂÄÈÉÊËÎÏÔŒÙÛÜŸÇ\u0530-\u1CDF]/g)))&&.5<t.length/e;var e},get:function(e,o){return new Promise(function(n,t){i=util.xhr("https://api.gumengya.com/Api/Translate?text="+encodeURI(e)+"&from=auto&to=zh",function(t){var e,i=o(),t=JSON.parse(t);200==t.code?(i=o(),e=t.data.result,i.unshift({icon:util.getGoogleIcon("e8e2"),text:e,click:function(){ui.setValue(e)}})):console.log("Translate API Err:",t),n(i)},function(t){console.log("Translate API Err:",t)})})},interrupt:function(){i&&i.abort()}})}(),{value:ui.setValue,focus:ui.focus,blur:ui.blur,isblur:ui.isblur,addNewSug:core.addNewSA,addNewType:core.addNewType,on:on,off:off,getSearchType:core.searchUtil.getSearchType,getSearchTypeList:core.searchUtil.getSearchTypeList,getSearchTypeIndex:core.searchUtil.getSearchTypeIndex,setSearchType:core.searchUtil.setSearchType,setSearchList:core.searchUtil.setSearchList,keywordText:core.searchUtil.keywordText,search:{on:core.searchUtil.on},sg:sg,setAutoFocus:ui.setAutoFocus,setJustSearch:ui.setJustSearch}}(),link=function(){var c=storage("link",{sync:!0,title:"链接",desc:"QUIK起始页链接数据",websync:!0,get:async function(){var t=c.getAll();return"db"==t["storage-mode"]&&(t.links=await localforage.getItem(t.links),t.cate=await localforage.getItem(t.cate)),delete t["storage-mode"],t},rewrite:function(i,n,o){return new Promise(function(e){o["storage-mode"]=c.get("storage-mode"),"db"==c.get("storage-mode")?c.remove("links",!0,function(){dbTool.set(o.links,function(t){o.links=t,c.remove("cate",!0,function(){dbTool.set(o.cate,function(t){o.cate=t,i[n]=o,e()})})})}):(i[n]=o,e())})},compare:function(o,s,a){return new Promise(function(n){if(a["storage-mode"]=c.get("storage-mode"),"db"==a["storage-mode"])c.get("links",!0,function(t){c.remove("links",!0,function(){a.links=l(t,a.links),dbTool.set(a.links,function(t){a.links=t,dbTool.get(o[s].cate,function(i){console.log(i),dbTool.delete(o[s].cate,function(){var t,e=i;for(t in a.cate)e[t]=l(e[t],a.cate[t]);a.cate=e,dbTool.set(a.cate,function(t){a.cate=t,o[s]=a,n()})})})})})});else{a.links=l(c.get("links"),a.links);var t,e=c.get("cate");for(t in a.cate)e[t]=l(e[t],a.cate[t]);a.cate=e,o[s]=a}})}});function l(e,t){if(e){if(!t)return e;for(var i=0;i<e.length;i++)t.find(function(t){return t.title==e[i].title&&t.url==e[i].url})||t.push(e[i])}return t}var a,e,o={change:[]};function n(t,e){var i={title:t.title,url:t.url};return"number"==typeof t.index&&0<=t.index?t.index>e.length?(console.warn("添加链接时，index超出范围，应在0-"+e.length+"之间"),e.push(i)):e.splice(t.index,0,i):e.push(i),e}function r(t,e,i){var n;return!!i[t]&&(n={title:e.title,url:e.url},i[t]=n,"number"==typeof e.index&&0<=e.index&&(e.index>=i.length?console.warn("修改链接时，index超出范围，应在0-"+(i.length-1)+"之间"):(n=i.splice(t,1)[0],i.splice(e.index,0,n))),i)}function u(t){return 1e3<t.url.length?"url":60<t.title.length&&"title"}function d(t,e){o[t].forEach(function(t){t.apply(null,[e])})}function g(t,e){o[t].forEach(function(t){t.apply(null,[e])})}var s,f,h,p,m,v,i,y,b,k,w=storage.checkIDB()?(c.set("storage-mode","db"),a=0,c.get("links")?a++:c.set("links",[],!0,function(){2==++a&&e()}),c.get("cate")?a++:c.set("cate",{},!0,function(){2==++a&&e()}),e=function(){},2==a&&e(),{addLink:function(e,i=function(){}){if(2!=a)throw"初始化未完成";if(!util.checkDetailsCorrect(e,["title","url"]))throw"参数不正确";e.cate?c.get("cate",!0,function(t){t[e.cate]?(t[e.cate]=n(e,t[e.cate]),c.set("cate",t,!0,function(){i({code:0,msg:"添加成功"}),g("change",{cate:e.cate,type:"add",detail:e})})):i({code:-1,msg:"分组不存在"})}):c.get("links",!0,function(t){t=n(e,t),c.set("links",t,!0,function(){i({code:0,msg:"添加成功"}),g("change",{cate:null,type:"add",detail:e})})})},changeLink:function(i,n,o,s=function(){}){if(2!=a)throw"初始化未完成";if(!util.checkDetailsCorrect(o,["title","url"])||"number"!=typeof n)throw"参数错误";i?c.get("cate",!0,function(t){var e;t[i]?(e=r(n,o,t[i]))?(t[i]=e,c.set("cate",t,!0,function(){s({code:0,msg:"修改成功"}),g("change",{cate:i,index:n,type:"change",detail:o})})):s({code:-2,msg:"链接不存在"}):s({code:-1,msg:"分组不存在"})}):c.get("links",!0,function(t){var e=r(n,o,t);e?c.set("links",t=e,!0,function(){s({code:0,msg:"修改成功"}),g("change",{cate:null,index:n,type:"change",detail:o})}):s({code:-2,msg:"链接不存在"})})},deleteLink:function(e,i,n=function(){}){if(2!=a)throw"初始化未完成";e?c.get("cate",!0,function(t){t[e]?t[e][i]?(t[e].splice(i,1),c.set("cate",t,!0,function(){n({code:0,msg:"删除成功"}),g("change",{cate:e,index:i,type:"delete"})})):n({code:-2,msg:"链接不存在"}):n({code:-1,msg:"分组不存在"})}):c.get("links",!0,function(t){t[i]?(t.splice(i,1),c.set("links",t,!0,function(){n({code:0,msg:"删除成功"}),g("change",{cate:null,index:i,type:"delete"})})):n({code:-2,msg:"链接不存在"})})},addCate:function(e,i=function(){}){if(2!=a)throw"初始化未完成";c.get("cate",!0,function(t){t[e]?i({code:-1,msg:"分组已存在"}):(t[e]=[],c.set("cate",t,!0,function(){i({code:0,msg:"添加成功"}),g("change",{cate:e,type:"cateadd"})}))})},renameCate:function(e,i,n=function(){}){if(2!=a)throw"初始化未完成";c.get("cate",!0,function(t){t[e]?(t[i]&&n({code:-2,msg:"分组重名"}),t[i]=t[e],delete t[e],c.set("cate",t,!0,function(){n({code:0,msg:"修改成功"}),g("change",{cate:e,catename:i,type:"caterename"})})):n({code:-1,msg:"分组不存在"})})},deleteCate:function(i,n=function(){}){if(2!=a)throw"初始化未完成";c.get("cate",!0,function(e){e[i]?e[i].length<=1?(delete e[i],c.set("cate",e,!0,function(){n({code:0,msg:"删除成功"}),g("change",{cate:i,type:"catedelete"})})):confirm("确定要删除分组吗？无法恢复！",function(t){t?(delete e[i],c.set("cate",e,!0,function(){n({code:0,msg:"删除成功"}),g("change",{cate:i,type:"catedelete"})})):n({code:-2,msg:"用户取消删除"})}):n({code:-1,msg:"分组不存在"})})},getLinks:function(e,i=function(){}){if(2!=a)throw"初始化未完成";e?c.get("cate",!0,function(t){t[e]?i({code:0,msg:"获取成功",data:t[e]}):i({code:-1,msg:"分组不存在"})}):c.get("links",!0,function(t){i({code:0,msg:"获取成功",data:t})})},getCates:function(e=function(){}){c.get("cate",!0,function(t){console.log(Object.keys(t),c.get("cate")),e({code:0,msg:"获取成功",data:Object.keys(t)})})},getCateAll:function(e=function(){}){c.get("cate",!0,function(t){e({code:0,msg:"获取成功",data:t})})},ready:function(t){2==a?t():e=t},on:function(t,e){o[t]?o[t].push(e):o[t]=[e]},off:function(i,n){o[i]&&o[i].forEach(function(t,e){t===n&&o[i].splice(e,1)})}}):(console.warn("浏览器不支持indexedDB，将在限制模式下使用"),c.set("storage-mode","localstorage"),c.get("links")||c.set("links",[]),c.get("cate")||c.set("cate",{}),{addLink:function(t,e=function(){}){if(!util.checkDetailsCorrect(t,["title","url"]))throw"参数不正确";var i=u(t);console.log(i),i?e({code:-3,msg:"受限模式下，"+i+"长度过长",lm:i}):t.cate?(i=c.get("cate"))[t.cate]?100<i[t.cate].length?e({code:-4,msg:"受限模式下，分组下已超过100条链接，无法添加"}):(i[t.cate]=n(t,i[t.cate]),c.set("cate",i),e({code:0,msg:"添加成功"}),d("change",{cate:t.cate,type:"add",detail:t})):e({code:-1,msg:"分组不存在"}):100<(i=c.get("links")).length?e({code:-4,msg:"受限模式下，分组下已超过100条链接，无法添加"}):(i=n(t,i),c.set("links",i),e({code:0,msg:"添加成功"}),d("change",{cate:null,type:"add",detail:t}))},changeLink:function(t,e,i,n=function(){}){if(!util.checkDetailsCorrect(i,["title","url"])||"number"!=typeof e)throw"参数错误";var o,s=u(i);s?n({code:-3,msg:"受限模式下，"+s+"长度过长",lm:s}):t?(s=c.get("cate"))[t]?(o=r(e,i,s[t]))?(s[t]=o,c.set("cate",s),n({code:0,msg:"修改成功"}),d("change",{cate:t,index:e,type:"change",detail:i})):n({code:-2,msg:"链接不存在"}):n({code:-1,msg:"分组不存在"}):(o=r(e,i,c.get("links")))?(c.set("links",o),n({code:0,msg:"修改成功"}),d("change",{cate:null,index:e,type:"change",detail:i})):n({code:-2,msg:"链接不存在"})},deleteLink:function(t,e,i=function(){}){var n;t?(n=c.get("cate"))[t]?n[t][e]?(n[t].splice(e,1),c.set("cate",n),i({code:0,msg:"删除成功"}),d("change",{cate:t,index:e,type:"delete"})):i({code:-2,msg:"链接不存在"}):i({code:-1,msg:"分组不存在"}):(n=c.get("links"))[e]?(n.splice(e,1),c.set("links",n),i({code:0,msg:"删除成功"}),d("change",{cate:null,index:e,type:"delete"})):i({code:-2,msg:"链接不存在"})},addCate:function(t,e=function(){}){var i=c.get("cate");i[t]?e({code:-1,msg:"分组已存在"}):20<=Object.keys(i).length?e({code:-2,msg:"受限模式下，分组数量不能超过20个"}):(i[t]=[],c.set("cate",i),e({code:0,msg:"添加成功"}),d("change",{cate:t,type:"cateadd"}))},renameCate:function(t,e,i=function(){}){var n=c.get("cate");n[t]?(n[e]&&i({code:-2,msg:"分组重名"}),n[e]=n[t],delete n[t],c.set("cate",n),i({code:0,msg:"修改成功"}),d("change",{cate:t,catename:e,type:"caterename"})):i({code:-1,msg:"分组不存在"})},deleteCate:function(e,i=function(){}){var n=c.get("cate");n[e]?n[e].length<=1?(delete n[e],c.set("cate",n),i({code:0,msg:"删除成功"})):confirm("确定要删除分组吗？无法恢复！",function(t){t?(delete n[e],c.set("cate",n),i({code:0,msg:"删除成功"}),d("change",{cate:e,type:"catedelete"})):i({code:-2,msg:"用户取消删除"})}):i({code:-1,msg:"分组不存在"})},getLinks:function(t,e=function(){}){var i;t?(i=c.get("cate"))[t]?e({code:0,msg:"获取成功",data:i[t]}):e({code:-1,msg:"分组不存在"}):e({code:0,msg:"获取成功",data:i=c.get("links")})},getCates:function(t=function(){}){var e=c.get("cate");t({code:0,msg:"获取成功",data:Object.keys(e)})},getCateAll:function(t=function(){}){t({code:0,msg:"获取成功",data:c.get("cate")})},ready:function(t){t()},on:function(t,e){o[t]?o[t].push(e):o[t]=[e]},off:function(i,n){o[i]&&o[i].forEach(function(t,e){t===n&&o[i].splice(e,1)})}}),t=(s=util.element("div",{class:"links"}),util.query(document,"main .center").append(s),p=null,m=[],v=new menu({list:[{icon:util.getGoogleIcon("e3c9"),title:"修改",click:function(){var t=q(p,util.query(s,".link-list li",!0)),e=util.query(s,".cate-bar-items .cate-item.active");T(t,e=e.classList.contains("mr")?null:e.innerText)}},{icon:util.getGoogleIcon("e92e"),title:"删除",click:function(){var t=q(p,util.query(s,".link-list li",!0)),e=(e=util.query(s,".cate-bar-items .cate-item.active")).classList.contains("mr")?null:e.innerText;w.deleteLink(e,t,function(){toast.show("删除成功")})}}]}),i=null,y=new menu({list:[{icon:util.getGoogleIcon("e3c9"),title:"重命名",click:function(){_(i.innerText)}},{icon:util.getGoogleIcon("e92e"),title:"删除",click:function(){var t=i.innerText;w.deleteCate(t,function(t){0==t?toast.show("删除成功"):toast.show(t.msg)})}}]}),window.addEventListener("resize",function(){x.call(util.query(s,".cate-bar-scrolls"))}),w.on("change",function(t){var e=util.query(s,".cate-bar-items .cate-item.active");if((t.cate==e.innerText||null==t.cate&&e.classList.contains("mr"))&&-1!=["add","change","delete"].indexOf(t.type)&&I(t.cate),"cateadd"==t.type)L(t.cate);else if("catedelete"==t.type){for(var i=util.query(s,".cate-bar-items .cate-item",!0),n=0;n<i.length;n++)if(i[n].innerText==t.cate){i[n].classList.contains("active")&&(I(),util.query(s,".cate-bar-items .cate-item.mr").classList.add("active")),i[n].remove();break}}else if("caterename"==t.type)for(i=util.query(s,".cate-bar-items .cate-item",!0),n=0;n<i.length;n++)if(i[n].innerText==t.cate){i[n].innerText=t.catename;break}}),s.innerHTML='<div class="cate-bar"><div class="cate-bar-controls"><div class="cate-left-btn">{{cate-left}}</div></div><div class="cate-bar-scrolls"><div class="cate-bar-items"><div class="cate-item mr active">默认</div></div></div><div class="cate-bar-controls r"><div class="cate-right-btn">{{cate-right}}</div><div class="cate-add-btn">{{cate-add}}</div></div></div><ul class="link-list"></ul>'.replace("{{cate-left}}",util.getGoogleIcon("e314")).replace("{{cate-right}}",util.getGoogleIcon("e315")).replace("{{cate-add}}",util.getGoogleIcon("e145")),w.ready(function(){function t(t){var e;return t<0?0:(e=util.query(s,".cate-bar-scrolls").scrollWidth-util.query(s,".cate-bar-scrolls").getBoundingClientRect().width)<t?e:void 0}w.getCates(function(t){t.data.forEach(function(t){L(t)})}),util.query(s,".cate-item.mr").onclick=function(){try{util.query(s,".cate-bar-items .cate-item.active").classList.remove("active")}catch(t){}this.classList.add("active"),I()},util.query(s,".cate-add-btn").onclick=function(){_()},util.query(s,".cate-left-btn").onclick=function(){util.query(s,".cate-bar-scrolls").scrollTo({left:t(util.query(s,".cate-bar-scrolls").scrollLeft-util.query(s,".cate-bar-scrolls").getBoundingClientRect().width/2),behavior:"smooth"})},util.query(s,".cate-right-btn").onclick=function(){util.query(s,".cate-bar-scrolls").scrollTo({left:t(util.query(s,".cate-bar-scrolls").scrollLeft+util.query(s,".cate-bar-scrolls").getBoundingClientRect().width/2),behavior:"smooth"})},util.query(s,".cate-bar-scrolls").onscroll=function(){x.call(this)},x.call(util.query(s,".cate-bar-scrolls")),E(c.get("enabledCate")),M(c.get("linksize"))}),new MutationObserver(function(){setTimeout(S,1)}).observe(util.query(s,".cate-bar-items"),{childList:!0}),void 0===c.get("enabledCate")&&c.set("enabledCate",!1),c.get("linksize")||c.set("linksize","m"),t=new SettingGroup({title:"链接"}),b=new SettingItem({type:"boolean",title:"链接分组",message:"启用链接分组功能来管理链接",get:function(){return c.get("enabledCate")},callback:function(t){c.set("enabledCate",t),E(t)}}),k=new SettingItem({type:"select",title:"链接大小",message:"修改链接显示的大小",init:function(){return{xs:"很小",s:"小",m:"中",l:"大",xl:"很大"}},get:function(){return c.get("linksize")},callback:function(t){c.set("linksize",t),M(t)}}),mainSetting.addNewGroup(t),t.addNewItem(b),t.addNewItem(k),{isShowCate:function(){return c.get("enabledCate")},setShowCate:function(t){c.set("enabledCate",t),E(t),b.reGet()},getLinkSize:function(){return c.get("linksize")},setLinkSize:function(t){-1!=["xs","s","m","l","xl"].indexOf(t)&&(c.set("linksize",t),M(t),k.reGet())},cateWidthShiPei:S});function q(t,e){for(var i=0;i<e.length;i++)if(e[i].isSameNode(t))return i;return-1}function L(t){var e=util.element("div",{class:"cate-item"});e.innerText=t,util.query(s,".cate-bar-items").append(e),e.onclick=function(){I(this)},e.oncontextmenu=function(t){t.preventDefault(),i=this,y.setOffset({top:t.pageY,left:t.pageX}),y.show()}}function x(){var t=0;0==this.scrollLeft?(util.query(s,".cate-left-btn").classList.add("disabled"),t++):util.query(s,".cate-left-btn").classList.remove("disabled"),this.scrollLeft>=this.scrollWidth-this.getBoundingClientRect().width?(util.query(s,".cate-right-btn").classList.add("disabled"),t++):util.query(s,".cate-right-btn").classList.remove("disabled"),this.style.width="calc(100% - "+(120-40*t)+"px)"}function S(){var t=util.query(s,".cate-bar-items .cate-item",!0),e=(util.query(s,".cate-bar-items").style.width="100000px",t[0].offsetHeight,0);t.forEach(function(t){e+=t.getBoundingClientRect().width+4}),util.query(s,".cate-bar-items").style.width=e+"px",x.call(util.query(s,".cate-bar-scrolls"))}function I(t){util.query(s,".link-list").innerHTML="";var e=null;if("string"==typeof t){try{util.query(s,".cate-bar-items .cate-item.active").classList.remove("active")}catch(t){}for(var i=util.query(s,".cate-bar-items .cate-item",!0),n=0;n<i.length;n++)if(!i[n].classList.contains("mr")&&i[n].innerText==t){i[n].classList.add("active");break}e=t}else if(t){try{util.query(s,".cate-bar-items .cate-item.active").classList.remove("active")}catch(t){}t.classList.add("active"),e=t.innerText}else{try{util.query(s,".cate-bar-items .cate-item.active").classList.remove("active")}catch(t){}util.query(s,".cate-bar-items .cate-item.mr").classList.add("active")}w.getLinks(e,function(t){m=t.data,t.data.forEach(function(e){var i=util.element("li");i.innerHTML=`<a href="${e.url}" target="_blank" rel="noopener noreferer"><img/><p></p></a>`,util.query(s,".link-list").append(i),util.query(i,"p").innerText=e.title,util.getFavicon(e.url,function(t){util.query(i,"img").src=t||util.createIcon(e.title[0])}),i.oncontextmenu=function(t){t.preventDefault(),p=this,v.setOffset({top:t.pageY,left:t.pageX}),v.show()}});t=util.element("li",{class:"link-add"});t.innerHTML='<a href="javascript:void(0)" class="material-symbols-outlined">&#xe145;</a>',util.query(s,".link-list").append(t),t.onclick=function(){var t=util.query(s,".cate-bar-items .cate-item.active");T(-1,t=t.classList.contains("mr")?null:t.innerText)}})}function T(o,s){var t;f||(t=(f=new dialog({class:"link-add-dialog",content:'<form><h1></h1><div class="content"><p>URL ：<input class="link-add-url" type="text" required placeholder="链接地址(必填)"></p><p>标题：<input class="link-add-title" type="text" required placeholder="链接标题(必填)"></p><p>位置：<input class="link-add-index" type="number" min="0" placeholder="链接位置"></p></div><div class="footer"><div class="cancel btn">取消</div><button class="ok btn"></button></div></form>'})).getDialogDom(),util.query(t,".cancel.btn").onclick=function(t){t.preventDefault(),f.close()}),setTimeout(function(){f.open();var c=f.getDialogDom(),n=m.length;function t(t,e,i,n,o,s,a){util.query(c,"h1").innerHTML=t,util.query(c,".ok.btn").innerHTML=e,util.query(c,"input.link-add-url").value=i,util.query(c,"input.link-add-title").value=n,util.query(c,"input.link-add-index").setAttribute("max",o),util.query(c,"input.link-add-index").value=s,util.query(c,"form").onsubmit=a}-1==o?t("添加链接","添加","","",n,n,function(t){t.preventDefault();var t=util.query(c,".link-add-url").value,e=(-1==t.indexOf("://")&&(t="http://"+t),util.query(c,".link-add-title").value),i=util.query(c,".link-add-index").value;w.addLink({url:t,title:e,index:""==i?n:+i,cate:s},function(t){0!=t.code?toast.show(t.msg):(toast.show("添加成功"),f.close())})}):t("修改链接","修改",m[o].url,m[o].title,n-1,o,function(t){t.preventDefault();var t=util.query(c,".link-add-url").value,e=(-1==t.indexOf("://")&&(t="http://"+t),util.query(c,".link-add-title").value),i=util.query(c,".link-add-index").value;w.changeLink(s,o,{url:t,title:e,index:""==i?o:+i},function(t){0!=t.code?toast.show(t.msg):(toast.show("修改成功"),f.close())})})})}function _(e){var i=(h=h||new dialog({class:"link-add-dialog",content:'<form><h1></h1><div class="content"><p>标题：<input class="cate-name" type="text" required placeholder="分组标题(必填)"></p></div><div class="footer"><div class="cancel btn">取消</div><button class="ok btn">确定</button></div></form>'})).getDialogDom();util.query(i,".cancel.btn").onclick=function(t){t.preventDefault(),h.close()},setTimeout(function(){h.open(),e?(util.query(i,"h1").innerHTML="修改分组",util.query(i,".cate-name").value=e,util.query(i,"form").onsubmit=function(t){t.preventDefault();t=util.query(i,".cate-name").value;w.renameCate(e,t,function(t){t.code<0?toast.show(t.msg):(toast.show("修改成功"),h.close())})}):(util.query(i,"h1").innerHTML="添加分组",util.query(i,".cate-name").value="",util.query(i,"form").onsubmit=function(t){t.preventDefault();t=util.query(i,".cate-name").value;w.addCate(t,function(t){t.code<0?toast.show(t.msg):(toast.show("添加成功"),h.close())})})})}function E(t){I(),t?(util.query(s,".cate-bar").style.display="block",setTimeout(function(){S()})):util.query(s,".cate-bar").style.display="none"}function M(t){util.query(s,".link-list").className="link-list "+t}return w.on("change",function(t){c.websync(t)}),util.joinObj(w,t)}(),says=function(){var i,n,o,s,a,c=storage("says",{sync:!0,title:"一言",desc:"QUIK起始页一言相关配置",get:async function(){var t=c.getAll(),e=quik.addon.getAddonBySessionId(t.saytype);return e&&(t.requireAddon=e.url),t},rewrite:function(n,o,s){return new Promise(function(e,t){var i;s.requireAddon?(i=quik.addon.getAddonByUrl(s.requireAddon))?(s.saytype=i.session.id,n[o]=s,e()):confirm("该一言数据需要安装插件以同步，是否安装？",function(t){t?quik.addon.installAddon(s.requireAddon).then(function(t){s.saytype=t.session.id,n[o]=s,e()}).catch(function(t){0==t?alert("插件取消安装，同步取消",function(){e()}):alert("插件安装失败，同步取消",function(){e()})}):alert("已取消一言同步",function(){e()})}):(n[o]=s,e())})}}),e=util.element("div",{class:"says"}),l=(util.query(document,"main").appendChild(e),e.innerHTML=`<div class="say-inner"></div><div class="say-control">${util.getGoogleIcon("e5d4")}</div>`,util.query(e,"div.say-inner")),r=util.query(e,"div.say-control"),u=new menu({list:[]}),t=new dialog({content:`<div class="closeBtn">${util.getGoogleIcon("e5cd")}</div><ul></ul>`,class:"says_info"}),d=t.getDialogDom(),g=(util.query(d,"div.closeBtn").onclick=function(){t.close()},{}),f={};function h(t){g[t.key]={name:t.name,callback:t.callback,click:t.click||function(){},menu:t.menu||[{icon:util.getGoogleIcon("e14d"),title:"复制",click:function(){var t=f.say;util.copyText(t)}}]}}function p(){var e;i||(e=(i=new dialog({class:"sayseditordialog",content:'<h1>修改一言</h1><div class="content"><p><input class="says-input" type="text"/></p></div><div class="footer"><div class="cancel btn">取消</div><button class="ok btn">确定</button></div>'})).getDialogDom(),util.query(e,".cancel.btn").onclick=function(){i.close()},util.query(e,".ok.btn").onclick=function(){var t=util.query(e,".says-input").value;c.set("usersay",t),y("user"),i.close()}),setTimeout(function(){var t=i.getDialogDom();i.open(),util.query(t,".says-input").value=c.get("usersay")})}function m(e,t){var i=new XMLHttpRequest;i.open("get",t),i.withCredentials=!1,i.send(),i.onreadystatechange=function(){var t;4===i.readyState&&("success"===(t=JSON.parse(i.responseText)).status?e(t):console.error("今日诗词API加载失败，错误原因："+t.errMessage))}}function v(t,e){if(util.checkSession(t)&&(t=t.id),!g[t])throw"type不存在 type:"+t;c.set("saytype",t),u.setList(g[t].menu),l.onclick=g[t].click,y(t,e),w.reGet()}function y(t,e){if(util.checkSession(t)&&(t=t.id),!g[t])throw"key不存在";l.innerText="...",l.title="加载中",g[t].callback().then(function(t){l.innerText=t.say,l.setAttribute("title",t.title),f=t,e&&e()})}function b(i){util.query(d,"ul").innerHTML=function(){var t,e="";for(t in i)e+="<li><b>"+t+":</b> "+i[t]+"</li>";return e}(),t.open()}h((c.get("usersay")||c.set("usersay","海内存知己，天涯若比邻"),i=null,{key:"user",name:"用户自定义",callback:function(){return new Promise(function(t,e){t({say:c.get("usersay"),title:"点击修改"})})},click:function(){p()},menu:[{icon:util.getGoogleIcon("e3c9"),title:"修改",click:function(){p()}},{icon:util.getGoogleIcon("e14d"),title:"复制",click:function(){var t=f.say;util.copyText(t)}}]})),h((n={load:function(e){var i=0;!function t(){util.xhr("https://tenapi.cn/v2/yiyan?format=json",function(t){e(JSON.parse(t).data)},function(){++i<=5&&t()})}()},cats:{a:"动画",b:"漫画",c:"游戏",d:"文学",e:"原创",f:"来自网络",g:"其他",h:"影视",i:"诗词",j:"网易云",k:"哲学",l:"抖机灵"}},{key:"hitokoto",name:"随机一言",callback:function(){return new Promise(function(e,t){n.load(function(t){e({say:t.hitokoto,from:t.source,uuid:t.id,cat:t.cat,from_who:t.author,title:"该一言来自"+t.source+"，由"+t.author+"上传"})})})},click:function(){y("hitokoto")},menu:[{icon:util.getGoogleIcon("e5d5"),title:"刷新",click:function(){y("hitokoto")}},{icon:util.getGoogleIcon("e14d"),title:"复制",click:function(){var t=f.say;util.copyText(t)}},{icon:util.getGoogleIcon("e88e"),title:"一言详情",click:function(){var t=n.cats[f.cat];b({API:"Ten·API（tenapi.cn） | Hitokoto (hitokoto.cn)","内容":f.say,"来源":f.from,"上传者":f.from_who,"分类":t||"未知",UUID:f.uuid})}}]})),h((o=storage("jrsc"),a="jinrishici-token",(s={}).load=function(e){var t=o.get(a);return t?m(e,"https://v2.jinrishici.com/one.json?client=browser-sdk/1.2&X-User-Token="+encodeURIComponent(t)):m(function(t){o.set(a,t.token),e(t)},"https://v2.jinrishici.com/one.json?client=browser-sdk/1.2")},{key:"jinrishici",name:"今日诗词",callback:function(){return new Promise(function(e,t){s.load(function(t){e({say:t.data.content,author:"("+t.data.origin.dynasty+")"+t.data.origin.author,p_title:"《"+t.data.origin.title+"》",tags:t.data.matchTags.join(" "),content:"<br>"+t.data.origin.content.join("<br>"),title:"摘自"+t.data.origin.dynasty+"·"+t.data.origin.author+"的《"+t.data.origin.title+"》"})})})},click:function(){y("jinrishici")},menu:[{icon:util.getGoogleIcon("e5d5"),title:"刷新",click:function(){y("jinrishici")}},{icon:util.getGoogleIcon("e14d"),title:"复制",click:function(){var t=f.say;util.copyText(t)}},{icon:util.getGoogleIcon("e88e"),title:"诗词详情",click:function(){b({API:"今日诗词（jinrishici.com）","内容":f.say,"作者":f.author,"标题":f.p_title,"全部内容":f.content})}}]})),r.onclick=function(t){t.stopPropagation();t=r.getBoundingClientRect();u.setOffset({bottom:window.innerHeight-t.top,left:t.left-90+t.width}),u.show()},c.get("saytype")||c.set("saytype","user"),null==c.get("enabled")&&c.set("enabled",!0);var k=new SettingGroup({title:"一言",index:3}),w=new SettingItem({title:"一言类型",type:"select",index:1,message:"页面底部显示的一言类型",init:function(){var t,e={};for(t in g)e[t]=g[t].name;return e},callback:function(t){v(t)},get:function(){return c.get("saytype")}}),q=new SettingItem({title:"显示一言",type:"boolean",message:"是否页面底部显示的一言",index:0,callback:function(t){c.set("enabled",t),t?(v(c.get("saytype")),e.style.display="",w.show()):(e.style.display="none",w.hide())},get:function(){return c.get("enabled")}});return mainSetting.addNewGroup(k),k.addNewItem(w),k.addNewItem(q),c.get("enabled")?v(c.get("saytype")):(e.style.display="none",w.hide()),{getNowSay:function(){return f},setSayType:v,addSayType:function(t){if(util.checkSession(t.session))throw"错误的session";t.key=t.session.id,h(t),w.reInit()}}}(),card=function(){function t(t){this.width=t.width,this.height=t.height,this.offset=t.offset;var e=util.element("div",{class:"card"});e.innerHTML=t.content,e.style.width=t.width+"px",e.style.height=t.height+"px",t.class&&e.classList.add(t.class),t.offset&&("number"==typeof t.offset.top?e.style.top=t.offset.top+"px":"number"==typeof t.offset.bottom&&(e.style.bottom=t.offset.bottom+"px"),"number"==typeof t.offset.left?e.style.left=t.offset.left+"px":"number"==typeof t.offset.right&&(e.style.right=t.offset.right+"px")),this.el=e,i.appendChild(e),this.isShow=!1}var i=util.query(document,".cards");return t.prototype={show:function(t){var e=this;e.isShow=!0,this.el.style.display="block",t&&0<t&&(this.el.style.transition="all "+t+"ms",this.el.offsetHeight,setTimeout(function(){e.el.style.transition="none"},t)),this.el.style.opacity="1"},hide:function(t){var e=this;e.isShow=!1,t&&0<t?(this.el.style.transition="all "+t+"ms",setTimeout(function(){e.el.style.transition="none",e.el.style.display="none"},t)):this.el.style.display="none",this.el.style.opacity="0"},destory:function(){this.el.remove()},getCardDom:function(){return this.el},getOffset:function(){return this.offset},getWidth:function(){return this.width},getHeight:function(){return this.height},setWidth:function(t){this.width=t,this.el.style.width=t+"px"},setHeight:function(t){this.el.style.height=t+"px"},setOffset:function(t,e){var i=this;this.offset=t,e&&0<e&&(this.el.style.transition="all "+e+"ms",setTimeout(function(){i.el.style.transition="none"},e)),this.el.style.top="auto",this.el.style.left="auto",this.el.style.bottom="auto",this.el.style.right="auto","number"==typeof t.top?this.el.style.top=t.top+"px":"number"==typeof t.bottom&&(this.el.style.bottom=t.bottom+"px"),"number"==typeof t.left?this.el.style.left=t.left+"px":"number"==typeof t.right&&(this.el.style.right=t.right+"px")}},t}(),fcard=function(){var i=util.element("div",{class:"fcard-frame"}),n=(i.addEventListener("click",function(t){t.stopPropagation()}),document.querySelector("main").append(i),0),o=[];function t(t){this.content=t.content,n++,this.id=n;var e=util.element("div",{class:"fcard"});e.innerHTML='<div class="content '+(t.class||"")+'">'+this.content+'<div><div class="cover"></div>',i.insertBefore(e,i.firstChild),this.el=e,o.push(this),this.isShow=!0,s.style.display=""}function e(){for(var t=0;t<o.length;t++)if(o[t].isShow)return;return 1}t.prototype={show:function(){this.el.style.display="block",this.isShow=!0,s.style.display=""},hide:function(){this.el.style.display="none",this.isShow=!1,e()&&(s.style.display="none")},getFCardDom:function(){return this.el},destory:function(){this.el.remove(),this.el=null,o.splice(o.indexOf(this),1),e()&&(s.style.display="none")}},t.getFCardById=function(t){for(var e=0;e<o.length;e++)if(o[e].id==t)return o[e];return null};var s=util.element("div",{class:"fcard-mob-zd"});return s.innerHTML=util.getGoogleIcon("e5cc"),s.style.display="none",document.querySelector("main").append(s),s.onclick=function(t){t.stopPropagation(),i.classList.add("show"),this.classList.add("hide")},document.addEventListener("click",function(){i.classList.remove("show"),s.classList.remove("hide")}),t}(),background=function(){var P=new SettingGroup({title:"背景",index:3}),t=new SettingItem({title:"背景设置",message:"点击设置背景",index:0,type:"null",callback:function(){a.open()}}),t=(mainSetting.addNewGroup(P),P.addNewItem(t),getEventHandle()),e=t.on,i=t.off,n=t.doevent,o=util.element("div",{class:"bgf"}),O=(util.query(document,"body").appendChild(o),storage("background",{sync:!0,get:function(){return new Promise(function(t,e){var i=O.getAll();delete i.upload,"default"!=i.bg.type?i.requireAddon=quik.addon.getAddonBySessionId(i.bg.type).url:"userbg"==i.bg.data.type&&i.userbg.useidb&&(i.bg={type:"default",data:{type:"color",light:"#fff",dark:"#333"}}),i.userbg&&i.userbg.useidb?(delete i.userbg,alert("不支持同步用户上传的背景",function(){t(i)})):t(i)})},rewrite:function(n,o,s){return new Promise(function(e,t){var i;s.requireAddon?(i=quik.addon.getAddonByUrl(s.requireAddon))?(s.bg.type=i.session.id,n[o]=s,e()):confirm("该背景数据需要安装插件以同步，是否安装？",function(t){t?((t=addon.installAddon(s.requireAddon)).on("error",function(t){alert("插件安装失败，同步取消",function(){e()})}),t.on("wait",function(t){t(!0)}),t.on("done",function(t){s.bg.type=t.id,n[o]=s,e()})):alert("已取消背景同步",function(){e()})}):(n[o]=s,e())})},title:"背景",desc:"QUIK起始页背景相关配置"})),s=0;var a=new dialog({content:`<div class="actionbar"><h1>背景设置</h1><div class="closeBtn">${util.getGoogleIcon("e5cd")}</div></div><div class="tab_con"></div><div class="scroll_con"></div>`,class:"bg_d",mobileShowtype:dialog.SHOW_TYPE_FULLSCREEN}),N=a.getDialogDom(),c=(util.query(N,".closeBtn").onclick=function(){a.close()},util.query(N,"div.tab_con")),l=util.query(N,"div.scroll_con"),t=(util.initSet(O,"bg",{type:"default",data:{type:"color",light:"#fff",dark:"#333"}}),function(){util.initSet(O,"usercolor",{dark:"#333333",light:"#ffffff"}),util.initSet(O,"ivsetting",{mb:50,isbr:!1,br:6,th:1});var o,s,a,c,n,l={getImg:function(e){var i="",i=window.innerWidth<=500?"https://img.loliapi.cn/i/pe/img"+(parseInt(3095*Math.random())+1)+".webp":"https://img.loliapi.cn/i/pc/img"+(parseInt(696*Math.random())+1)+".webp";util.loadimg(i,function(t){if(t)e({url:i,candownload:!0});else{if("siquan001.github.io"==window.location.host)return function(e){util.xhr("https://stear.cn/api/quik.php?m=bg&key=sys81a1g519lsokh0e8&host=siquan001.github.io",function(t){t=JSON.parse(t),e({url:t.url,candoanload:!0})},function(){i="https://loliapi.com/acg/?_="+Date.now(),util.loadimg(i,function(){e({url:i,candoanload:!1})})})};i="https://loliapi.com/acg/?_="+Date.now(),util.loadimg(i,function(){e({url:i,candoanload:!1})})}})}},r={getImg:function(e){var i="https://img.gumengya.com/api/fj/"+(parseInt(4e3*Math.random())+1)+".jpg";util.loadimg(i,function(t){t?e({url:i,candownload:!0}):(i="https://api.gumengya.com/Api/FjImg?format=image&_="+Date.now(),util.loadimg(i,function(){e({url:i,candoanload:!1})}))})}},u=[{thumbnail:"https://image.gumengya.com/thumbnails/b0289db9349e17ca66be2e772cc647a5.png",img:"https://image.gumengya.cn/i/2024/06/09/66656920a034a.webp"}],d=new iconc.icon({content:util.getGoogleIcon("e86a"),offset:"br",important:!0}),g=new iconc.icon({content:util.getGoogleIcon("f090"),offset:"br"}),f=(g.getIcon().onclick=function(){window.open(document.querySelector(".bgf img").src)},new iconc.icon({content:util.getGoogleIcon("e88e"),offset:"br",important:!0})),h=new card({content:`<div class="copyright">...</div>
      <div class="second">...</div>
      <div class="title">...</div>
      <a class="link" target="_blank" href="https://www.bing.com/">去Bing搜索</a>`,offset:{right:5,bottom:50},class:"bing_info"});function p(){var t=new Date;return{light:`rgb(${256-t.getHours()},${256-t.getMinutes()},${256-t.getSeconds()})`,dark:`rgb(${t.getHours()},${t.getMinutes()},${t.getSeconds()})`}}f.getIcon().onclick=function(){var i;h.isShow?h.hide(400):(h.show(400),i=function(t){var e=h.getCardDom();util.query(e,".copyright").innerText=t.copyright,util.query(e,".second").innerText=t.second_copyright,util.query(e,".title").innerText=t.title,util.query(e,".link").href=t.link},n?i(n):util.xhr("https://bing.shangzhenyang.com/api/json",function(t){var t=(t=JSON.parse(t)).images[0],e=t.copyright.split("(");e[1]="("+e[1],n={copyright:e[0],second_copyright:e[1],link:t.copyrightlink,title:t.title},i(n)},function(){i({copyright:"加载失败",second_copyright:"(© Bing)",link:"https://www.bing.com/",title:"点击前往必应"})}))},f.getIcon().title="显示壁纸详情",d.getIcon().onclick=function(){var t=document.querySelector(".bgf .full img"),e=(t&&(t.style.opacity="0"),this);setTimeout(function(){refreshFn.call(e)},300)};t=new SettingItem({title:"背景图片/视频显示设置",message:"设置背景图片/视频显示的蒙版和模糊等",type:"null",callback:function(){e.open()}}),P.addNewItem(t),e=new Setting({title:"背景图片/视频显示设置"}),i=new SettingGroup({title:"通用",index:0}),m=new SettingItem({title:"背景蒙版颜色主题",index:0,type:"select",init:function(){return{0:"跟随主题",1:"黑色",2:"白色"}},get:function(){return O.get("ivsetting").th||1},callback:function(t){var e=O.get("ivsetting");e.th=parseInt(t),O.set("ivsetting",e),q()}}),v=new SettingItem({title:"背景蒙版浓度",index:1,type:"range",init:function(){return[0,90]},get:function(){return O.get("ivsetting").mb},callback:function(t){var e=O.get("ivsetting");e.mb=t,O.set("ivsetting",e),q()}}),y=new SettingItem({title:"背景模糊",message:"可能会影响性能",type:"boolean",index:2,get:function(){return O.get("ivsetting").isbr},callback:function(t){t?b.show():b.hide();var e=O.get("ivsetting");e.isbr=t,O.set("ivsetting",e),q()}}),b=new SettingItem({title:"背景模糊程度",index:3,type:"range",init:function(){return[1,20]},get:function(){return O.get("ivsetting").br},callback:function(t){var e=O.get("ivsetting");e.br=t,O.set("ivsetting",e),q()}}),e.addNewGroup(i),i.addNewItem(m),i.addNewItem(v),i.addNewItem(y),i.addNewItem(b),O.get("ivsetting").isbr||b.hide(),q();var t,e,i,m,v,y,b,{ImgOrVideoSi:k,checkBgCoverStyle:w}={ImgOrVideoSi:t,checkBgCoverStyle:q};function q(){var t,e,i,n;(document.querySelector(".bgf .img-sp")||document.querySelector(".bgf .video-sp"))&&(t=O.get("ivsetting"),(e=document.querySelector("#ivbgse"))||((e=document.createElement("style")).id="ivbgse",document.head.append(e)),n=i="",1==t.th?(n="0,0,0",document.body.classList.add("t-dark")):2==t.th?(n="255,255,255",document.body.classList.remove("t-dark")):0==t.th&&(n=document.body.classList.contains("dark")?(document.body.classList.add("t-dark"),"0,0,0"):(document.body.classList.remove("t-dark"),"255,255,255")),i+=".img-sp .cover,.video-sp .cover{background-color:rgba("+n+","+t.mb/100+")}",t.isbr&&(i+=".img-sp .cover,.video-sp .cover{backdrop-filter:blur("+t.br+"px)}"),e.innerHTML=i)}var L,x,S=null,I={img:function(t,e){t.innerHTML='<div class="img-sp full"><div class="cover"></div><img src="'+e.url+'"/></div>',t.querySelector("img").onload=function(){this.style.opacity="1"},w(),k.show()},video:function(t,e){t.innerHTML='<div class="video-sp full"><div class="cover"></div><video src="" muted loop></video></div>',util.query(t,".video-sp video").src=e.url,util.query(t,".video-sp video").oncanplay=function(){this.play(),this.style.opacity="1"},w(),k.show()},color:function(t,e){t.innerHTML='<div class="color-sp full"></div>',util.query(document.head,"style.colorSpControl")||((t=document.createElement("style")).className="colorSpControl",document.head.appendChild(t)),util.query(document.head,"style.colorSpControl").innerHTML=`.color-sp{background-color:${e.light};}body.dark .color-sp{background-color:${e.dark};}`},api:function(e,t){function i(t){d.show(),d.getIcon().classList.add("round-anim"),t.getImg(function(t){d.getIcon().classList.remove("round-anim"),I.img(e,{url:t.url}),t.candownload&&g.show()}),refreshFn=function(){d.getIcon().classList.add("round-anim"),t.getImg(function(t){d.getIcon().classList.remove("round-anim"),I.img(e,{url:t.url}),t.candownload&&g.show()})}}switch(t.api){case"acg":i(l);break;case"fj":i(r);break;case"bing":I.img(e,{url:"https://bing.shangzhenyang.com/api/1080p"}),g.show(),f.show();break;case"time":S=setInterval(function(){I.color(e,p())},200)}},userbg:function(e,t){var i=O.get("userbg");i&&(document.body.classList.add("t-dark"),"video"==i.type?i.useidb?O.get("upload",!0,function(t){I.video(e,{url:URL.createObjectURL(t)})}):I.video(e,{url:i.url}):"image"==i.type&&(i.useidb?O.get("upload",!0,function(t){I.img(e,{url:URL.createObjectURL(t)})}):I.img(e,{url:i.url})))},zdy:function(t,e){util.query(t,".zdy-sp")||(t.innerHTML='<div class="zdy-sp full"></div>'),util.query(document.head,"style.zdySpControl")||((t=document.createElement("style")).className="zdySpControl",document.head.appendChild(t)),util.query(document.head,"style.zdySpControl").innerHTML=`.zdy-sp{background:${e.light};}body.dark .zdy-sp{background:${e.dark};}`}},{getUserUploadUrl:B,hasUploadedImg:T,iovuploader:_}=(L=new dialog({content:'<form><h1>上传背景</h1><div class="content"><p>背景类型：<input type="radio" class="uploadi" name="uploadiov" checked="checked"> 图片 <input type="radio" class="uploadv" name="uploadiov"> 视频</p><p>背景URL：<input type="url" placeholder="URL"></p><p>从本地选择文件：<input type="file"></p><p class="tip">URL和文件只需填写一个即可，优先选择本地文件</p></div><div class="footer"><div class="cancel btn">取消</div><button class="ok btn">确定</button></div></form>',class:"iovuploader"}),x=L.getDialogDom(),util.query(x,".cancel").onclick=function(t){t.preventDefault(),L.close()},util.query(x,"form").onsubmit=function(t){t.preventDefault();var t=util.query(x,".uploadi").checked?"image":"video",e=util.query(x,'input[type="url"]').value,i=util.query(x,'input[type="file"]').files[0];util.query(N,".zdy .left img").src="",i?(O.set("upload",i,!0,function(){L.close(),E(function(t){util.query(N,".zdy .left img").src=t}),s({type:"default",data:{type:"userbg"}})}),O.set("userbg",{type:t,useidb:!0})):(O.set("userbg",{type:t,url:e}),L.close(),E(function(t){util.query(o,".zdy .left img").src=t,s({type:"default",data:{type:"userbg"}})})),util.query(o,".noBg").style.display="none",util.query(o,".hasBg").style.display="block",util.query(o,".zdy .editbtn").style.display="block"},{hasUploadedImg:function(){return!!O.get("userbg")},getUserUploadUrl:E,getVideoCaptrue:M,iovuploader:L});function E(e){var t=O.get("userbg");if(t)if("video"==t.type)if(t.useidb)O.get("upload",!0,function(t){M(URL.createObjectURL(t),function(t){e(t)})});else try{M(t.url,function(t){e(t)})}catch(t){e(!1)}else"image"==t.type&&(t.useidb?O.get("upload",!0,function(t){e(URL.createObjectURL(t))}):e(t.url));else e(!1)}function M(t,i){var n=document.createElement("video");n.src=t,n.crossOrigin="anonymous",n.onloadedmetadata=function(){var t=document.createElement("canvas"),e=t.getContext("2d");t.width=n.videoWidth,t.height=n.videoHeight,n.currentTime=n.duration/4,n.oncanplay=function(){e.drawImage(n,0,0,t.width,t.height),i(t.toDataURL("image/png")),this.remove()}}}A=new dialog({content:'<form><h1>自定义背景颜色</h1><div class="content"><p>浅色模式：<input type="color" class="lightbgcolor"></p><p>深色模式：<input type="color" class="darkbgcolor"></p></div><div class="footer"><div class="cancel btn">取消</div><button class="ok btn">确定</button></div></form>'}),D=A.getDialogDom(),util.query(D,".cancel").onclick=function(t){t.preventDefault(),A.close()},util.query(D,"form").onsubmit=function(t){t.preventDefault();var t=util.query(D,".lightbgcolor").value,e=util.query(D,".darkbgcolor").value;O.set("color",{light:t,dark:e}),util.query(a,".zdy .color-left").style.backgroundColor=t,util.query(a,".zdy .color-right").style.backgroundColor=e,A.close(),s({type:"default",data:{type:"color",light:t,dark:e}})};var A,D,{colorchanger:U,colorchangerf:C}={colorchanger:A,colorchangerf:D};function H(t){util.query(o,".bgitem",!0).forEach(function(t){t.classList.remove("selected")}),util.query(a,".bgitem",!0).forEach(function(t){t.classList.remove("selected")}),"default"==t.type&&("img"==t.data.type?util.query(o,'.neizhi .bgitem[data-img="'+t.data.url+'"]').classList.add("selected"):"userbg"==t.data.type?util.query(o,".zdy .bgitem").classList.add("selected"):"api"==t.data.type?("time"==t.data.api?util.query(a,".api .bgitem"):util.query(o,'.api .bgitem[data-api="'+t.data.api+'"]')).classList.add("selected"):"color"==t.data.type&&util.query(a,".zdy .bgitem").classList.add("selected"))}function G(){document.body.classList.remove("t-dark"),d.hide(),refreshFn=function(){},clearInterval(S),g.hide(),k.hide(),f.hide()}return setTimeout(function(){H(quik.background.getbg()),quik.background.on("change",H)}),{type:"default",init:function(i){s=i.setbg,o=i.pushBgTab({tab:"图片/视频",content:'<div class="unit-item zdy"><div class="unit-title">自定义</div><div class="unit-content"><div class="bgitem full"><div class="left"><div class="hasBg"><img src="" alt=""></div><div class="noBg"><span class="material-symbols-outlined">&#xf09b;</span></div></div><div class="right"><div class="bg-title">用户自定义背景</div><div class="bg-message">上传任意你喜欢的图片/视频作背景</div></div><div class="editbtn"><div class="btn ok">重新上传</div></div></div></div></div><div class="unit-item neizhi"><div class="unit-title">内置</div><div class="unit-content"></div></div><div class="unit-item api"><div class="unit-title">API</div><div class="unit-content"><div class="bgitem half" data-api="bing"><div class="left"><img data-src="https://bing.shangzhenyang.com/api/1080p" alt="" loading="lazy"></div><div class="right"><div class="bg-title">必应壁纸</div><div class="bg-message">获取必应首页的壁纸作为背景</div></div></div><div class="bgitem half" data-api="acg"><div class="left"><img data-src="https://www.loliapi.com/acg/" alt="" loading="lazy"></div><div class="right"><div class="bg-title">随机二次元壁纸</div><div class="bg-message">获取随机二次元壁纸作为背景，背景提供：loliapi.com</div></div></div><div class="bgitem half" data-api="fj"><div class="left"><img data-src="https://api.gumengya.com/Api/FjImg?format=image" alt="" loading="lazy"></div><div class="right"><div class="bg-title">随机风景壁纸</div><div class="bg-message">获取随机风景壁纸作为背景，背景提供：imgapi.cn</div></div></div></div></div><div class="unit-item se"><div class="u-se"><p>背景图片显示设置</p><p class="material-symbols-outlined">&#xe5cc;</p></div></div>'}),T()?(util.query(o,".noBg").style.display="none",B(function(t){util.query(o,".zdy .left img").src=t})):(util.query(o,".hasBg").style.display="none",util.query(o,".zdy .editbtn").style.display="none"),util.query(o,".zdy .left").addEventListener("click",function(){T()?i.setbg({type:i.type,data:{type:"userbg"}}):_.open()}),util.query(o,".zdy .editbtn").addEventListener("click",function(){_.open();var t=O.get("userbg");t&&(util.query(iovuploaderf,'input[type="url"]').value=t.url,"image"==t.type?util.query(iovuploaderf,".uploadi").checked=!0:util.query(iovuploaderf,".uploadv").checked=!0)});var n=util.query(o,".neizhi .unit-content");u.forEach(function(t){var e=util.element("div",{class:"bgitem def","data-img":t.img});e.innerHTML='<div class="left"><img data-src="'+t.thumbnail+'" loading="lazy"/></div>',n.appendChild(e),util.query(e,".left").onclick=function(){i.setbg({type:i.type,data:{type:"img",url:e.getAttribute("data-img")}})}});util.query(o,".u-se").onclick=function(){k.callback()},util.query(o,".api.unit-item .left",!0).forEach(function(t){t.addEventListener("click",function(){i.setbg({type:i.type,data:{type:"api",api:t.parentElement.getAttribute("data-api")}})})}),a=i.pushBgTab({tab:"纯色",content:'<div class="unit-item zdy"><div class="unit-title">自定义颜色</div><div class="unit-content"><div class="bgitem full"><div class="left"><div class="color-left color"></div><div class="color-right color"></div></div><div class="right"><div class="bg-title">自定义纯色背景</div><div class="bg-message">将你喜欢的颜色做背景，分亮色和暗色（你也可以都设一个颜色或反着来，但不建议这么做）</div></div><div class="editbtn"><div class="btn ok">编辑</div></div></div></div></div><div class="unit-item api"><div class="unit-title">API</div><div class="unit-content"><div class="bgitem full" data-api="time"><div class="left"><div class="color-left color"></div><div class="color-right color"></div></div><div class="right"><div class="bg-title">时间的颜色</div><div class="bg-message">如果当前时间为12:34:56，那么时间的颜色就是rgb(12,34,56)，在亮色模式下就是rgb(255-12,255-34,255-56)</div></div></div></div></div>'});var t=O.get("usercolor"),t=(util.query(a,".zdy .color-left").style.backgroundColor=t.light,util.query(a,".zdy .color-right").style.backgroundColor=t.dark,util.query(a,".zdy .left").onclick=function(){var t=O.get("usercolor");i.setbg({type:i.type,data:{type:"color",light:t.light,dark:t.dark}})},util.query(a,".zdy .btn").onclick=function(){var t=O.get("usercolor");util.query(C,".lightbgcolor").value=t.light,util.query(C,".darkbgcolor").value=t.dark,U.open()},p()),t=(util.query(a,".api .color-left").style.backgroundColor=t.light,util.query(a,".api .color-right").style.backgroundColor=t.dark,util.query(a,".api .left").onclick=function(){i.setbg({type:i.type,data:{type:"api",api:this.parentElement.getAttribute("data-api")}})},c=i.pushBgTab({tab:"自定义",content:'<p>浅色模式：</p><br><textarea class="gjzdytlight textarea"></textarea><p>深色模式：</p><br><textarea class="gjzdytdark textarea"></textarea> <button class="gjzdysetbtn">设置</button><p class="tip">参见 <a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/background" target="_blank">CSS | background属性</a></p>'}),O.get("custombglight")),e=O.get("custombgdark");util.query(c,".gjzdytlight").value=t||"",util.query(c,".gjzdytdark").value=e||"",util.query(c,".gjzdysetbtn").onclick=function(){O.set("custombglight",util.query(c,".gjzdytlight").value),O.set("custombgdark",util.query(c,".gjzdytdark").value),i.setbg({type:i.type,data:{type:"zdy",dark:util.query(c,".gjzdytdark").value,light:util.query(c,".gjzdytlight").value}}),quik.toast.show("设置成功")}},cancel:function(t){t.bgf.innerHTML="",G()},draw:function(t){var e=t.bgf,t=t.data;G(),I[t.type](e,t)}}}()),r=[t];function u(t){var e=t.tab,i=util.element("div",{class:"tabitem","data-tab":s.toString()}),e=(c.appendChild(i),i.innerHTML=e,i.onclick=function(){d(this.getAttribute("data-tab"))},util.element("div",{class:"scrollitem","data-tab":s.toString()}));return l.appendChild(e),e.innerHTML=t.content,s++,e}function d(t){util.query(N,".tabitem",!0).forEach(function(t){t.classList.remove("active")}),util.query(N,".scrollitem",!0).forEach(function(t){t.style.display=""}),util.query(N,'.tabitem[data-tab="'+t+'"]').classList.add("active"),util.query(N,'.scrollitem[data-tab="'+t+'"]').style.display="block"}f(t);var g=0;function f(t){t.init({bgf:o,pushBgTab:u,setbg:v,type:t.type})}var h=null;var p=null;function m(t){for(var e=0;e<r.length;e++)if(t.type==r[e].type)return p&&p.type!=r[e].type&&(p.cancel({bgf:o}),p=r[e]),void r[e].draw({bgf:o,data:t.data});h=t}function v(t){O.set("bg",t),m(t),n("change",[t])}return m(O.get("bg")),d("0"),mainmenu.pushMenu({icon:util.getGoogleIcon("e1bc"),title:"背景设置",click:function(){a.open()}},mainmenu.MAIN_MENU_TOP),{pushBgDrawer:function(t){var e=t.session;try{if(!util.checkSession(e))throw"session error"}catch(t){throw new Error("背景Drawer注册失败，Session校验错误。")}return e="bgdrawer-"+g,g++,t.type=e,r.push(t),f(t),t=t,h&&t.type==h.type&&t.draw({bgf:o,data:h.data}),e},getbg:function(){return O.get("bg")},setbg:v,on:e,off:i}}(),searchEditor=function(){var t,i=new dialog({content:'<div class="actionbar"><h1>自定义搜索引擎</h1><div class="closeBtn">{{close}}</div></div><div class="searchlist"></div><div class="footer"><button class="cancel btn">取消</button> <button class="ok btn">确定</button></div>'.replace("{{close}}",util.getGoogleIcon("e5cd")),mobileShowtype:dialog.SHOW_TYPE_FULLSCREEN,class:"search_editor"}),n=i.getDialogDom(),o=(util.query(n,".closeBtn").onclick=util.query(n,".cancel.btn").onclick=function(){i.close()},util.query(n,".ok.btn").onclick=util.query(n,".cancel.btn").onclick=function(){var e={};util.query(n,".searchlist .item",!0).forEach(function(t){e[t.dataset.k]=t.querySelector(".url input").value}),(o=e)[omnibox.getSearchTypeIndex()]||omnibox.setSearchType("bing"),omnibox.setSearchList(o),i.close(),toast.show("设置成功")},omnibox.getSearchTypeList()),e="";for(t in o)e+='<div class="item" data-k="'+t+'"><div class="icon"><img/></div><div class="url"><input value="'+o[t]+'"/></div><div class="remove">'+util.getGoogleIcon("e5cd")+"</div></div>";function s(e){util.getFavicon(o[e.getAttribute("data-k")],function(t){util.query(e,".icon img").src=t||util.createIcon("s")}),util.query(e,".url input").oninput=function(){if("bing"==this.parentElement.parentElement.dataset.k)this.value=o.bing,toast.show("该项只读");else try{var e=this.parentElement.parentElement.querySelector(".icon img");util.getFavicon(this.value,function(t){e.src=t||util.createIcon("s")})}catch(t){}},util.query(e,".remove").onclick=function(){"bing"==this.parentElement.dataset.k?(this.value=o.bing,toast.show("该项不可删除")):this.parentElement.remove()}}e+=`<div class="addnewitem">${util.getGoogleIcon("e145")} 添加新的搜索引擎</div>`,util.query(n,".searchlist").innerHTML=e,util.query(n,".searchlist .item",!0).forEach(function(t){s(t)}),util.query(n,".searchlist .addnewitem").onclick=function(){var t=util.element("div",{class:"item","data-k":"user_"+Date.now().toString().slice(3)});t.innerHTML='<div class="icon"><img src="https://cn.bing.com/favicon.ico"/></div><div class="url"><input value="https://cn.bing.com/search?q=%keyword%"/></div><div class="remove">'+util.getGoogleIcon("e5cd")+"</div>",util.query(n,".searchlist").insertBefore(t,util.query(n,".searchlist .addnewitem")),s(t)};var a=new SettingItem({title:"自定义搜索引擎",index:2,type:"null",message:"",callback:function(t){i.open()}});omnibox.sg.addNewItem(a)}(),notice=function(){var i=document.querySelector(".notice-con"),n=document.querySelector(".no-notice-tip"),o='<div class="notice-actionbar"><div class="notice-title"></div><div class="notice-close-btn">{{close-btn}}</div></div><div class="notice-content"></div><div class="notice-progress"><div class="p"><div></div></div></div><div class="notice-btns"></div>',s=document.querySelector(".focus-notice"),e=0;function t(t){var e;this.el=util.element("div",{class:"notice-item"}),i.appendChild(this.el),this.title=t.title,this.content=t.content,this.btns=t.btns||[],this.useprogress=t.useprogress,this.progress=0,(e=this).el.innerHTML=o.replace("{{close-btn}}",util.getGoogleIcon("e5cd")),util.query(e.el,".notice-close-btn").onclick=function(){e.hide()},l(e),r(e),u(e),d(e)}t.prototype={show:function(t){n.classList.remove("show"),f(1),clearTimeout(this._timeouthide),this.el.classList.add("show"),this.el.addEventListener("click",function(t){t.stopPropagation()});var e=this;this.el.style.display="block",this.el.style.animation="noticein .3s",t&&setTimeout(function(){e.hide()},t)},hide:function(){this.el.classList.remove("show"),document.querySelector(".notice-con .notice-item.show")||(n.classList.add("show"),f(0)),this.el.style.animation="noticeout .3s";var t=this;this._timeouthide=setTimeout(function(){t.el.style.display="none"},300)},focus:function(){var t;this.show(),t=this,c.push(t),1==c.length&&function t(){var e=c[0];var i=e.el.cloneNode(!0);s.appendChild(i);util.query(i,".notice-close-btn").onclick=function(){clearTimeout(a),i.remove(),e.hide(),c.shift(),0<c.length&&t()};u({el:i,btns:e.btns,hide:function(){e.hide(),clearTimeout(a),i.remove()},show:function(){}});a=setTimeout(function(){i.remove(),c.shift(),0<c.length&&t()},3e3)}()},destory:function(){this.hide();var t=this;setTimeout(function(){t.el.remove()},300)},setTitle:function(t){this.title=t,l(this)},setContent:function(t){this.content=t,r(this)},setBtn:function(t){this.btns=t,u(this)},setProgress:function(t){!this.useprogress||1<t||t<0||(this.progress=t,d(this))}};var a,c=[];function l(t){util.query(t.el,".notice-title").innerHTML=t.title}function r(t){util.query(t.el,".notice-content").innerHTML=t.content}function u(t){var e=util.query(t.el,".notice-btns");e.innerHTML="";for(var i=0;i<t.btns.length;i++){var n=t.btns[i],o=util.element("div",{class:"btn"+(n.style?" "+n.style:"")});o.innerText=n.text,o.onclick=function(){n.click(t)},e.appendChild(o)}}function d(t){t.useprogress?util.query(t.el,".notice-progress .p div").style.width=100*t.progress+"%":util.query(t.el,".notice-progress").style.display="none"}var g=new iconc.icon({content:util.getGoogleIcon("e7f4"),offset:"tl",class:"notice-icon"});function f(t){void 0===t?t=e:e=t,window.innerWidth<600&&t?g.show():g.hide()}return window.addEventListener("resize",function(){f()}),g.getIcon().addEventListener("click",function(){document.querySelector(".notice-sc").classList.add("show")}),document.querySelector(".notice-sc").addEventListener("click",function(){this.classList.remove("show")}),f(),t}(),custom=function(){var e,i,n=setting.settingSto,t=getEventHandle(),o=t.on,s=t.off,a=t.doevent,t=(util.initSet(n,"linkblur",!0),e=new SettingItem({index:2,title:"极简模式",message:"隐藏所有图标和链接，点击LOGO显示",type:"boolean",get:function(){return!!n.get("lite")},callback:function(t){n.set("lite",t),c(t)}}),i=new SettingItem({index:3,title:"链接页面背景模糊",message:"链接页面背景一般模糊显示，关闭后正常显示",type:"boolean",get:function(){return n.get("linkblur")},callback:function(t){n.set("linkblur",t),l(t)}}),tyGroup.addNewItem(e),tyGroup.addNewItem(i),(t=util.element("div",{class:"liteback"})).innerHTML=util.getGoogleIcon("e5ce"),document.querySelector("main .center").appendChild(t),t.addEventListener("click",function(){document.body.classList.remove("showall"),document.body.classList.add("hiden")}),document.querySelector("main .center .logo").addEventListener("click",function(){document.body.classList.add("showall"),document.body.classList.remove("hiden"),link.cateWidthShiPei()}),c(n.get("lite")),l(n.get("linkblur")),{set:function(t){n.set("lite",t=!!t),c(t),e.reGet()},get:function(){return n.get("lite")}});function c(t){document.body.classList.remove("hiden"),document.body.classList.remove("showall"),t?(document.body.classList.add("lite"),document.body.classList.add("hiden"),i.show()):(document.body.classList.remove("lite"),link.cateWidthShiPei(),i.hide())}function l(t){t?document.querySelector("main").classList.remove("noblur"):document.querySelector("main").classList.add("noblur")}r=document.querySelector("main .center .logo"),u=new SettingItem({index:4,title:"时间LOGO",message:"将当前时间作为LOGO",type:"boolean",get:function(){return!!n.get("timelogo")},callback:function(t){n.set("timelogo",t),f(t)}}),d=!1,f(n.get("timelogo")),tyGroup.addNewItem(u);var r,u,d,g={set:function(t){n.set("timelogo",t=!!t),f(t),u.reGet()},get:function(){return n.get("timelogo")}};function f(t){t?(util.query(r,".timelogo").style.display="block",util.query(r,".imglogo").style.display="none",d||(d=!0,setInterval(function(){var t=new Date;util.query(r,".timelogo .h").innerText=util.b0(t.getHours()),util.query(r,".timelogo .m").innerText=util.b0(t.getMinutes())},100))):(util.query(r,".imglogo").style.display="block",util.query(r,".timelogo").style.display="none")}h=null,n.get("theme")||n.set("theme","a"),p=new SettingItem({index:0,title:"主题颜色",type:"select",message:"",get:function(){return n.get("theme")},callback:function(t){n.set("theme",t),y(t)},init:function(){return{a:"浅色",b:"深色",c:"跟随时间",d:"跟随系统"}}}),tyGroup.addNewItem(p),m=3,y(n.get("theme"));var h,p,m,v={setTheme:function(t){n.set("theme",t),y(t),p.reGet()},on:o,off:s,getTheme:function(){return h}};function y(t){3!=m&&(m=!1),"b"==t?(document.body.classList.add("dark"),a("themechange",["dark"]),h="dark"):"a"==t?(document.body.classList.remove("dark"),a("themechange",["light"]),h="light"):"c"==t?h=18<=(new Date).getHours()||(new Date).getHours()<6?(document.body.classList.add("dark"),a("themechange",["dark"]),"dark"):(document.body.classList.remove("dark"),a("themechange",["light"]),"light"):"d"==t&&(window.matchMedia?3==m?(m=!0,(t=window.matchMedia("(prefers-color-scheme: dark)")).matches?document.body.classList.add("dark"):document.body.classList.remove("dark"),t.addEventListener("change",t=>{h=t.matches?(document.body.classList.add("dark"),a("themechange",["dark"]),"dark"):(document.body.classList.remove("dark"),a("themechange",["light"]),"light")})):m=!0:toast("你的浏览器不支持此功能"))}return{setLite:t.set,isLite:t.get,getTheme:v.getTheme,setTheme:v.setTheme,isTimeLogo:g.get,setTimeLogo:v.set,on:o,off:s}}(),addon=function(){i=getEventHandle(),l=storage("addon",{sync:!0,title:"插件",desc:"QUIK起始页插件数据（暂未开发完）",rewrite:function(t,e,c){return new Promise(function(t){if(0==Object.keys(c).length)t();else{var e,i,n=new dialog({content:"<div>正在同步插件...[<span>0</span>/"+Object.keys(c).length+"]</div>",class:"dialog-addon-install"}),o=(n.open(),n.getDialogDom()),s=0;for(e in c)c[e].url&&d(c[e].url)?a():(c[e].marketId?i=h(c[e].marketId):c[e].type?a():i=p(c[e].url),i.on("done",function(){a()}),i.on("error",function(){a(),alert("安装一个插件时失败")}),i.on("wait",function(t){t(!0)}))}function a(){s++,(util.query(o,"span").innerHTML=s)==Object.keys(c).length&&t(l.getAll())}})}}),s=storage("addonscript"),e=["初始化","获取插件信息","下载插件","等待确认","安装插件","安装成功"],o=["初始化失败","未找到插件信息","下载插件失败","插件解析错误","用户取消","安装失败"],g.prototype={setProgress:function(t){this.progress=t,this.ev.doevent("progress",[t])},setStatu:function(t){this.statuCode=t,this.statuMsg=e[t],this.ev.doevent("statu",[{code:t,msg:e[t]}])},setError:function(t,e){this.errorCode=t,this.errorMsg=o[t]+" "+e,this.ev.doevent("error",[{code:t,msg:o[t]+" "+e}])},setDone:function(t){console.log("a"),this.result=t,this.ev.doevent("done",[t])},wait:function(e,i){this.waiting=!0;var n=this;this.ev.doevent("wait",[function(t){n.waiting=!1,i(t),n._waitfn=i,n._waitd=e},e]),this._waitfn=i,this._waitd=e}},t().forEach(t=>{l.get(t).disabled||m(t)});var n,i,l,s,e,o,a={enable:function(t){var e=l.get(t);e.disabled=!1,l.set(t,e)},disable:function(t){var e=l.get(t);e.disabled=!0,l.set(t,e)},installByOfficialMarket:h,installByUrl:p,installByLocal:function(e,i){var i=new g,n=(storage.checkIDB()||i.setError(0,"浏览器不支持IndexedDB"),i.setProgress(.1),i.setStatu(1),r(e));return n.error?i.setError(3,n.msg):(i.setProgress(.5),i.setStatu(3),i.wait({meta:n,msg:"确定是否安装此插件？"},function(t){t?u(e,n,{local:!0}).then(f(i)):i.setError(4,"")})),i},installByDev:function(t){var e=util.getRandomHashCache();return l.set(e,{name:"DEVPORT:"+t,url:t,type:"dev"}),i.doevent("installnew",[{id:e}]),m(e),e},uninstall:async function(e){var t=l.get(e);return!!t&&(l.remove(e),"dev"!=t.type&&await new Promise(t=>s.remove(e,!0,t)),i.doevent("uninstall",[{id:e}]),!0)},runAddon:m,checkUpdate:async function(t){var e;if(t=l.get(t))return!t.type&&(e=t.update,e=await(e=await fetch(e)).text(),(e=parseInt(e))>t.version_code);throw"not found addon"},update:async function(e){var t=l.get(e);if(console.log(t),!t)return{error:!0,msg:"未找到插件"};if(t.url){try{var i=await c(t.url)}catch(t){return{error:!0,msg:"代码请求失败",code:t}}var n=r(i);if(n.error)return{error:!0,msg:"META 解析失败:"+n.msg};if(n.signature!=t.signature)return{error:!0,msg:"签名校验失败"};if(n.version_code>=t.version_code){for(var o in n)t[o]=n[o];return await new Promise(function(t){s.set(e,i,!0,t)}),l.set(e,t),{ok:1,id:e,version_code:n.version_code}}return{error:!0,msg:"版本校验失败"}}return{error:!0,msg:"无法升级此插件"}},checkMarket:async function(t){for(var e in n||await v(),n){var i;if(n[e].url==t)return(i=JSON.parse(JSON.stringify(n[e]))).id=e,i}return!1},getAddonByUrl:d,getAddonBySessionId:function(t){return l.get(t)},getAddonList:t,getEnable:function(t){return!l.get(t).disabled},on:i.on,off:i.off};function c(n,o){return new Promise(function(t,e){var i=new XMLHttpRequest;i.open("GET",n,!0),i.onreadystatechange=function(){4==i.readyState&&200==i.status&&t(i.responseText)},i.onerror=function(){console.log("getCode error"),e(i.status)},i.onprogress=function(t){o&&o(t)},i.send()})}function r(t){return 0==(t=t.trim()).indexOf("/*QUIK_ADDON ")?"1"==(t=(t=t.substring(13,t.indexOf(" */"))).split("|"))[0]?{name:t[1],version_code:parseInt(t[2]),version:t[3],desc:t[4],author:t[5],icon:t[6],website:t[7],update:t[8],signature:t[9],marketId:t[10]}:{error:!0,msg:"un support meta version"}:{error:!0,msg:"not QUIK addon"}}async function u(e,t,i){if("object"!=typeof t||t.error)return{msg:"插件格式错误:"+(t.msg||"META isn't an object"),error:!0};if(function(t){if(t)for(var e=l.list(),i=0;i<e.length;i++)if(l.get(e).signature==t)return 1}(t.signature))return{msg:"已安装相同插件",error:!0};var n,o=util.getRandomHashCache();for(n in await new Promise(function(t){s.set(o,e,!0,t)}),t.id=o,i)void 0===t[n]&&(t[n]=i[n]);return l.set(o,t),await m(o),{id:o}}function d(t){var e,i=l.getAll();for(e in i)if(i[e].url==t)return i[e]}function g(){this.statuCode=0,this.statuMsg=e[0],this.progress=0,this.errorCode=-1,this.errorMsg="",this.result=null,this.ev=getEventHandle(),this.on=this.ev.on,this.off=this.ev.off}function f(e){return function(t){t.error?e.setError(5,t.msg):(e.setStatu(5),e.setProgress(1),e.setDone(t),i.doevent("installnew",[t]))}}function h(e){var i=new g;function t(){var t;n[e]?(i.setProgress(.1),i.setStatu(2),c(t=n[e].url,function(t){i.setProgress(.1+.5*t)}).then(function(t){i.setProgress(.6),i.setStatu(3),u(t,r(t),{marketId:e}).then(f(i))}).catch(function(){i.setError(2,t)})):i.setError(1,e)}return storage.checkIDB()||i.setError(0,"浏览器不支持IndexedDB"),n?t():v().then(t),i}function p(n){var o=new g;return storage.checkIDB()||o.setError(0,"浏览器不支持IndexedDB"),o.setProgress(.1),o.setStatu(2),c(n,function(t){o.setProgress(.1+.5*t)}).catch(function(t){console.log(t),o.setError(2,n)}).then(function(e){o.setProgress(.6);var i=r(e);i.error?o.setError(3,i.msg):(o.setStatu(3),o.wait({meta:i,msg:"确定是否安装此插件？"},function(t){t?u(e,i,{url:n}).then(f(o)):o.setError(4,"")}))}),o}async function m(e){var t=l.get(e),i=document.createElement("script");"dev"==t.type?(i.src=t.url+"index.js?id="+e,i.onerror=function(){alert("开发端口出错")}):(t=await new Promise(t=>s.get(e,!0,t)),i.innerHTML=`(function(){
        function Session(id){
          this.id="ext_"+id;
          this.session_token="Hvm_session_token_eoi1j2j";
          this.isSession=true;
        };
        var addonData={
          session:new Session('${e}')
        };
        (function(){
          ${t}
        })();
      })()`),document.body.appendChild(i)}async function v(){n={"000":{name:"插件名称",version:"1.0.0",description:"插件描述",author:"作者",icon:"插件图标",url:"插件下载链接"}}}function t(){return l.list()}b.prototype={bind:function(t){var e=this,i=this._d.getDialogDom();util.query(i,".msg").innerText=t.statuMsg+"...",util.query(i,".progress .r").style.width=100*t.progress+"%",-1!=t.errorCode&&(util.query(i,".msg").innerText=t.errorMsg,util.query(i,".progress").className="progress error",util.query(i,".btns").style.display="block",util.query(i,".btn.l").onclick=util.query(i,".btn.r").onclick=function(){e.hide(),setTimeout(function(){e.destory()},200)}),t.on("status",function(t){util.query(i,".msg").innerText=t.msg}),t.on("progress",function(t){util.query(i,".progress .r").style.width=100*t+"%"}),t.on("error",function(t){util.query(i,".msg").innerText=t.msg,util.query(i,".progress").className="progress error",util.query(i,".btns").style.display="block",util.query(i,".btn.l").onclick=util.query(i,".btn.r").onclick=function(){e.hide(),setTimeout(function(){e.destory()},200)}}),t.on("wait",function(t,e){e.meta&&(util.query(i,".sth img").src=e.meta.icon,util.query(i,".sth .name").innerText=e.meta.name,util.query(i,".sth .version").innerText="版本："+e.meta.version),util.query(i,".msg").innerText=e.msg,util.query(i,".btns").style.display="block",util.query(i,".btn.l").onclick=function(){t(!1)},util.query(i,".btn.r").onclick=function(){t(!0)}}),t.on("done",function(){console.log("a"),e.hide(),setTimeout(function(){e.destory()},200)})},ask:function(t,e){var i=this._d.getDialogDom();util.query(i,".msg").innerText=t,util.query(i,".btns").style.display="block",util.query(i,".btn.l").onclick=function(){e(!1),util.query(i,".btns").style.display="none"},util.query(i,".btn.r").onclick=function(){e(!0),util.query(i,".btns").style.display="none"}},show:function(){this._d.open()},hide:function(){this._d.close()},destory:function(){this._d.destory()}};var y=b;function b(){var t=new dialog({content:'<div class="ma"><div class="sth"><img src="assets/def_addon.png" alt="图标"><p class="name">...</p><p class="version">版本：...</p></div><div class="progress"><div class="r"></div></div><div class="msg"></div><div class="btns"><div class="btn l">取消</div><div class="btn r">确定</div></div></div>',class:"addon_install_ui"}),t=(this._d=t,this._d.getDialogDom());util.query(t,".btns").style.display="none"}var k=new dialog({content:'<div class="addon-bar"><div class="l"><div class="item active" data-p="0">插件管理</div><div class="item" data-p="1">插件市场</div></div><div class="r"><div class="add-btn">{{add-btn}}</div><div class="closeBtn">{{close-btn}}</div></div></div><div class="content"><div class="p gl" style="display:block"><ul></ul></div><div class="p ma"><div class="addon-search-box"><input type="text"> <button>{{search}}</button></div><ul></ul></div></div>'.replace("{{close-btn}}",util.getGoogleIcon("e5cd")).replace("{{search}}",util.getGoogleIcon("e8b6")).replace("{{add-btn}}",util.getGoogleIcon("e145")),mobileShowtype:dialog.SHOW_TYPE_FULLSCREEN,class:"addon-dialog"}),w=k.getDialogDom(),q=(util.query(w,".closeBtn").addEventListener("click",()=>{k.close()}),new menu({list:[{icon:util.getGoogleIcon("e157"),title:"从第三方链接添加插件",click:function(){prompt("请输入插件链接",function(t){var e;return!!t&&(t=a.installByUrl(t),(e=new y).show(),e.bind(t),t.on("done",function(t){alert("安装成功"),console.log(t)}),!0)})}},{icon:util.getGoogleIcon("e66d"),title:"从第三方文件添加插件",click:function(){showOpenFilePicker().then(function(t){var t=t[0],e=(t.name,new FileReader),i=new y;i.show(),e.onload=function(){var t=a.installByLocal(e.result);i.bind(t),t.ondone=function(t){installing_notice.destory(),alert("安装成功"),console.log(t)}},e.readAsText(t)})}},{icon:util.getGoogleIcon("e86f"),title:"添加开发者端口",click:function(){prompt("请输入开发者端口链接",function(t){if(!t)return!1;a.installByDev(t),alert("安装成功")})}}],offset:{top:0,left:0}}));util.query(w,".add-btn").addEventListener("click",function(t){t.stopPropagation();t=this.getBoundingClientRect();q.setOffset({top:t.top+t.height,right:window.innerWidth-t.left-t.width}),q.show()});new iconc.icon({offset:"tr",content:util.getGoogleIcon("e87b",{type:"fill"})}).getIcon().onclick=function(){k.open()};var L=util.query(w,".addon-bar .l .item",!0),x=util.query(w,".content .p",!0),S=(L.forEach(function(t){t.onclick=function(){L.forEach(function(t){t.classList.remove("active")}),this.classList.add("active"),x.forEach(function(t){t.style.display=""}),x[this.dataset.p].style.display="block"}}),util.query(w,".content .p.gl ul"));function I(i){var t=a.getAddonBySessionId(i),n=("dev"==t.type&&(t.name="开发者端口："+t.url,t.author="dev",t.desc="开发者端口："+t.url),util.query(S,'li[data-id="'+i+'"]')),e=(n||((n=util.element("li")).innerHTML='<div class="n"><img src="assets/def_addon.png" alt="" onerror="this.src=\'assets/def_addon.png\'"><div class="ds"><div class="name"><span></span><div class="disabled_state">已禁用</div></div><div class="message"><span></span> <span></span> <span></span></div></div></div><div class="d"><div class="desc"></div><div class="website"></div><div class="controls"><div class="btn ch_update">检查更新</div><div class="btn update">更新</div><div class="btn enable">启用</div><div class="btn disable">禁用</div><div class="btn uninstall" style="display:block">卸载</div></div></div>',n.dataset.id=i,S.appendChild(n),n.onclick=function(t){S.querySelectorAll("li").forEach(function(t){t.classList.remove("active")}),this.classList.add("active")},util.query(n,".ch_update").onclick=function(){o.innerHTML="检查更新中...";var e=this;e.style.display="",a.checkUpdate(i).then(function(t){t?(o.innerHTML="发现新版本",util.query(n,".update").style.display="block"):(e.style.display="block",o.innerHTML="已是最新版本")})},util.query(n,".update").onclick=function(){o.innerHTML="更新中...";var e=this;e.style.display="",a.update(i).then(function(t){t.error?(o.innerHTML="更新失败:"+t.msg,e.style.display="block"):(I(i),o.innerHTML="更新完成，刷新生效",util.query(n,".ch_update").style.display="inline-block")})},util.query(n,".enable").onclick=function(){o.innerHTML="已启用，刷新生效",a.enable(i),util.query(n,".disable").style.display="block",util.query(n,".disabled_state").style.display="none",this.style.display=""},util.query(n,".disable").onclick=function(){o.innerHTML="已禁用，刷新生效",a.disable(i),util.query(n,".enable").style.display="block",util.query(n,".disabled_state").style.display="",this.style.display=""},util.query(n,".uninstall").onclick=function(){confirm("你真的要卸载吗？此操作不可恢复！",function(t){t&&(o.innerHTML="正在卸载...",a.uninstall(i).then(function(t){t.error?alert("卸载出现错误："+t.msg):alert("卸载成功，刷新生效")}))})}),util.query(n,".n>img").src=t.icon||"assets/def_addon.png",util.query(n,".n .ds .name span").innerText=t.name,util.query(n,".n .ds .message span",!0)),o=(e[0].innerText=t.author||"不详",e[1].innerText=t.version||"",e[2].innerText="",util.query(n,".d .desc").innerText=t.desc||"",util.query(n,".d .website").innerText=t.website||"",util.query(n,".message span",!0)[2]);t.type||(util.query(n,".ch_update").style.display="block"),t.disabled?(util.query(n,".enable").style.display="block",util.query(n,".disabled_state").style.display=""):(util.query(n,".disable").style.display="block",util.query(n,".disabled_state").style.display="none")}return window.addon_?alert("已在安全模式下运行，插件功能已关闭！"):a.getAddonList().forEach(function(t){I(t)}),a.on("installnew",function(t){I(t.id)}),a.on("uninstall",function(t){t=util.query(S,'li[data-id="'+t.id+'"]');t&&t.remove()}),a.upinstallByOffcialMarket=function(t){},a.upinstallByUrl=function(o){return new Promise(function(e,i){var n=new y;n.show(),n.ask("要安装来自 "+o+" 的插件吗？",function(t){t?(t=a.installByUrl(o),n.bind(t),t.on("done",function(t){alert("安装成功"),e({code:0,result:t})}),t.on("error",function(t){i({code:-2,msg:"安装错误",err:t})})):(i({code:-1,msg:"用户取消"}),n.hide(),setTimeout(function(){n.destory()},200))})})},a.upuninstall=function(n){return new Promise(function(e,i){a.getAddonBySessionId(n)?confirm("要卸载 "+a.getAddonBySessionId(n).name+" 吗？",function(t){t?a.uninstall(n).then(function(t){t.error?(alert("卸载出现错误："+t.msg),i({code:-3,msg:"卸载出现错误",err:t})):(alert("卸载成功，刷新生效"),e({code:0,result:t}))}):i({code:-2,msg:"用户取消"})}):i({code:-1,msg:"没有该插件"})})},a.upupdate=function(n){return new Promise(function(e,i){a.getAddonBySessionId(n)?confirm("要更新 "+a.getAddonBySessionId(n).name+" 吗？",function(t){t?a.update(n).then(function(t){t.error?(alert("更新出现错误："+t.msg),i({code:-3,msg:"更新出现错误",err:t})):(alert("更新成功，刷新生效"),e({code:0,result:t}),I(n))}):i({code:-2,msg:"用户取消"})}):i({code:-1,msg:"没有该插件"})})},a}();let{alert,confirm,prompt}=function(){function o(){}var s='<div class="def_dialog"><h1>提示</h1><div class="content">$0</div><div class="footer">$1<button class="ok btn">确定</button></div></div>';return{alert:function(t,e){e=e||o;var i=new dialog({content:s.replace("$0","").replace("$1","")}),n=(setTimeout(function(){i.open()},10),i.getDialogDom());util.query(n,".content").innerText=t,util.query(n,".ok").onclick=function(){e(),i.close(),setTimeout(function(){i.destory()},299)}},confirm:function(t,e){e=e||o;var i=new dialog({content:s.replace("$0","").replace("$1",'<button class="cancel btn">取消</button>')}),n=(setTimeout(function(){i.open()},10),i.getDialogDom());util.query(n,".content").innerText=t,util.query(n,".ok").onclick=function(){e(!0),i.close(),setTimeout(function(){i.destory()},299)},util.query(n,".cancel").onclick=function(){e(!1),i.close(),setTimeout(function(){i.destory()},299)}},prompt:function(t,e){e=e||o;var i=new dialog({content:s.replace("$0",'<p class="c"></p><p><input type="text"/></p>').replace("$1",'<button class="cancel btn">取消</button>')}),n=(setTimeout(function(){i.open()},10),i.getDialogDom());util.query(n,".content .c").innerText=t,util.query(n,".ok").onclick=function(){e(util.query(n,".content input").value),i.close(),setTimeout(function(){i.destory()},299)},util.query(n,".cancel").onclick=function(){e(""),i.close(),setTimeout(function(){i.destory()},299)}}}}();var sync=function(){var{getJSON:i,setJSON:t}={getJSON:async function(t){for(var e=getStorageList(),i=getAllStorage(),n={},o=0;o<t.length;o++){var s=t[o];if(e[s]){n[s]={title:e[s].title||s,desc:e[s].desc||"",addon:e[s].addon,data:null};try{e[s]&&e[s].sync&&(e[s].get?(console.log("t"),n[s].data=await e[s].get()):(console.log("d"),n[s].data=await async function(t){var e,i={};for(e in t)if("string"==typeof t[e]&&"^"==t[e][0]){var n={"^_t":"db","^_k":t[e],"^_d":await localforage.getItem(t[e])};try{JSON.stringify(n),i[e]=n}catch(t){console.warn("非json支持格式存储不同步")}}else i[e]=t[e];return i}(i[s])))}catch(t){throw console.trace(),new Error("在获取 "+s+" 时遇到错误",t)}}else console.warn(s+" 存储区域不存在")}return n},setJSON:async function(t,e){var i,n=getStorageList(),o=getAllStorage();for(i in t)if(e[i])if(n[i]){if("rewrite"==e[i])if("function"==typeof n[i].rewrite)await n[i].rewrite(o,i,t[i].data);else{s=l=c=a=void 0;var s,a=o,c=i,l=t[i].data;for(s in l)if("db"==l[s]["^_t"]&&l[s]["^_k"]){if(!quik.storage.checkIDB())throw new Error("Your browser is not support indexedDB,Please update your browser.");await localforage.setItem(l[s]["^_k"],l[s]["^_d"]),a[c][s]=l[s]["^_k"]}else a[c][s]=l[s];await 0}else if("compare"==e[i]){if("function"!=typeof n[i].compare)throw new Error(i+" 不支持compare");await n[i].compare(o,i,t[i].data),console.log(o)}}else t[i].addon?console.warn(i+" 存储区域不存在，但提示需先安装插件，插件URL: "+t[i].addon):console.warn(i+" 存储区域不存在");console.log(o),localStorage.quik2=JSON.stringify(o),alert("数据导入成功，请重新加载页面",function(){location.hash="#newnow",location.reload()})}},e=new SettingGroup({title:"数据",index:4}),n=new SettingItem({title:"导出数据",message:"导出数据到文件",type:"null",callback:o});function o(){r.open();var t,e,i,n=getStorageList();for(t in n)n[t]&&n[t].sync&&(e=n[t],(i=document.createElement("div")).classList.add("item"),i.innerHTML=`<input type="checkbox"/><div class="message">
        <div class="title">${e.title||t}</div>
        <div class="desc">${e.desc||""}</div>
      </div>`,i.dataset.key=t,util.query(u,".exportslist").appendChild(i),util.query(i,"input").checked=!0)}var s=new SettingItem({title:"导入数据",message:"从文件导入数据",type:"null",callback:a});function a(){showOpenFilePicker().then(function(t){t=t[0];if(t)try{var e=new FileReader;e.onload=function(t){c(l=JSON.parse(t.target.result))},e.readAsText(t)}catch(t){alert("读取文件有误！")}})}function c(t){var e,i=getStorageList();for(e in m.open(),t)!function i(n,o,t){var s=document.createElement("div");if(n.addon&&!t[o]){var e=addon.getAddonByUrl(n.addon);if(!e)return void addon.checkMarket(n.addon).then(function(e){s.classList.add("item"),s.innerHTML=`<input type="checkbox" disabled/><div class="message">
            <div class="title">${n.title||o}</div>
            <div class="desc">需要安装插件以同步：${e?e.name:n.addon}</div>
          </div>
          <div class="installbtn">安装</div>`,s.dataset.key=o,util.query(v,".importslist").appendChild(s),s.querySelector(".installbtn").addEventListener("click",function(){var t;this.classList.contains("ing")||(this.classList.contains("err")&&this.classList.remove("err"),this.innerHTML="安装中...",this.classList.add("ing"),(t=e?addon.installByOfficialMarket(e.id):addon.installByUrl(n.addon)).on("error",function(t){s.querySelector(".installbtn").innerHTML="安装失败",this.classList.add("err")}),t.on("wait",function(t){t(!0)}),t.on("done",function(t){s.remove(),setTimeout(function(){i(n,o,getStorageList())},10)}))})})}s.classList.add("item");s.innerHTML=`<input type="checkbox"/><div class="message">
      <div class="title">${n.title||o}</div>
      <div class="desc">${n.desc||""}</div>
    </div>`;t[o].compare&&(s.innerHTML+=`<select>
        <option value="compare">对比</option>
        <option value="rewrite">覆盖</option>
      </select>`,util.query(s,"select").value="compare");s.dataset.key=o;util.query(v,".importslist").appendChild(s);util.query(s,"input").checked=!0}(t[e],e,i)}e.addNewItem(n),e.addNewItem(s),mainSetting.addNewGroup(e);var l=null,r=new dialog({content:`<div class="actionbar">
      <h1>导出数据</h1>
      <div class="closeBtn">${util.getGoogleIcon("e5cd")}</div>
    </div>
    <div class="exportslist">
    </div>
    <div class="btns">
      <div class="btn cancel">取消</div>
      <div class="btn ok">导出</div>
    </div>`,class:"sync-dialog",mobileShowtype:dialog.SHOW_TYPE_FULLSCREEN}),u=r.getDialogDom();util.query(u,".closeBtn").onclick=util.query(u,".cancel").onclick=function(){r.close()},util.query(u,".ok").onclick=function(){var e=[];util.query(u,".exportslist .item",!0).forEach(function(t){util.query(t,"input").checked&&e.push(t.dataset.key)}),i(e).then(function(t){var e,i;t=JSON.stringify(t),e="quik-2-exportdata.json",(i=document.createElement("a")).href=URL.createObjectURL(new Blob([t],{type:"application/json"})),i.download=e,i.click()}),r.close()};var d,g,f,h,p,m=new dialog({content:`<div class="actionbar">
      <h1>导入数据</h1>
      <div class="closeBtn">${util.getGoogleIcon("e5cd")}</div>
    </div>
    <div class="importslist">
    </div>
    <div class="btns">
      <div class="btn cancel">取消</div>
      <div class="btn ok">导入</div>
    </div>`,class:"sync-dialog",mobileShowtype:dialog.SHOW_TYPE_FULLSCREEN}),v=m.getDialogDom();async function y(t){await(d=t).isLogin()||await d.login(),"#newnow"==location.hash?await b():await new Promise(function(i,n){d.getLastReq().then(t=>{var e;t!=g.get("last_req")&&(e=h.getDialogDom(),"no"==t?b():(t=new Date(t).toLocaleString()+"的更改",util.query(e,".last_req").innerText=t,util.query(e,".btn.ok").onclick=function(){!async function(){var t=new dialog({content:"获取中。。。"}),e=(t.open(),await d.getAll());t.close(),c(e.data)}()},util.query(e,".btn.cancel").onclick=function(){b().then(i).catch(n)}))}).catch(n)});for(var e=g.get("wait"),i=0;i<e.length;i++)e[i].sp||(e[i].value=storage(e[i].key).getAll()),k(e[i]);storage.on("websync",function(t){var e=Date.now(),e=(t.id=e,t),i=g.get("wait");e.sp?i.push(e):i.push({key:e.key,id:e.id}),g.set("wait",i),p.show(),k(t)})}async function b(){p.show();var t=i(Object.keys(getStorageList())),e=Date.now();await d.updateAll(t,e),g.set("last_req",e),p.hide()}function k(o){d.update(o,function(t){if(t){g.set("last_req",reqId);var e=reqId;g.set("last_req",e);for(var i=g.get("wait"),n=0;n<i.length;n++)if(i[n].id==e){i.splice(n,1);break}g.set("wait",i),0==i.length&&p.hide()}else new notice({title:"云同步",content:"数据（"+new Date(reqId).toLocaleString()+"的更改）同步失败了，是否重试？",btns:[{text:"确定",click:function(){k(o)}},{text:"取消",click:function(){}}]}).show()})}return util.query(v,".closeBtn").onclick=util.query(v,".cancel").onclick=function(){l=null,m.close()},util.query(v,".ok").onclick=function(){var e={};util.query(v,".importslist .item",!0).forEach(function(t){util.query(t,"input").checked&&(util.query(t,"select")?e[t.dataset.key]=util.query(t,"select").value:e[t.dataset.key]="rewrite")}),t(l,e),r.close()},(g=storage("websync")).get("wait")||g.set("wait",[]),f=g.get("yesid"),h=new dialog({content:`<div>
            <p>您的在线存档与本地存档存在冲突:</p>
            <p class="last_req"></p>
            <p>你要：</p>
        </div>
        <div class="btns">
            <div class="btn ok">从在线同步</div>
            <div class="btn cancel">本地覆盖在线</div>
        </div>`}),(p=new iconc.icon({content:util.getGoogleIcon("eb5a"),offset:"br",important:!0})).hide(),{getJSON:i,setJSON:t,openImport:a,openExport:o,registerWebSync:function(e,i,n){util.checkDetailsCorrect(e,["isLogin","login","getLastReq","getAll","update","updateAll"])?util.checkSession(i)?f!=i.id?comfirm('插件 "'+addon.getAddonById(i.id)+'" 申请提供数据云同步功能，是否同意？',function(t){t?(f=i.id,g.set("yesid",f),g.remove("last_reqid"),n({code:0,msg:"OK"}),y(e)):n({code:-1,msg:"用户取消"})}):(n({code:0,msg:"OK"}),y(e).catch(function(t){new notice({title:"云同步",content:"云同步初始化失败，请检查网络连接后刷新"}).show(),console.log(t)})):n({code:-3,msg:"session不正确"}):n({code:-2,msg:"格式不正确"})}}}(),hotkey=void document.addEventListener("keydown",function(t){"s"==t.key&&t.altKey?(t.preventDefault(),mainSetting.open()):"x"==t.key&&t.altKey?(t.preventDefault(),custom.setLite(!custom.isLite())):"g"==t.key&&t.altKey&&(t.preventDefault(),link.setShowCate(!link.isShowCate()))}),ignores=function(){var t=new SettingGroup({title:"关于",index:5}),e=(mainSetting.addNewGroup(t),new SettingItem({type:"null",title:"关于QUIK起始页",index:1,callback:function(){s.open()}})),i=new SettingItem({type:"null",title:"更新日志",index:2,callback:function(){l.open()}}),n=new SettingItem({type:"null",title:"用户协议和隐私政策",index:3,callback:function(){r.open()}}),o=new SettingItem({type:"null",title:"特别鸣谢",index:4,callback:function(){u.open()}}),s=(t.addNewItem(e),t.addNewItem(i),t.addNewItem(n),t.addNewItem(o),mainmenu.pushMenu({icon:util.getGoogleIcon("e88e"),title:"关于QUIK",click:function(){s.open()}},1),new dialog({content:'<div class="about-dialog"><div class="close">{{close-btn}}</div><div class="ab-logo"><svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 456 128"><circle cx="64" cy="64" r="40" stroke="black" stroke-width="3" fill="transparent"/><line x1="74" y1="74" x2="104" y2="104" style="stroke:rgb(0,0,0);stroke-width:3;"/><path d="M148 24L148 68Q148 104 180 104Q212 104 212 68L212 24" style="fill:transparent;stroke:rgb(0,0,0);stroke-width:3;"></path><path d="M276 24L306 24M291 24L291 104M276 104L306 104" style="fill:transparent;stroke:rgb(0,0,0);stroke-width:3;"></path><path d="M384 24L384 104M424 26L384 68M424 102L384 68" style="fill:transparent;stroke:rgb(0,0,0);stroke-width:3;"></path></svg></div><div class="t ver">当前版本: <span></span></div><div class="t intro">介绍: QUIK起始页是由前端爱好者<a href="https://siquan001.github.io/?ref=quik" target="_blank">陈思全</a>编写的一个简洁、实用的浏览器主页</div><div class="t license">版权声明: 本项目以GPL 3.0协议声明，版权归原作者所有。</div><div class="t thanks">感谢这些项目或可爱的人为QUIK起始页提供的支持: <a href="javascript:;">点击查看</a></div><div class="t feedback">反馈: chensiquan2023@qq.com</div></div>'.replace("{{close-btn}}",util.getGoogleIcon("e5cd")),mobileShowtype:dialog.SHOW_TYPE_FULLSCREEN})),a=s.getDialogDom(),c=(util.query(a,".close").onclick=function(){s.close()},util.query(a,".t.thanks a").onclick=function(){u.open()},setTimeout(function(){util.query(a,".ver span").innerText=window.version.version}),{"1.7.8":{updates:[{tag:"change",content:"UI第一次大优化"},{tag:"thanks",content:"感谢 川上星林 提供的反馈"}],time:"2023/9/24"},"1.7.5":{updates:[{tag:"change",content:"优化UI"},{tag:"new",content:"新增显示效果设置"},{tag:"fix",content:"修复若干问题，优化体验"},{tag:"thanks",content:"感谢 edgebook 提供的反馈"}],time:"2023/9/23"},"1.7.2":{updates:[{tag:"fix",content:"修复一言BUG"},{tag:"fix",content:"修复若干问题，优化体验"}],time:"2023/9/22"},"1.7.1":{updates:[{tag:"new",content:"一言添加今日诗词API"}],time:"2023/9/17"},1.7:{updates:[{tag:"change",content:"更新文档"},{tag:"fix",content:"进一步解决背景相关的BUG"},{tag:"change",content:"切换背景API为故梦API"},{tag:"new",content:"API背景支持下载到本地"},{tag:"new",content:"为休息模式的图片和一言和第一界面底部一言添加来源信息，休息模式的图片来源会显示在左上角，一言的来源在鼠标放在一言上时显示"},{tag:"new",content:"天气支持查看不同的城市（仅中国大陆）"},{tag:"fix",content:"修复若干问题，优化体验"}],time:"2023/9/10"},1.6:{updates:[{tag:"fix",content:"修复背景模糊的BUG"},{tag:"change",content:"底部一言修改方式改为直接点击"},{tag:"new",content:"添加一个彩蛋（我可不会告诉你）"}],time:"2023/9/2"},1.5:{updates:[{tag:"new",content:"添加搜索框内容翻译功能"},{tag:"new",content:"添加搜索框输入=计算"},{tag:"new",content:"天气预报添加空气质量"},{tag:"new",content:"新增问候功能"}],time:"2023/8/29"},"1.3.1":{updates:[{tag:"change",content:"修改QUIK起始页使用的图片相关API"},{tag:"change",content:"修改QUIK起始页使用的热榜相关API"}],time:"2023/8/22"},1.3:{updates:[{tag:"new",content:"添加休息模式(Beta)，Ctrl+Alt+B进入，Ctrl+Q退出，累了就休息一下吧~"},{tag:"change",content:"修改用户协议与隐私政策、新手文档等"}],time:"2023/8/20"},"1.2.1":{updates:[{tag:"fix",content:"修复已知BUG,优化用户体验"}],time:"2023/8/20"},1.2:{updates:[{tag:"new",content:"便笺:支持在第一界面就可以直接添加固定的便签，并在编辑页面添加固定按钮。"},{tag:"new",content:"搜索框:添加一个搜索框仅搜索的设置"},{tag:"new",content:"链接:下方链接可以支持大中小三个样式"},{tag:"new",content:"热点:支持把热点添加到首页"},{tag:"fix",content:"计算器:修复+/-键"}],time:"2023/8/18"},"1.0.1":{updates:[{tag:"fix",content:"修复已知BUG,优化用户体验"}],time:"2023/8/3"},"1.0.0":{updates:[{tag:"new",content:"梦开始的地方~"}],time:"2023/8/1"}}),l=new dialog({content:`<div class="actionbar">
      <h1>更新日志</h1>
      <div class="closeBtn">${util.getGoogleIcon("e5cd")}</div>
    </div>
    <div class="version_list"></div>`,mobileShowtype:dialog.SHOW_TYPE_FULLSCREEN,class:"update_dia"}),e=l.getDialogDom();util.query(e,".closeBtn").onclick=function(){l.close()},util.query(e,".version_list").innerHTML=function(){var t,e="";for(t in c)e+=function(t,e){for(var i="",n={new:"新增",del:"删除",fix:"修复",change:"修改",thanks:"感谢"},o=e.updates,s=0;s<o.length;s++)i+='<div class="update_item"><div class="update_item_tag '+o[s].tag+'"><div>'+n[o[s].tag]+'</div></div><div class="update_item_content">'+o[s].content+"</div></div>";return'<div class="version_item"><div class="version_item_title">'+t+'</div><div class="version_item_update_time">发布时间：'+e.time+'</div><div class="version_update">'+i+"</div></div>"}(t,c[t]);return e}();i='<h1>QUIK起始页用户协议与隐私政策</h1><p><b>请务必认真阅读！</b></p><h2>一、QUIK起始页简介</h2><p>QUIK起始页（以下简称本产品）是一个由个人开发者（<a href="https://siquan001.github.io/" target="_blank">陈思全</a>）编写的一个开源免费的纯前端项目，以GPL 3.0 license声明，版权归原作者所有</p><h2>二、用户使用须知</h2><p>1.使用本产品即代表您同意本条款的所有内容。</p><p>2.本产品中一言的“随机一言”功能由Ten·API提供，如若出现有关一言的“随机一言”的内容相关问题，请联系Ten·API，本产品不负责任</p><p>3.本产品中一言的“今日诗词”功能由jinrishici.com提供，如若出现有关一言的“今日诗词”的内容相关问题，请联系jinrishici.com，本产品不负责任</p><p>4.本产品中的搜索联想功能由百度提供，如若出现有关搜索联想的内容相关问题，请联系百度，本产品不负责任</p><p>5.本产品中背景的“必应壁纸”功能由bing.shangzhenyang.com和必应提供，如若出现有关背景的“必应壁纸”的图片内容相关问题，请联系bing.shangzhenyang.com和必应，本产品不负责任</p><p>6.本产品中背景的“随机二次元壁纸”功能由loliapi.com提供，如若出现有关背景的“随机二次元壁纸”的图片内容相关问题，请联系loliapi.com，本产品不负责任</p><p>7.本产品中背景的“随机风景壁纸”功能由api.gumengya.com提供，如若出现有关背景的“随机风景壁纸”的图片内容相关问题，请联系api.gumengya.com，本产品不负责任</p><p>7.本产品中搜索框的“自动翻译”功能由api.gumengya.com提供，如若出现有关搜索框的“自动翻译”的内容相关问题，请联系api.gumengya.com，本产品不负责任</p><p>8.本产品的随机背景API均支持下载壁纸，但这些壁纸仅能用做壁纸，禁止商业化使用</p><h2>三、插件使用须知</h2><p>1.本产品提供插件拓展功能，使用本产品的插件拓展功能即代表您知晓并同意本条款的所有内容。</p><p>2.安装官方提供的插件需要您同意插件的用户协议与隐私政策，若与本协议存在出入，以本协议为准</p><p>3.安装来自第三方的不明插件是十分不安全的行为，同时请保证您的设备未被病毒程序感染，<b>否则本产品不能保证您的数据安全和使用安全！</b></p><h2>四、隐私政策</h2><p>1.本产品本身属于纯前端项目，不会收集您的任何信息，您的所有数据都会存在本地</p><p>2.如您安装了插件，插件可能会收集您的一些信息，详见插件的用户协议与隐私政策。</p><p>3.本产品中使用的一些API和站点服务提供者可能会收集您的IP地址、Cookie等信息用于数据分析和安全防护等</p>';var r=new dialog({content:` <div class="close">${util.getGoogleIcon("e5cd")}</div><div class="lic-con">${i}</div>`,mobileShowtype:dialog.SHOW_TYPE_FULLSCREEN,class:"lic-dialog"}),u=(util.query(r.getDialogDom(),".close").onclick=function(){r.close()},new dialog({content:`<div class="close">${util.getGoogleIcon("e5cd")}</div><div class="thank-con"><h1>特别鸣谢</h1><h2>感谢以下项目对QUIK的支持</h2><ul><li><a href="https://github.com/localForage/localForage" target="_blank">localforage</a> - 为indexedDB的管理提供一个方便的类似于localStorage的API</li><li><a href="https://github.com/siquan001/rem/" target="_blank">REM</a> - 简单的模块化工具（我做的）</li></ul><h2>感谢以下服务对QUIK的支持</h2><ul><li><a href="https://loliapi.com/" target="_blank">loliapi</a> - 双端自适应随机二次元图片API提供</li><li><a href="https://api.gumengya.com/" target="_blank">故梦API</a> - 随机风景图片API提供</li><li><a href="https://tenapi.cn/" target="_blank">Ten·API</a> - 随机一言API提供</li><li><a href="https://bing.com/" target="_blank">必应</a> | <a href="https://bing.shangzhenyang.com/" target="_blank">bing.shangzhenyang.com</a> - 每日必应壁纸API提供</li><li><a href="https://jinrishici.com/" target="_blank">jinrishici.com</a> - 随机诗词API提供</li><li><a href="https://baidu.com/" target="_blank">百度</a> - 搜索联想API提供</li><li><a href="https://github.com/" target="_blank">Github</a> - 静态网站托管服务提供</li></ul><h2>感谢以下可爱的人对QUIK的支持</h2><ul><li><a href="https://stear.cn/wm/" target="_blank">川上星林</a></li></ul><p>没有你们，就没有现在的QUIK起始页。</p></div>`,class:"thank-dialog",mobileShowtype:dialog.SHOW_TYPE_FULLSCREEN}));return util.query(u.getDialogDom(),".close").onclick=function(){u.close()},{lic:i}}();!function(){window.version_code=35,window.version={version:"2.0.0-dev",version_code:window.version_code,updateTime:"2024/6/29",log:[{tag:"change",content:"修改了部分设置的内容，一些设置需重新设置"}]},"serviceWorker"in navigator&&!window._dev&&(navigator.serviceWorker.ready.then(function(e){window.swReg=e,quik.util.xhr("./version",function(t){parseInt(t)>version_code&&e.active.postMessage("update")},function(){console.log("获取版本失败")})}),navigator.serviceWorker.addEventListener("message",function(t){"updated"==t.data&&quik.confirm("新版本已准备就绪，是否刷新页面",function(t){t&&(localStorage.setItem("__q__s__","1"),location.reload())})}));var t=null;function e(){t||(t=new dialog({content:`<h1>版本更新</h1><div class="version_item">
<div class="version_item_title">版本号：${window.version.version}</div>
<div class="version_item_update_time">发布时间：${window.version.updateTime}</div>
<div class="version_update">${function(t){for(var e="",i={new:"新增",del:"删除",fix:"修复",change:"修改",thanks:"感谢"},n=0;n<t.length;n++)e+='<div class="update_item"><div class="update_item_tag '+t[n].tag+'"><div>'+i[t[n].tag]+'</div></div><div class="update_item_content">'+t[n].content+"</div></div>";return e}(window.version.log)}</div>
</div><div class="footer"><div class="btn ok">我知道了</div></div>`,class:"update_dialog"}),util.query(t.getDialogDom(),".btn.ok").onclick=function(){t.close()}),setTimeout(function(){t.open()})}localStorage.getItem("__q__s__")&&(e(),localStorage.removeItem("__q__s__"))}(),!function(){var e=storage("safe");function t(){var t=location.hash;"#clearAll"==t?confirm("确定要清除所有数据吗？",function(t){t&&!function e(){prompt("请在下方输入“clearAll”，并再次确定是否要清除所有数据，此操作无法恢复。",function(t){"clearAll"==t?(localStorage.clear(),localforage.clear().then(function(){location.reload()}),location.hash=""):t&&e()})}()}):"#safe"==t&&(location.hash="",window.addon_=!1,alert("已阻止所有插件运行"))}window.addEventListener("hashchange",t),t();var i=new SettingGroup({title:"高级",index:5}),n=new SettingItem({title:"性能模式",message:"强制关闭所有滤镜和动画效果",index:1,type:"boolean",get:function(){return!!e.get("xnse")},callback:function(t){e.set("xnse",t),o(t)}}),n=(i.addNewItem(n),new SettingItem({title:"清除数据",message:"清除QUIK起始页的所有数据",index:2,type:"null",callback:function(t){location.hash="#clearAll"}}));function o(t){if(t){t=util.element("style");t.id="xnse",t.innerHTML="*{filter:none!important;backdrop-filter:none!important;animation:none!important;transition:none!important;}",document.head.append(t)}else try{document.getElementById("xnse").remove()}catch(t){}}i.addNewItem(n),mainSetting.addNewGroup(i),o(!!e.get("xnse")),window.addEventListener("offline",c),window.addEventListener("online",c);var s=new iconc.icon({content:util.getGoogleIcon("f239"),offset:"br",important:!0}),a=(s.getIcon().style.color="red",new notice({title:"断网提醒",content:"您的网络已断开，请尽快重连！"}));function c(){window.navigator.onLine?(a.hide(),s.hide()):(a.show(),a.focus(),s.show())}c()}(),!function(){var t,e,i,n,o,s,a=storage("oobe");function c(){0<e&&(util.query(s,".part.a"+e).classList.remove("show"),util.query(s,".part.a"+e).classList.add("n")),e==n.length?o.close():(e++,setTimeout(function(){util.query(s,".part.a"+e).classList.add("show")},200))}a.get("agree")||(t=ignores.lic,e=0,i='<div class="part a1">{{part1}}</div><div class="part a2">{{part2}}</div>',(n=['<div class="lic-c">{{lic}}</div><div class="btns"><div class="btn cancel">不同意</div><div class="btn ok">同意</div></div>','<div class="imglogo"><svg xmlns="http://www.w3.org/2000/svg" style="stroke: #000;" version="1.1" viewBox="0 0 456 128"><circle cx="64" cy="64" r="40" stroke-width="3" fill="transparent"/><line x1="74" y1="74" x2="104" y2="104" style="stroke-width:3;"/><path d="M148 24L148 68Q148 104 180 104Q212 104 212 68L212 24" style="fill:transparent;stroke-width:3;"></path><path d="M276 24L306 24M291 24L291 104M276 104L306 104" style="fill:transparent;stroke-width:3;"></path><path d="M384 24L384 104M424 26L384 68M424 102L384 68" style="fill:transparent;stroke-width:3;"></path></svg></div><div class="biaoyu">2.0版本，焕新归来！</div><div class="clist"><div class="item a">开始使用</div><div class="item b">导入数据</div></div>']).forEach(function(t,e){i=i.replace("{{part"+(e+1)+"}}",t)}),i=i.replace("{{lic}}",t),o=new dialog({content:i,class:"oobedia",mobileShowtype:dialog.SHOW_TYPE_FULLSCREEN}),s=o.getDialogDom(),util.query(s,".part.a1 .btn.ok").onclick=function(){a.set("agree",!0),c()},util.query(s,".part.a1 .btn.cancel").onclick=function(){location.href="about:blank"},util.query(s,".part.a2 .item.a").onclick=function(){c()},util.query(s,".part.a2 .item.b").onclick=function(){c(),sync.openImport()},c(),o.open())}(),window.quik={fcard:fcard,custom:custom,sync:sync,addon:{installByOffcialMarket:addon.upinstallByOffcialMarket,installByUrl:addon.upinstallByUrl,uninstall:addon.upuninstall,update:addon.upupdate,getAddonByUrl:addon.getAddonByUrl,getAddonBySessionId:addon.getAddonBySessionId,getAddonList:addon.getAddonList},storage:storage,omnibox:omnibox,util:util,link:link,dialog:dialog,toast:toast,says:says,menu:menu,iconc:iconc,background:background,mainmenu:mainmenu,Setting:Setting,SettingGroup:SettingGroup,SettingItem:SettingItem,mainSetting:mainSetting,notice:notice,tyGroup:tyGroup,alert:alert,confirm:confirm,prompt:prompt,card:card},clearTimeout(loadingtimeout),document.querySelector("main").style.display="block",document.querySelector(".loading-f").classList.add("h"),document.querySelector(".loading-f").style.display="none"}();