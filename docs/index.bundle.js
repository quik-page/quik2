(function(){function showOpenFilePicker(){return new Promise((function(t,e){var i=document.createElement("input");i.type="file",document.body.append(i),i.style.display="none",i.click(),i.onchange=function(){t(i.files),i.remove()}}))}var onshows_fns=[];function Onshow(t){onshows_fns.push(t)}var getEventHandle=(events=[],function(){var t=events.length;return events.push({}),{on:function(e,i){return events[t][e]||(events[t][e]=[]),events[t][e].push(i),!0},off:function(e,i){if(!events[t][e])return!1;for(var n=0;n<events[t][e].length;n++)if(events[t][e][n]===i)return events[t][e].splice(n,1),!0;return!1},doevent:function(e,i){if(!events[t][e])return!1;Array.isArray(i)||(i=[i]);for(var n=0;n<events[t][e].length;n++)events[t][e][n].apply(null,i);return!0}}}),events,util=function(){-1!=location.hash.indexOf("extdheodqp2eidhjwe")?(window.isExt=!0,-1!=location.hash.indexOf(";")?window.extid=location.hash.substring(location.hash.indexOf(":")+1,location.hash.indexOf(";")):window.extid=location.hash.substring(location.hash.indexOf(":")+1,location.hash.length)):window.isExt=!1;var t=[],e=0;return window.addEventListener("message",(function(e){if("xhr_cb"==e.data.type)for(var i=e.data.id,n=0;n<t.length;n++)if(t[n].id==i){"function"==typeof t[n][e.data.fn]&&t[n][e.data.fn](e.data.data),1==e.data.finish&&t.slice(n,1);break}})),{deepClone:function(t){const e=new WeakMap;function i(t){return"object"==typeof t&&t||"function"==typeof t}return function t(n){if(!i(n))return n;if([Date,RegExp].includes(n.constructor))return new n.constructor(n);if("function"==typeof n)return new Function("return "+n.toString())();const o=e.get(n);if(o)return o;if(n instanceof Map){const o=new Map;return e.set(n,o),n.forEach(((e,n)=>{i(e)?o.set(n,t(e)):o.set(n,e)})),o}if(n instanceof Set){const o=new Set;return e.set(n,o),n.forEach((e=>{i(e)?o.add(t(e)):o.add(e)})),o}const s=Reflect.ownKeys(n),a=Object.getOwnPropertyDescriptors(n),c=Object.create(Object.getPrototypeOf(n),a);return e.set(n,c),s.forEach((e=>{const o=n[e];i(o)?c[e]=t(o):c[e]=o})),c}(t)},requestByExt:function(i){e++,i.id=e,t.push(i);var n=this.deepClone(i);for(var o in n)"function"==typeof n[o]&&(n[o]={_t:"fn",_n:o});parent.postMessage({type:"xhr",data:n,id:e},"*")},addStyle:function(t){var e=util.element("style");e.innerHTML=t,document.head.appendChild(e)},initSet:function(t,e,i){var n=t.get(e);if("object"==typeof i&&i)if("object"==typeof n&&n){for(var o in i)n[o]||(n[o]=i[o]);t.set(e,n)}else void 0===n&&t.set(e,i);else void 0===n&&t.set(e,i)},joinObj:function(){var t=arguments,e=t[0];function i(t,e){for(var i in e)t[i]=e[i];return t}for(var n=1;n<t.length;n++)e=i(e,t[n]);return e},loadimg:function(t,e){var i=new Image;i.src=t,i.onload=function(){e(!0)},i.onerror=function(){e(!1)}},element:function(t,e={}){var i=document.createElement(t);for(var n in e)i.setAttribute(n,e[n]);return i},query:function(t,e,i){return t["querySelector"+(i?"All":"")](e)},getFavicon:function(t,e){try{var i=new URL(t)}catch(t){return void e(!1)}var n="https://api.iowen.cn/favicon/"+i.host+".png";-1!=i.hostname.indexOf("bing.com")?n="https://bing.com/favicon.ico":-1!=i.hostname.indexOf("www.google.com")||0==i.hostname.indexOf("google.com")?n="https://s2.loli.net/2024/08/10/dVNZ4SzFxTMpj1a.png":-1!=i.hostname.indexOf("stear.cn")&&(n="https://stear.cn/assets/img/216.png"),this.loadimg(n,(function(t){t?e(n):util.loadimg(i.protocol+"//"+i.host+"/favicon.ico",(function(t){e(!!t&&i.protocol+"//"+i.host+"/favicon.ico")}))}))},createIcon:function(t){var e=document.createElement("canvas");e.width=64,e.height=64;var i=e.getContext("2d");return i.fillStyle=this.getRandomColor(),i.font="bold 32px Arial",i.fillText(t,20,40),e.toDataURL()},getRandomColor:function(){return"#"+Math.random().toString(16).substring(2,8).toUpperCase()},fangdou:function(t,e){var i=null;return function(){i&&clearTimeout(i);var n=this;i=setTimeout((function(){t.apply(n,arguments)}),e)}},jsonp:function(t,e,i){var n="a"+Math.random().toString(36).slice(2),o=this.element("script",{src:function(t,e,i){var n=new URL(t);return n.searchParams.set(e,i),n.href}(t,i||"callback",n)});return document.body.appendChild(o),o.onerror=function(){e(!1),document.body.removeChild(o)},window[n]=function(t){e(t);try{document.body.removeChild(o)}catch(t){}delete window[n]},{abort:function(){try{o.remove()}catch(t){}}}},xhr:function(t,e,i){var n=new XMLHttpRequest;return n.onreadystatechange=function(){4==n.readyState&&(200==n.status?e(n.responseText):n.status>=400&&i&&i({status:n.status,statusText:n.statusText,readyState:n.readyState,responseText:n.responseText}))},n.onerror=function(){i&&i({status:n.status,statusText:n.statusText,readyState:n.readyState,responseText:n.responseText})},n.open("GET",t,!0),n.send(),{abort:function(){n.abort()}}},checkSession:function(t){return t.isSession&&"Hvm_session_token_eoi1j2j"===t.session_token},getRandomHashCache:function(){return Math.random().toString(36).slice(2)+Date.now().toString(36)},copyText:function(t){if(window.isExt)parent.postMessage({type:"copy",text:t},"*");else if(navigator.clipboard)navigator.clipboard.writeText(t);else{const e=document.createElement("input");e.value=t,e.style.display="none",document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e)}toast.show("复制成功")},getGoogleIcon:function(t,e){return'<span class="material-symbols-outlined'+(e&&e.type?" "+e.type:"")+'">&#x'+t+";</span>"},getGoogleIconByString:function(t,e){return'<span class="material-symbols-outlined'+(e&&e.type?" "+e.type:"")+'">'+t+"</span>"},checkDetailsCorrect:function(t,e){for(var i=0;i<e.length;i++)if(0==t.hasOwnProperty(e[i]))return!1;return!0},checkUrl:function(t){return/^(https?:\/\/)?([a-zA-Z0-9\.\-]+(\:[a-zA-Z0-9\.&%\$\-]+)*@)?((25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[1-9])\.(25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[1-9]|0)\.(25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[0-9])|([a-zA-Z0-9\-]+\.)*[a-zA-Z0-9\-]+\.[a-zA-Z]{2,4})(\:[0-9]+)?(\/[^\/][a-zA-Z0-9\.\,\?\'\\\/\+&%\$#\=~_\-@]*)*(\/)?$/.test(t)},b0:function(t){return t<10?"0"+t:t}}}(),toast=(to=util.element("div",{class:"toast"}),g=null,g2=null,util.query(document,"body").append(to),{show:function(t,e){to.innerHTML=t,to.classList.add("show"),to.style.animation="toastin .3s",clearTimeout(g),clearTimeout(g2),g=setTimeout((function(){to.style.animation="toastout .3s",g2=setTimeout((function(){to.classList.remove("show")}),298)}),e||2e3)}}),to,g,g2,iconc=(icners={tl:util.query(document,".topper .left"),tr:util.query(document,".topper .right"),bl:util.query(document,".bottomer .left"),br:util.query(document,".bottomer .right")},icon=function(t){this.content=t.content,this.width=t.width;var e=util.element("div",{class:"item"+(t.class?" "+t.class:"")+(t.important?" important":"")});icners[t.offset].append(e),e.innerHTML=this.content,this.element=e,this.width&&(e.style.width=this.width+"px")},icon.prototype={getIcon:function(){return this.element},setIcon:function(t){this.content=t,this.element.innerHTML=this.content},setWidth:function(t){this.width=t,this.width&&(ic.style.width=this.width+"px")},getWidth:function(){return this.width},show:function(){this.element.classList.remove("hide"),this.element.classList.add("show")},hide:function(){this.element.classList.add("hide"),this.element.classList.remove("show")}},{icon:icon}),icners,icon,{storage:storage,getStorageList:getStorageList,getAllStorage:getAllStorage,dbTool:dbTool}=function(){localStorage.quik2||(localStorage.quik2="{}");var t=getEventHandle(),e=localforage._getSupportedDrivers([localforage.INDEXEDDB])[0]==localforage.INDEXEDDB,i={get:function(t,e){localforage.getItem(t).then(e)},set:function(t,e,i){e=e||"^"+util.getRandomHashCache(),localforage.setItem(e,t).then((function(){i(e)}))},delete:function(t,e){localforage.removeItem(t).then(e)}},n={},o=function(o,s){if("string"==typeof o){function a(t,n,s){if(!n)return c()[o][t];if(!e)throw new Error("indexedDB is not support in this browser");i.get(c()[o][t],(function(t){s(t)}))}function c(){return JSON.parse(localStorage.getItem("quik2"))}function l(e){var i=c();i[o]=e,localStorage.setItem("quik2",JSON.stringify(i)),t.doevent("storage",[{key:o,value:e}]),s&&!s.websync&&s.sync&&t.doevent("websync",[{key:o,value:e}])}return JSON.parse(localStorage.getItem("quik2"))[o]||l({}),n[o]=s,{get:a,websync:function(e){t.doevent("websync",[{key:o,value:e,sp:!0}])},set:function(t,n,s,r){if(s){if(!e)throw new Error("indexedDB is not support in this browser");i.set(n,a(t),(function(e){var i=c();i[o][t]=e,l(i[o]),r(e)}))}else{var u=c();u[o][t]=n,l(u[o])}},remove:function(t,n,s){var a=c();if(n){if(!e)throw new Error("indexedDB is not support in this browser");i.delete(a[o][t],(function(){var e=c();delete e[o][t],l(e[o]),s()}))}else delete a[o][t],l(a[o])},list:function(){return Object.keys(c()[o])},getAll:function(){return c()[o]},clear:function(){var t=c()[o];for(var e in t){var n=e[t];"string"==typeof n&&n.startsWith("^")&&i.delete(n)}l({})}}}throw new Error("ck is not a string")};return o.checkIDB=function(){return e},o.on=t.on,o.off=t.off,{storage:o,getStorageList:function(){return n},getAllStorage:function(){return JSON.parse(localStorage.getItem("quik2"))},dbTool:i}}(),dialog=function(){var t=[],e=1,i=0,n=function(e){this.options=e;var n=util.element("div",{class:"dialog"});n.innerHTML=`<div class="d-b"></div><div class="d-c">${e.content}</div>`,util.query(document,".dialogs").append(n);var s=util.query(n,".d-c");e.class&&s.classList.add(e.class),1==e.mobileShowtype&&n.classList.add("mobile-show-full"),this.element=n,this.id=i,i++,n.setAttribute("data-id",this.id),void 0===e.clickOtherToClose?this.clickOtherToClose=!0:this.clickOtherToClose=e.clickOtherToClose,this.clickOtherToClose&&n.querySelector(".d-b").addEventListener("click",(function(){o(this.parentElement.getAttribute("data-id")).close()})),t.push(this)};function o(e){var i=null;return t.forEach((function(t){t.id==e&&(i=t)})),i}return n.SHOW_TYPE_FULLSCREEN=1,n.SHOW_TYPE_DIALOG=2,n.iframeDialogBuilder=function(t,e=1){var i=new n({content:`<div class="material-symbols-outlined closebtn">&#xE5CD;</div><iframe src="${t}" class="dialog-iframe"></iframe>`,class:"iframe-dialog",mobileShowtype:e}),o=i.getDialogDom();return util.query(o,".closebtn").onclick=function(){i.close()},this.closed=!0,i},n.getDialogById=o,n.prototype={open:function(){this.element.classList.add("show"),this.element.style.zIndex=e,e++,this.closed=!1,this.onopen&&this.onopen(),util.query(this.element,"img[data-src]",!0).forEach((function(t){t.src=t.getAttribute("data-src"),t.removeAttribute("data-src")}))},close:function(){this.element.classList.remove("show"),this.closed=!0,this.onclose&&this.onopen()},destroy:function(){this.element.remove(),t.splice(t.indexOf(this),1)},getDialogDom:function(){return util.query(this.element,".d-c")}},n}(),menu=(contextMenu=function(t){this.options=t;var e=util.element("div",{class:"contextMenu"});t.offset&&(e.style.top=t.offset.top+"px",e.style.left=t.offset.left+"px",e.style.bottom=t.offset.bottom+"px",e.style.right=t.offset.right+"px"),t.list.forEach((function(t){var i=util.element("div",{class:"item"});i.innerHTML=`<div class="icon">${t.icon}</div><div class="title">${t.title}</div>`,i.onclick=function(){t.click()},e.appendChild(i)})),document.body.appendChild(e),this.element=e},contextMenu.prototype={show:function(){this.element.classList.add("show"),this.element.style.height="auto";var t=this.element.getBoundingClientRect().height;this.element.style.height="0px",this.element.style.transition="height .2s";var e=this;setTimeout((function(){e.element.style.height=t+"px"}))},hide:function(){this.element.style.height="0px";var t=this;setTimeout((function(){t.element.style.transition="none",t.element.classList.remove("show")}),200)},isShow:function(){return this.element.classList.contains("show")},destroy:function(){this.element.remove()},setOffset:function(t){this.options.offset=t;var e=this.options,i=this.element;i.style.top="",i.style.left="",i.style.bottom="",i.style.right="",e.offset&&("number"==typeof e.offset.top?i.style.top=e.offset.top+"px":i.style.bottom=e.offset.bottom+"px","number"==typeof e.offset.left?i.style.left=e.offset.left+"px":i.style.right=e.offset.right+"px")},setList:function(t){this.options.list=t;var e=this.options,i=this.element;i.innerHTML="",e.list.forEach((function(t){var e=util.element("div",{class:"item"});e.innerHTML=`<div class="icon">${t.icon}</div><div class="title">${t.title}</div>`,e.onclick=function(){t.click()},i.appendChild(e)}))}},document.addEventListener("click",(function(){document.querySelectorAll(".contextMenu").forEach((function(t){t.style.height="0px",setTimeout((function(){t.style.transition="none",t.classList.remove("show")}),200)}))})),contextMenu),contextMenu,mainmenu=function(){var t=new iconc.icon({class:"main_menu",content:util.getGoogleIcon("e5d2"),offset:"tr"}),e=[],i=[],n=new menu({list:[],offset:{top:40,right:15}});t.getIcon().onclick=function(t){t.stopPropagation(),n.show()};return{pushMenu:function(t,o){1==o?i.push(t):e.push(t),n.setList(e.concat(i))},MAIN_MENU_BOTTOM:1,MAIN_MENU_TOP:0}}(),setting=function(){var t,e=storage("setting",{title:"设置",desc:"QUIK起始页的各项设置",sync:!0}),i=function(){function t(t){this.title=t.title,this.dialog=new dialog({content:`<div class="actionbar"><h1>设置</h1><div class="closeBtn">${util.getGoogleIcon("e5cd")}</div></div><ul class="setting-root"></ul>`,class:"setting_dia",mobileShowtype:dialog.SHOW_TYPE_FULLSCREEN}),this.dialogDom=this.dialog.getDialogDom(),util.query(this.dialogDom,".closeBtn").addEventListener("click",(()=>{this.dialog.close()})),util.query(this.dialogDom,".actionbar h1").innerText=this.title,this.groups=[],this._events={change:[]}}function e(t,e,n){util.query(t,".qui-options").innerHTML=(()=>{var t="";for(var i in e)t+=`<div class="qui-option" data-value="${i}">${e[i]}</div>`;return t})(),util.query(t,".qui-options .qui-option",!0).forEach((function(o){o.onclick=function(){var s=o.getAttribute("data-value");util.query(t,".setting-item-input").value=s,util.query(t,".qui-select").innerText=e[s];var a=util.query(t,".qui-options .qui-option.selected");a&&a.classList.remove("selected"),o.classList.add("selected"),i.call(util.query(t,".setting-item-input"),n)}}))}function i(t){var e;this.classList.contains("null-click")||(e="checkbox"==this.type?this.checked:this.value,"function"==typeof t.check?t.check(e)?t.callback(e):getacb():t.callback(e))}return t.prototype={addNewGroup:function(t){this.groups.push(t);var e=this;t.on("change",(function(t,i){e._dochange({type:t.type,details:t.details,id:t.id}),"it"==t.type?e._dochangeGroup(i,t.details):"add"==t.type?e._drawItem(i,i.items[i.items.length-1]):"change"==t.type&&("reinit"==t.details.attr?e._reinitItem(i,i.items.find((e=>e.id==t.id)),t.details):"reget"==t.details.attr?e._regetItem(i.items.find((e=>e.id==t.id)),t.details):e._dochangeItem(i,i.items.find((e=>e.id==t.id)),t.details))})),e._dochange({type:"addgroup"}),e._drawGroup(t)},setTitle:function(t){this.title=t,util.query(this.dialogDom,".actionbar h1").innerText=t,_._dochange({type:"changetitle",title:t})},open:function(){this.dialog.open()},close:function(){this.dialog.close()},on:function(t,e){this._events[t]&&this._events[t].push(e)},_dochange:function(t){var e=this;this._events.change.forEach((function(i){i(t,e)}))},_drawGroup:function(t){var e=this,i=util.element("li",{class:"setting-group","data-index":t.index,"data-id":t.id});i.innerHTML='<div class="setting-group-title"></div><ul class="setting-tree"></ul>';for(var n=util.query(this.dialogDom,".setting-root"),o=n.children,s=!0,a=0;a<o.length;a++)if(parseInt(o[a].getAttribute("data-index"))>t.index){n.insertBefore(i,o[a]),s=!1;break}s&&n.appendChild(i),util.query(i,".setting-group-title").innerText=t.title,t.items.forEach((function(i){e._drawItem(t,i)}))},_drawItem:function(t,n){var o=util.element("li",{class:"setting-item","data-index":n.index,"data-id":n.id});o.innerHTML='<div class="setting-item-left"><div class="setting-item-title"></div><div class="setting-item-message"></div></div><div class="setting-item-right"></div>';for(var s=util.query(this.dialogDom,".setting-group[data-id="+t.id+"] .setting-tree"),a=s.children,c=!0,l=0;l<a.length;l++)if(parseInt(a[l].getAttribute("data-index"))>n.index){s.insertBefore(o,a[l]),c=!1;break}c&&s.appendChild(o),util.query(o,".setting-item-title").innerText=n.title,n.message?util.query(o,".setting-item-message").innerText=n.message:o.classList.add("no-message");var r=util.query(o,".setting-item-right"),u=function(){};function d(){if("null"!=n.type){var t=n.get();t instanceof Promise?t.then(u):u(t)}}({string:function(){r.innerHTML='<input type="text" class="setting-item-input">',u=function(t){util.query(r,".setting-item-input").value=t}},number:function(){r.innerHTML='<input type="number" class="setting-item-input">',u=function(t){util.query(r,".setting-item-input").value=t}},boolean:function(){r.innerHTML='<div class="check-box"><div class="check-box-inner"></div><input type="checkbox" class="setting-item-input"></div>',u=function(t){util.query(r,".setting-item-input").checked=t,t?util.query(r,".check-box").classList.add("checked"):util.query(r,".check-box").classList.remove("checked"),util.query(r,".check-box").addEventListener("click",(function(){util.query(r,".setting-item-input").click(),util.query(r,".setting-item-input").checked?this.classList.add("checked"):this.classList.remove("checked")}))}},range:function(){r.innerHTML='<input type="range" class="setting-item-input">',u=function(t){util.query(r,".setting-item-input").value=t};var t=n.init();function e(t){util.query(r,".setting-item-input").max=t[1],util.query(r,".setting-item-input").min=t[0]}t instanceof Promise?t.then(e):e(t)},select:function(){var t;r.innerHTML='<input class="setting-item-input" type="text" style="display:none"></input><div class="qui-select"></div><div class="qui-options"></div>',util.query(r,".qui-select").onclick=function(t){t.stopPropagation();var e=util.query(document,".qui-options.active");e&&e.classList.remove("active"),util.query(r,".qui-options").classList.add("active")},u=function(e){t=e};var i=n.init();function o(i){e(r,i,n),u=function(t){util.query(r,".setting-item-input").value=t,util.query(r,".qui-select").innerText=i[t];var e=util.query(r,".qui-options .qui-option.selected");e&&e.classList.remove("selected");try{util.query(r,'.qui-options .qui-option[data-value="'+t+'"]').classList.add("selected")}catch(t){util.query(r,".qui-select").innerText=""}},t&&u(t)}i instanceof Promise?i.then(o):o(i)},null:function(){r.innerHTML=`<div class="setting-item-input null-click">${util.getGoogleIcon("e5e1")}</div>`,o.classList.add("just-callback-item"),o.onclick=function(){n.callback()}}})[n.type](),d(),n.getacb=d,util.query(r,".setting-item-input").addEventListener("range"==n.type?"input":"null"==n.type?"click":"change",(function(){i.call(this,n)}))},_dochangeGroup:function(t,e){var i=util.query(this.dialogDom,".setting-group[data-id="+t.id+"]");if("title"==e.attr)util.query(i,".setting-group-title").innerText=e.content;else if("index"==e.attr){i.setAttribute("data-index",e.content);for(var n=util.query(this.dialogDom,".setting-root"),o=n.children,s=!0,a=0;a<o.length;a++)if(!o[a].isSameNode(i)&&parseInt(o[a].getAttribute("data-index"))>e.content){n.insertBefore(i,o[a]),s=!1;break}s&&n.appendChild(i)}else"show"==e.attr&&(i.style.display=e.content?"block":"none")},_dochangeItem:function(t,e,i){var n=util.query(this.dialogDom,".setting-group[data-id="+t.id+"] .setting-item[data-id="+e.id+"]");if("title"==i.attr)util.query(n,".setting-group-title").innerText=i.content;else if("message"==i.attr)i.content?(util.query(n,".setting-item-message").innerText=i.content,n.classList.remove("no-message")):n.classList.add("no-message");else if("index"==i.attr){n.setAttribute("data-index",i.content);for(var o=util.query(this.dialogDom,".setting-group[data-id="+t.id+"] .setting-tree"),s=o.children,a=!0,c=0;c<s.length;c++)if(!s[c].isSameNode(n)&&parseInt(s[c].getAttribute("data-index"))>i.content){o.insertBefore(n,s[c]),a=!1;break}a&&o.appendChild(n)}else"show"==i.attr&&(n.style.display=i.content?"block":"none")},_reinitItem:function(t,i){var n,o=util.query(this.dialogDom,".setting-group[data-id="+t.id+"] .setting-item[data-id="+i.id+"]"),s=util.query(o,".setting-item-right");if("range"==i.type)n=function(t){util.query(s,".setting-item-input").max=t[1],util.query(s,".setting-item-input").min=t[0]};else{if("select"!=i.type)return;n=function(t){e(s,t,i),cb=function(e){util.query(s,".setting-item-input").value=e,util.query(s,".qui-select").innerText=t[e];var i=util.query(s,".qui-options .qui-option.selected");i&&i.classList.remove("selected");try{util.query(s,'.qui-options .qui-option[data-value="'+e+'"]').classList.add("selected")}catch(t){}};var n=i.get();n instanceof Promise?n.then(cb):cb(n)}}var a=i.init();a instanceof Promise?a.then(n):n(a)},_regetItem:function(t){t.getacb()}},document.addEventListener("click",(function(){var t=util.query(document,".qui-options.active");t&&t.classList.remove("active")})),t}(),n=function(){var t=0;function e(e){this.title=e.title,this.index=e.index,this.index<0&&(this.index=0),this.items=[],this.id="seg_"+t,t++,this._events={change:[]}}return e.prototype={addNewItem:function(t){this.items.push(t);var e=this;t.on("change",(function(t,i){e._dochange({type:"change",details:t,id:i.id})})),e._dochange({type:"add"})},setTitle:function(t){this.title=t,this._dochange({type:"it",details:{attr:"title",content:t}})},setIndex:function(t){this.index=t,this._dochange({type:"it",details:{attr:"index",content:t}})},on:function(t,e){this._events[t]&&this._events[t].push(e)},show:function(){this.show=!0,this._dochange({type:"it",details:{attr:"show",content:!0}})},hide:function(){this.show=!1,this._dochange({type:"it",details:{attr:"show",content:!1}})},_dochange:function(t){var e=this;this._events.change.forEach((function(i){i(t,e)}))}},e}(),o=function(){var t=0;function e(e){this.title=e.title,this.index=e.index,this.type=e.type,this.init=e.init,this.check=e.check,this.callback=e.callback,this.message=e.message,this.get=e.get,this._show=!0,this.id="sei_"+t,t++,this._events={change:[]}}return e.prototype={reInit:function(){this._dochange({attr:"reinit"})},reGet:function(){this._dochange({attr:"reget"})},setTitle:function(t){this.title=t,this._dochange({attr:"title",content:t})},setIndex:function(t){this.index=t,this._dochange({attr:"index",content:t})},setMessage:function(t){this.message=t,this._dochange({attr:"message",content:t})},show:function(){this._show=!0,this._dochange({attr:"show",content:!0})},hide:function(){this._show=!1,this._dochange({attr:"show",content:!1})},on:function(t,e){this._events[t]&&this._events[t].push(e)},_dochange:function(t){var e=this;this._events.change.forEach((function(i){i(t,e)}))}},e}(),s=function(){var t=new i({title:"设置"});return mainmenu.pushMenu({icon:util.getGoogleIcon("e8b8",{type:"fill"}),title:"主设置",click:function(){t.open()}},mainmenu.MAIN_MENU_TOP),t}();(t=new iconc.icon({content:util.getGoogleIcon("e8b8",{type:"fill"}),offset:"bl"})).getIcon().title="(Alt+S) 打开设置",t.getIcon().onclick=function(){s.open()};var a=new n({title:"通用",index:0});return s.addNewGroup(a),{Setting:i,SettingGroup:n,SettingItem:o,mainSetting:s,tyGroup:a,settingSto:e}}(),Setting=setting.Setting,SettingGroup=setting.SettingGroup,SettingItem=setting.SettingItem,mainSetting=setting.mainSetting,tyGroup=setting.tyGroup,omnibox=function(){var{on:on,off:off,doevent:doevent}=getEventHandle(),sg=new SettingGroup({title:"搜索框",index:1});mainSetting.addNewGroup(sg);var core=function(){var t={SA:[],enter:[]},e=setting.settingSto;null==e.get("ob_justsearch")&&e.set("ob_justsearch",!1),null==e.get("ob_http")&&e.set("ob_http",!1);var i=[],n=function(e){for(var i=0;i<t.enter.length;i++)if(t.enter[i].check(e))return t.enter[i]},o=function(e){t.enter.unshift(e)},s=function(e){t.SA.push(e)},a=function(){if(storage){var t=storage("search",{sync:!0,title:"搜索引擎",desc:"搜索引擎配置",compare:function(t,e,i){var n=o();for(var e in i.typelist)n[e]=i.typelist[e];i.typelist=n,t[e]=i}});t.get("typelist")||t.set("typelist",{bing:"",baidu:"",so:"",sogou:"",google:""}),t.get("type")||t.set("type","bing");var e={},i={bing:{name:"必应",link:"https://www.bing.com/search?q="},baidu:{name:"百度",link:"https://www.baidu.com/s?ie=utf-8&wd="},google:{name:"Google",link:"https://www.google.com/search?q="},so:{name:"360搜索",link:"https://www.so.com/s?q="},sogou:{name:"搜狗",link:"https://www.sogou.com/sogou?query="},stear:{name:"林中木<span>赞助</span>",link:"https://stear.cn/?q="},yandex:{name:"Yandex",link:"https://yandex.com/search/?text="},fsearch:{name:"F搜",link:"https://fsoufsou.com/search?q="},github:{name:"GitHub",link:"https://github.com/search?q="},bilibili:{name:"哔哩哔哩",link:"https://search.bilibili.com/all?keyword="},douyin:{name:"抖音",link:"https://www.douyin.com/search/%s?ug_source=lenovo_stream"},jd:{name:"京东",link:"https://search.jd.com/Search?keyword="},weibo:{name:"微博",link:"https://s.weibo.com/weibo?q="},taobao:{name:"淘宝",link:"https://ai.taobao.com/search/index.htm?pid=mm_31205575_2237000308_114588650482&union_lens=lensId%3APUB%401667806444%402104ee54_0bea_1845102bd01_03e9%4001&key="},xiaohongshu:{name:"小红书",link:"https://www.xiaohongshu.com/search_result/?&m_source=itab&keyword="},duckduckgo:{name:"DuckDuckGo",link:"https://duckduckgo.com/?q="},stackoverflow:{name:"StackOverflow",link:"https://stackoverflow.com/nocaptcha?s="},zhihu:{name:"知乎",link:"https://www.zhihu.com/search?type=content&q="},yahoo:{name:"Yahoo",link:"https://hk.search.yahoo.com/search?p="},mdn:{name:"MDN",link:"https://developer.mozilla.org/zh-CN/search?q="},douban:{name:"豆瓣",link:"https://www.douban.com/search?q="},toutiao:{name:"头条搜索",link:"https://so.toutiao.com/search?dvpf=pc&keyword="}},n=function(t,i){e[t]&&e[t].forEach((function(t){t.apply(null,i)}))},o=function(){return t.get("typelist")},s={getSearchType:function(){return i[t.get("type")]?i[t.get("type")].link+"%keyword%":t.get("typelist")[t.get("type")]},on:function(t,i){e[t]?e[t].push(i):e[t]=[i]},setSearchList:function(e){if(0==Object.keys(e).length)throw new Error("newList is empty");t.set("typelist",e);var i=t.get("typelist");n("typelistchange");var o=t.get("type");i[o]!=e[o]&&n("nowtypechange")},getSearchTypeList:o,setSearchType:function(e){t.set("type",e),n("nowtypechange")},getSearchTypeIndex:function(){return t.get("type")},neizhi:i};return Object.defineProperty(s,"keywordText",{get:function(){return"%keyword%"}}),s}}();function c(t){return!e.get("ob_justsearch")&&util.checkUrl(t)}o({check:function(){return!0},enter:function(t){open(a.getSearchType().replace(a.keywordText,encodeURIComponent(t)))},icon:":searchtype",submit:util.getGoogleIcon("E8B6")}),o({check:c,enter:function(t){-1==t.indexOf("://")&&(t=(e.get("ob_http")?"https://":"http://")+t),open(t)},icon:util.getGoogleIcon("E80B"),submit:util.getGoogleIcon("E89E")}),s({check:function(t){return!!t},get:function(t,e){var i=e();return i.unshift({icon:util.getGoogleIcon("E8B6"),text:t,click:function(){open(a.getSearchType().replace(a.keywordText,encodeURIComponent(t)))}}),i}});var l=null;s({check:function(t){return!!t},get:function(t,e){return new Promise((function(i,n){l=util.jsonp("https://www.baidu.com/sugrec?pre=1&p=3&ie=utf-8&json=1&prod=pc&from=pc_web&wd="+t,(function(t){var n=e();l=null,t.g?(t.g.forEach((function(t){n.push({icon:util.getGoogleIcon("E8B6"),text:t.q,click:function(){open(a.getSearchType().replace(a.keywordText,t.q))}})})),i(n)):i(n)}),"cb")}))},interrupt:function(){l&&(l.abort(),l=null)}}),s({check:c,get:function(t,i){return new Promise((function(n,o){var s=i();s.unshift({icon:util.getGoogleIcon("E80B"),text:t,click:function(){-1==t.indexOf("://")&&(t=(e.get("ob_http")?"https://":"http://")+t),open(t)}}),n(s)}))}});var r=new SettingItem({title:"搜索框仅搜索",index:1,type:"boolean",message:"打开后，搜索框将失去打开链接的功能",get:function(){return!!e.get("ob_justsearch")},callback:function(t){return e.set("ob_justsearch",t),!0}}),u=new SettingItem({title:"默认HTTPS打开链接",index:1,type:"boolean",message:"打开后，搜索框打开链接在默认情况下使用HTTPS",get:function(){return!!e.get("ob_http")},callback:function(t){return e.set("ob_http",t),!0}});return sg.addNewItem(r),sg.addNewItem(u),{getSA:function(e,n){i.length>0&&i.forEach((function(e){t.SA[e].interrupt()}));for(var o=[],s=t.SA.length,a=0;a<s;a++)if(t.SA[a].check(e)){var c=t.SA[a].get(e,(function(){return o}));c instanceof Promise?(i.push(a),function(t){c.then((function(e){o=e,i.splice(i.indexOf(t),1),n(o)}))}(a)):n(o=c)}},enter:function(t){doevent("beforeenter",[t]),n(t).enter(t),doevent("afterenter",[t])},getType:n,addNewType:o,addNewSA:s,searchUtil:a,initsto:e,setJustSearch:function(t){e.set("ob_justsearch",t),r.reGet()}}}(),ui=function(){"use strict";var t=util.element("div",{class:"searchbox"}),e=util.element("div",{class:"cover searchcover"}),i=util.element("div",{class:"searchpadding"});t.innerHTML='<div class="box"><div class="icon"></div><div class="input"><input type="text" placeholder="搜索或输入网址" {i}></div><div class="submit"></div></div><ul class="sas"></ul>'.replace("{i}",core.initsto.get("ob_autofocus")?"autofocus":""),util.query(document,"main").append(t),util.query(document,"main").append(e),util.query(document,"main .center").append(i);var n,o=util.query(t,"div.icon"),s=util.query(t,"div.input input"),a=util.query(t,"div.submit"),c=util.query(t,"ul.sas");function l(t){var e=core.getType(t);if(":"==e.icon[0]){o.setAttribute("data-teshu",e.icon);var i=function(t){return":searchtype"==t?new Promise((function(t,e){util.getFavicon(core.searchUtil.getSearchType(),(function(e){t(e?'<img src="'+e+'" style="border-radius:50%;"/>':'<img src="'+util.createIcon("S")+'" style="border-radius:50%;"/>')}))})):""}(e.icon);i instanceof Promise?i.then((function(t){o.innerHTML=t})):o.innerHTML=i}else o.innerHTML=e.icon,o.removeAttribute("data-teshu");":"==e.submit[0]?(a.setAttribute("data-teshu",e.submit),a.innerHTML=(e.submit,"")):(a.innerHTML=e.submit,a.removeAttribute("data-teshu"))}function r(){l(this.value.trim()),c.innerHTML="",core.getSA(this.value.trim(),(function(t){var e=util.query(c,"li.active");e&&(e={icon:util.query(e,"div.saicon").innerHTML,text:util.query(e,"div.sa_text").innerText}),c.innerHTML="",t.forEach((function(t){var e=util.element("li");e.innerHTML=`<div class="saicon">${t.icon}</div><div class="sa_text"></div>`,e.querySelector(".sa_text").innerText=t.text,c.append(e),e.onclick=function(){t.click()}})),e&&util.query(c,"li",!0).forEach((function(t){util.query(t,"div.saicon").innerHTML&&util.query(t,"div.sa_text").innerHTML==e.text&&t.classList.add("active")}))})),doevent("input",[s.value])}function u(){clearTimeout(n),e.classList.add("active"),t.classList.add("active"),doevent("focus",[s])}s.oninput=util.fangdou(r,300),s.onkeydown=function(t){if("Enter"==t.key)(e=util.query(c,"li.active"))?e.click():core.enter(this.value);else if("ArrowUp"==t.key){t.preventDefault(),(e=util.query(c,"li.active"))&&(e.classList.remove("active"),e.previousElementSibling&&e.previousElementSibling.classList.add("active"))}else if("ArrowDown"==t.key){t.preventDefault(),(e=util.query(c,"li.active"))?e.nextElementSibling&&(e.classList.remove("active"),e.nextElementSibling.classList.add("active")):util.query(c,"li").classList.add("active")}else if("ArrowRight"==t.key){var e;(e=util.query(c,"li.active"))&&(s.value=util.query(e,".sa_text").innerText,r.call(this))}else if("Tab"==t.key)if(t.preventDefault(),t.shiftKey)if(util.query(v,"li.active").previousElementSibling)util.query(v,"li.active").previousElementSibling.click();else{var i=util.query(v,"li",!0);i[i.length-2].click()}else util.query(v,"li.active").nextElementSibling.classList.contains("add")?util.query(v,"li").click():util.query(v,"li.active").nextElementSibling.click()},s.addEventListener("focus",u),s.addEventListener("blur",(function(){this.classList.remove("active"),n=setTimeout((function(){d?g=function(){setTimeout((function(){e.classList.remove("active"),t.classList.remove("active")}),10)}:(e.classList.remove("active"),t.classList.remove("active"))})),doevent("blur",[s])})),document.addEventListener("mousedown",f),document.addEventListener("touchstart",f),document.addEventListener("mouseup",h),document.addEventListener("touchend",h);var d=!1,g=function(){};function f(){d=!0}function h(){d=!1,g(),g=function(){}}a.onclick=function(){core.enter(s.value)};var v=util.element("div",{class:"searchtypeselector"});function p(){var t=util.query(v,"ul"),e=core.searchUtil.getSearchTypeIndex();t.innerHTML="";var i=core.searchUtil.getSearchTypeList();for(var n in i){var o;(o=util.element("li")).innerHTML="<img/>",function(t,e){!i[e]&&core.searchUtil.neizhi[e]&&(i[e]=core.searchUtil.neizhi[e].link),util.getFavicon(i[e],(function(e){t.querySelector("img").src=e||util.createIcon("s")}))}(o,n),o.setAttribute("data-type",n),t.append(o),n==e&&o.classList.add("active"),o.onclick=function(){var t=util.query(v,"ul li.active");t&&t.classList.remove("active"),this.classList.add("active"),core.searchUtil.setSearchType(this.getAttribute("data-type")),v.classList.remove("active")}}(o=util.element("li")).classList.add("add"),o.innerHTML=util.getGoogleIcon("e145"),t.append(o),o.onclick=function(){searchEditor.open()},v.style.width=36*util.query(t,"li",!0).length-6+"px"}v.innerHTML="<ul></ul>",util.query(document,"main .center").append(v),o.addEventListener("click",(function(){v.classList.contains("active")?(v.classList.remove("active"),document.querySelector("main .links").classList.remove("duan")):(v.classList.add("active"),document.querySelector("main .links").classList.add("duan"))})),core.searchUtil.on("nowtypechange",(function(){":searchtype"==o.getAttribute("data-teshu")&&l(s.value)})),core.searchUtil.on("typelistchange",(function(){p()})),p(),l(""),null==core.initsto.get("ob_autofocus")&&core.initsto.set("ob_autofocus",!1),core.initsto.get("ob_autofocus")&&Onshow((function(){setTimeout((function(){s.focus(),u()}),100)}));var m=new SettingItem({title:"自动聚焦",index:1,type:"boolean",message:"打开页面自动聚焦搜索框",get:function(){return!!core.initsto.get("ob_autofocus")},callback:function(t){return core.initsto.set("ob_autofocus",t),!0}});sg.addNewItem(m);var y=new SettingItem({title:"聚焦时背景蒙版",index:6,type:"boolean",message:"关闭后聚焦搜索框时不再出现背景蒙版",get:function(){return!core.initsto.get("ob_notshowb")},callback:function(t){return core.initsto.set("ob_notshowb",!t),k(),!0}});sg.addNewItem(y);var b=new SettingItem({title:"背景蒙版模糊",index:7,type:"boolean",message:"背景蒙版模糊（可能会影响性能）",get:function(){return core.initsto.get("ob_bblur")},callback:function(t){return core.initsto.set("ob_bblur",t),k(),!0}});function k(){core.initsto.get("ob_notshowb")?(e.classList.add("notshow"),b.hide()):(e.classList.remove("notshow"),b.show(),core.initsto.get("ob_bblur")?e.classList.add("blur"):e.classList.remove("blur"))}return sg.addNewItem(b),k(),{setValue:function(t){s.value=t,s.focus(),r.call(s)},focus:function(){s.focus()},blur:function(){s.blur()},isblur:function(){return!s.classList.contains("active")},setAutoFocus:function(t){core.initsto.set("ob_autofocus",t),m.reGet()}}}(),_t_re,_t_timeout,si;return function(){var si=new SettingItem({title:"自动计算",index:2,type:"boolean",message:"搜索框输入=自动计算后面的内容",get:function(){return!!core.initsto.get("ob_cal")},callback:function(t){return core.initsto.set("ob_cal",t),!0}});sg.addNewItem(si),core.addNewSA({check:function(t){return!!core.initsto.get("ob_cal")&&"="==t[0]},get:function(text,getsa){var a=getsa();try{if(text=text.substr(1),!text)return a;var e=Math.E,PI=Math.PI,ln=Math.log,lg=Math.log10,sin=Math.sin,cos=Math.cos,tan=Math.tan,asin=Math.asin,acos=Math.acos,atan=Math.atan,sqrt=Math.sqrt,abs=Math.abs;text=text.replaceAll("^","**").replaceAll("π","PI").replaceAll("[","(").replaceAll("]",")").replaceAll("{","(").replaceAll("}",")");var result=eval(text);result=result.toString().replace("e+","*10^"),a.unshift({icon:util.getGoogleIcon("ea5f"),text:result,click:function(){ui.setValue(result)}})}catch(e){}return a}})}(),si=new SettingItem({title:"自动翻译",index:2,type:"boolean",message:"搜索框输入非中文时自动翻译为中文",get:function(){return!!core.initsto.get("ob_tran")},callback:function(t){return core.initsto.set("ob_tran",t),!0}}),sg.addNewItem(si),core.addNewSA({check:function(t){return!!core.initsto.get("ob_tran")&&!util.checkUrl(t)&&function(t){var e=t.length,i=t.match(/[a-zA-Z\u3040-\u309F\u30A0-\u30FF\u31F0-\u31FFйцукенгшщзхъфывапролджэячсмитьбюёàâäèéêëîïôœùûüÿçÀÂÄÈÉÊËÎÏÔŒÙÛÜŸÇ\u0530-\u1CDF]/g);return!!i&&i.length/e>.5}(t)},get:function(t,e){return new Promise((function(i,n){_t_timeout=setTimeout((function(){function n(){_t_re=util.xhr("https://api.gumengya.com/Api/Translate?text="+encodeURIComponent(t)+"&from=auto&to=zh",(function(t){var n=e(),o=JSON.parse(t);if(200==o.code){var s=o.data.result;n.unshift({icon:util.getGoogleIcon("e8e2"),text:s,click:function(){ui.setValue(s)}})}i(n)}),(function(t){}))}_t_re=util.xhr("https://api.oioweb.cn/api/txt/QQFanyi?sourceText="+encodeURIComponent(t),(function(t){var o=JSON.parse(t);if(200==o.code){var s=e(),a=o.result.targetText;s.unshift({icon:util.getGoogleIcon("e8e2"),text:a,click:function(){ui.setValue(a)}}),i(s)}else n()}),(function(t){n()}))}),1500)}))},interrupt:function(){clearTimeout(_t_timeout),_t_re&&_t_re.abort()}}),{value:ui.setValue,focus:ui.focus,blur:ui.blur,isblur:ui.isblur,addNewSug:core.addNewSA,addNewType:core.addNewType,on:on,off:off,getSearchType:core.searchUtil.getSearchType,getSearchTypeList:core.searchUtil.getSearchTypeList,getSearchTypeIndex:core.searchUtil.getSearchTypeIndex,setSearchType:core.searchUtil.setSearchType,setSearchList:core.searchUtil.setSearchList,keywordText:core.searchUtil.keywordText,neizhi:core.searchUtil.neizhi,search:{on:core.searchUtil.on},sg:sg,setAutoFocus:ui.setAutoFocus,setJustSearch:ui.setJustSearch}}(),link=function(){var t=storage("link",{sync:!0,title:"链接",desc:"QUIK起始页链接数据",websync:!0,get:async function(){var e=t.getAll();return"db"==e["storage-mode"]&&(e.links=await localforage.getItem(e.links),e.cate=await localforage.getItem(e.cate)),delete e["storage-mode"],e},rewrite:function(e,i,n){return new Promise((function(o){n["storage-mode"]=t.get("storage-mode"),"db"==t.get("storage-mode")?t.remove("links",!0,(function(){dbTool.set(n.links,void 0,(function(s){n.links=s,t.remove("cate",!0,(function(){dbTool.set(n.cate,void 0,(function(t){n.cate=t,e[i]=n,o()}))}))}))})):(e[i]=n,o())}))},compare:function(i,n,o){return new Promise((function(s){if(o["storage-mode"]=t.get("storage-mode"),"db"==o["storage-mode"])t.get("links",!0,(function(a){t.remove("links",!0,(function(){o.links=e(a,o.links),dbTool.set(o.links,void 0,(function(t){o.links=t,dbTool.get(i[n].cate,(function(t){dbTool.delete(i[n].cate,(function(){var a=t;for(var c in o.cate)a[c]=e(a[c],o.cate[c]);o.cate=a,dbTool.set(o.cate,void 0,(function(t){o.cate=t,i[n]=o,s()}))}))}))}))}))}));else{o.links=e(t.get("links"),o.links);var a=t.get("cate");for(var c in o.cate)a[c]=e(a[c],o.cate[c]);o.cate=a,i[n]=o}}))}});function e(t,e){if(!t)return e;if(!e)return t;for(var i=0;i<t.length;i++)e.find((function(e){return e.title==t[i].title&&e.url==t[i].url}))||e.push(t[i]);return e}var i,{on:n,off:o,doevent:s}=getEventHandle();function a(t,e){var i={title:t.title,url:t.url};return"number"==typeof t.index&&t.index>=0?t.index>e.length?e.push(i):e.splice(t.index,0,i):e.push(i),e}function c(t,e,i){if(!i[t])return!1;var n={title:e.title,url:e.url};if(i[t]=n,"number"==typeof e.index&&e.index>=0)if(e.index>=i.length);else{var o=i.splice(t,1)[0];i.splice(e.index,0,o)}return i}function l(t){return t.url.length>1e3?"url":t.title.length>60&&"title"}i=storage.checkIDB()?function(){t.set("storage-mode","db");var e=0;t.get("links")?e++:t.set("links",[],!0,(function(){2==++e&&i.forEach((t=>t()))})),t.get("cate")?e++:t.set("cate",{},!0,(function(){2==++e&&i.forEach((t=>t()))}));var i=[];return 2==e&&i.forEach((t=>t())),{addLink:function(i,n=function(){}){if(2!=e)throw"初始化未完成";if(!util.checkDetailsCorrect(i,["title","url"]))throw"参数不正确";i.cate?t.get("cate",!0,(function(e){e[i.cate]?(e[i.cate]=a(i,e[i.cate]),t.set("cate",e,!0,(function(){n({code:0,msg:"添加成功"}),s("change",{cate:i.cate,type:"add",detail:i})}))):n({code:-1,msg:"分组不存在"})})):t.get("links",!0,(function(e){e=a(i,e),t.set("links",e,!0,(function(){n({code:0,msg:"添加成功"}),s("change",{cate:null,type:"add",detail:i})}))}))},changeLink:function(i,n,o,a=function(){}){if(2!=e)throw"初始化未完成";if(!util.checkDetailsCorrect(o,["title","url"])||"number"!=typeof n)throw"参数错误";i?t.get("cate",!0,(function(e){if(e[i]){var l=c(n,o,e[i]);l?(e[i]=l,t.set("cate",e,!0,(function(){a({code:0,msg:"修改成功"}),s("change",{cate:i,index:n,type:"change",detail:o})}))):a({code:-2,msg:"链接不存在"})}else a({code:-1,msg:"分组不存在"})})):t.get("links",!0,(function(e){var i=c(n,o,e);i?(e=i,t.set("links",e,!0,(function(){a({code:0,msg:"修改成功"}),s("change",{cate:null,index:n,type:"change",detail:o})}))):a({code:-2,msg:"链接不存在"})}))},deleteLink:function(i,n,o=function(){}){if(2!=e)throw"初始化未完成";i?t.get("cate",!0,(function(e){e[i]?e[i][n]?(e[i].splice(n,1),t.set("cate",e,!0,(function(){o({code:0,msg:"删除成功"}),s("change",{cate:i,index:n,type:"delete"})}))):o({code:-2,msg:"链接不存在"}):o({code:-1,msg:"分组不存在"})})):t.get("links",!0,(function(e){e[n]?(e.splice(n,1),t.set("links",e,!0,(function(){o({code:0,msg:"删除成功"}),s("change",{cate:null,index:n,type:"delete"})}))):o({code:-2,msg:"链接不存在"})}))},addCate:function(i,n=function(){}){if(2!=e)throw"初始化未完成";t.get("cate",!0,(function(e){e[i]?n({code:-1,msg:"分组已存在"}):(e[i]=[],t.set("cate",e,!0,(function(){n({code:0,msg:"添加成功"}),s("change",{cate:i,type:"cateadd"})})))}))},renameCate:function(i,n,o=function(){}){if(2!=e)throw"初始化未完成";t.get("cate",!0,(function(e){e[i]?(e[n]&&o({code:-2,msg:"分组重名"}),e[n]=e[i],delete e[i],t.set("cate",e,!0,(function(){o({code:0,msg:"修改成功"}),s("change",{cate:i,catename:n,type:"caterename"})}))):o({code:-1,msg:"分组不存在"})}))},deleteCate:function(i,n=function(){}){if(2!=e)throw"初始化未完成";t.get("cate",!0,(function(e){e[i]?e[i].length<=1?(delete e[i],t.set("cate",e,!0,(function(){n({code:0,msg:"删除成功"}),s("change",{cate:i,type:"catedelete"})}))):confirm("确定要删除分组吗？无法恢复！",(function(o){o?(delete e[i],t.set("cate",e,!0,(function(){n({code:0,msg:"删除成功"}),s("change",{cate:i,type:"catedelete"})}))):n({code:-2,msg:"用户取消删除"})})):n({code:-1,msg:"分组不存在"})}))},getLinks:function(i,n=function(){}){if(2!=e)throw"初始化未完成";i?t.get("cate",!0,(function(t){t[i]?n({code:0,msg:"获取成功",data:t[i]}):n({code:-1,msg:"分组不存在"})})):t.get("links",!0,(function(t){n({code:0,msg:"获取成功",data:t})}))},getCates:function(i=function(){}){if(2!=e)throw"初始化未完成";t.get("cate",!0,(function(t){i({code:0,msg:"获取成功",data:Object.keys(t)})}))},getCateAll:function(i=function(){}){if(2!=e)throw"初始化未完成";t.get("cate",!0,(function(t){i({code:0,msg:"获取成功",data:t})}))},ready:function(t){2==e?t():i.push(t)},on:n,off:o}}():function(){function e(t,e){eventfns[t].forEach((function(t){t.apply(null,[e])}))}return t.set("storage-mode","localstorage"),t.get("links")||t.set("links",[]),t.get("cate")||t.set("cate",{}),{addLink:function(i,n=function(){}){if(!util.checkDetailsCorrect(i,["title","url"]))throw"参数不正确";var o=l(i);if(o)n({code:-3,msg:"受限模式下，"+o+"长度过长",lm:o});else if(i.cate){var s=t.get("cate");if(s[i.cate]){if(s[i.cate].length>100)return void n({code:-4,msg:"受限模式下，分组下已超过100条链接，无法添加"});s[i.cate]=a(i,s[i.cate]),t.set("cate",s),n({code:0,msg:"添加成功"}),e("change",{cate:i.cate,type:"add",detail:i})}else n({code:-1,msg:"分组不存在"})}else{var c=t.get("links");if(c.length>100)return void n({code:-4,msg:"受限模式下，分组下已超过100条链接，无法添加"});c=a(i,c),t.set("links",c),n({code:0,msg:"添加成功"}),e("change",{cate:null,type:"add",detail:i})}},changeLink:function(i,n,o,s=function(){}){if(!util.checkDetailsCorrect(o,["title","url"])||"number"!=typeof n)throw"参数错误";var a=l(o);if(a)s({code:-3,msg:"受限模式下，"+a+"长度过长",lm:a});else if(i){var r=t.get("cate");if(!r[i])return void s({code:-1,msg:"分组不存在"});if(!(u=c(n,o,r[i])))return void s({code:-2,msg:"链接不存在"});r[i]=u,t.set("cate",r),s({code:0,msg:"修改成功"}),e("change",{cate:i,index:n,type:"change",detail:o})}else{var u,d=t.get("links");if(!(u=c(n,o,d)))return void s({code:-2,msg:"链接不存在"});d=u,t.set("links",d),s({code:0,msg:"修改成功"}),e("change",{cate:null,index:n,type:"change",detail:o})}},deleteLink:function(i,n,o=function(){}){if(i){var s=t.get("cate");if(!s[i])return void o({code:-1,msg:"分组不存在"});if(!s[i][n])return void o({code:-2,msg:"链接不存在"});s[i].splice(n,1),t.set("cate",s),o({code:0,msg:"删除成功"}),e("change",{cate:i,index:n,type:"delete"})}else{var a=t.get("links");if(!a[n])return void o({code:-2,msg:"链接不存在"});a.splice(n,1),t.set("links",a),o({code:0,msg:"删除成功"}),e("change",{cate:null,index:n,type:"delete"})}},addCate:function(i,n=function(){}){var o=t.get("cate");o[i]?n({code:-1,msg:"分组已存在"}):Object.keys(o).length>=20?n({code:-2,msg:"受限模式下，分组数量不能超过20个"}):(o[i]=[],t.set("cate",o),n({code:0,msg:"添加成功"}),e("change",{cate:i,type:"cateadd"}))},renameCate:function(i,n,o=function(){}){var s=t.get("cate");s[i]?(s[n]&&o({code:-2,msg:"分组重名"}),s[n]=s[i],delete s[i],t.set("cate",s),o({code:0,msg:"修改成功"}),e("change",{cate:i,catename:n,type:"caterename"})):o({code:-1,msg:"分组不存在"})},deleteCate:function(i,n=function(){}){var o=t.get("cate");o[i]?o[i].length<=1?(delete o[i],t.set("cate",o),n({code:0,msg:"删除成功"})):confirm("确定要删除分组吗？无法恢复！",(function(s){s?(delete o[i],t.set("cate",o),n({code:0,msg:"删除成功"}),e("change",{cate:i,type:"catedelete"})):n({code:-2,msg:"用户取消删除"})})):n({code:-1,msg:"分组不存在"})},getLinks:function(e,i=function(){}){if(e){if(!(n=t.get("cate"))[e])return void i({code:-1,msg:"分组不存在"});i({code:0,msg:"获取成功",data:n[e]})}else{var n;i({code:0,msg:"获取成功",data:n=t.get("links")})}},getCates:function(e=function(){}){var i=t.get("cate");e({code:0,msg:"获取成功",data:Object.keys(i)})},getCateAll:function(e=function(){}){e({code:0,msg:"获取成功",data:t.get("cate")})},ready:function(t){t()},on:n,off:o}}();var r=function(){var e=util.element("div",{class:"links"});function n(t,e){for(var i=0;i<e.length;i++)if(e[i].isSameNode(t))return i;return-1}util.query(document,"main .center").append(e);var o,s,a=null,c=[],l=new menu({list:[{icon:util.getGoogleIcon("e3c9"),title:"修改",click:function(){var t=n(a,util.query(e,".link-list li",!0)),i=util.query(e,".cate-bar-items .cate-item.active");v(t,i=i.classList.contains("mr")?null:i.innerText)}},{icon:util.getGoogleIcon("e92e"),title:"删除",click:function(){var t=n(a,util.query(e,".link-list li",!0)),o=util.query(e,".cate-bar-items .cate-item.active");o=o.classList.contains("mr")?null:o.innerText,i.deleteLink(o,t,(function(){toast.show("删除成功")}))}},{icon:util.getGoogleIcon("e14d"),title:"复制链接",click:function(){util.copyText(util.query(a,"a").href)}}]}),r=null,u=new menu({list:[{icon:util.getGoogleIcon("e3c9"),title:"重命名",click:function(){p(r.innerText)}},{icon:util.getGoogleIcon("e92e"),title:"删除",click:function(){var t=r.innerText;i.deleteCate(t,(function(t){0==t?toast.show("删除成功"):toast.show(t.msg)}))}}]});function d(t){var i=util.element("div",{class:"cate-item"});i.innerText=t,util.query(e,".cate-bar-items").append(i),i.onclick=function(){h(this)},i.oncontextmenu=function(t){t.preventDefault(),r=this,u.setOffset({top:t.pageY,left:t.pageX}),u.show()}}function g(){var t=0;0==this.scrollLeft?(util.query(e,".cate-left-btn").classList.add("disabled"),t++):util.query(e,".cate-left-btn").classList.remove("disabled"),this.scrollLeft>=this.scrollWidth-this.getBoundingClientRect().width?(util.query(e,".cate-right-btn").classList.add("disabled"),t++):util.query(e,".cate-right-btn").classList.remove("disabled"),this.style.width="calc(100% - "+(120-40*t)+"px)"}function f(){var t=util.query(e,".cate-bar-items .cate-item",!0);util.query(e,".cate-bar-items").style.width="100000px",t[0].offsetHeight;var i=0;t.forEach((function(t){i+=t.getBoundingClientRect().width+4})),util.query(e,".cate-bar-items").style.width=i+"px",g.call(util.query(e,".cate-bar-scrolls"))}function h(t){util.query(e,".link-list").innerHTML="";var n=null;if("string"==typeof t){try{util.query(e,".cate-bar-items .cate-item.active").classList.remove("active")}catch(t){}for(var o=util.query(e,".cate-bar-items .cate-item",!0),s=0;s<o.length;s++)if(!o[s].classList.contains("mr")&&o[s].innerText==t){o[s].classList.add("active");break}n=t}else if(t){try{util.query(e,".cate-bar-items .cate-item.active").classList.remove("active")}catch(t){}t.classList.add("active"),n=t.innerText}else{try{util.query(e,".cate-bar-items .cate-item.active").classList.remove("active")}catch(t){}util.query(e,".cate-bar-items .cate-item.mr").classList.add("active")}i.getLinks(n,(function(t){c=t.data,t.data.forEach((function(t){var i=util.element("li");i.innerHTML=`<a href="${t.url}" target="_blank" rel="noopener noreferer"><img/><p></p></a>`,util.query(e,".link-list").append(i),util.query(i,"p").innerText=t.title,util.getFavicon(t.url,(function(e){util.query(i,"img").src=e||util.createIcon(t.title[0])})),i.oncontextmenu=function(t){t.preventDefault(),a=this,l.setOffset({top:t.pageY,left:t.pageX}),l.show()}}));var i=util.element("li",{class:"link-add"});i.innerHTML='<a href="javascript:void(0)" class="material-symbols-outlined">&#xe145;</a>',util.query(e,".link-list").append(i),i.onclick=function(){var t=util.query(e,".cate-bar-items .cate-item.active");v(-1,t=t.classList.contains("mr")?null:t.innerText)}}))}function v(t,e){if(!o){var n=(o=new dialog({class:"link-add-dialog",content:'<form><h1></h1><div class="content"><p>URL ：<input class="link-add-url" type="text" required placeholder="链接地址(必填)"></p><p>标题：<input class="link-add-title" type="text" required placeholder="链接标题(必填)"></p><p>位置：<input class="link-add-index" type="number" min="0" placeholder="链接位置"></p></div><div class="footer"><div class="cancel btn">取消</div><button class="ok btn"></button></div></form>'})).getDialogDom();util.query(n,".cancel.btn").onclick=function(t){t.preventDefault(),o.close()}}setTimeout((function(){o.open();var n=o.getDialogDom(),s=c.length;function a(t,e,i,o,s,a,c){util.query(n,"h1").innerHTML=t,util.query(n,".ok.btn").innerHTML=e,util.query(n,"input.link-add-url").value=i,util.query(n,"input.link-add-title").value=o,util.query(n,"input.link-add-index").setAttribute("max",s),util.query(n,"input.link-add-index").value=a,util.query(n,"form").onsubmit=c}-1==t?a("添加链接","添加","","",s,s,(function(t){t.preventDefault();var a=util.query(n,".link-add-url").value;-1==a.indexOf("://")&&(a="http://"+a);var c=util.query(n,".link-add-title").value,l=util.query(n,".link-add-index").value;l=""==l?s:l-0,i.addLink({url:a,title:c,index:l,cate:e},(function(t){0!=t.code?toast.show(t.msg):(toast.show("添加成功"),o.close())}))})):a("修改链接","修改",c[t].url,c[t].title,s-1,t,(function(s){s.preventDefault();var a=util.query(n,".link-add-url").value;-1==a.indexOf("://")&&(a="http://"+a);var c=util.query(n,".link-add-title").value,l=util.query(n,".link-add-index").value;l=""==l?t:l-0,i.changeLink(e,t,{url:a,title:c,index:l},(function(t){0!=t.code?toast.show(t.msg):(toast.show("修改成功"),o.close())}))}))}))}function p(t){s||(s=new dialog({class:"link-add-dialog",content:'<form><h1></h1><div class="content"><p>标题：<input class="cate-name" type="text" required placeholder="分组标题(必填)"></p></div><div class="footer"><div class="cancel btn">取消</div><button class="ok btn">确定</button></div></form>'}));var e=s.getDialogDom();util.query(e,".cancel.btn").onclick=function(t){t.preventDefault(),s.close()},setTimeout((function(){s.open(),t?(util.query(e,"h1").innerHTML="修改分组",util.query(e,".cate-name").value=t,util.query(e,"form").onsubmit=function(n){n.preventDefault();var o=util.query(e,".cate-name").value;i.renameCate(t,o,(function(t){t.code<0?toast.show(t.msg):(toast.show("修改成功"),s.close())}))}):(util.query(e,"h1").innerHTML="添加分组",util.query(e,".cate-name").value="",util.query(e,"form").onsubmit=function(t){t.preventDefault();var n=util.query(e,".cate-name").value;i.addCate(n,(function(t){t.code<0?toast.show(t.msg):(toast.show("添加成功"),s.close())}))})}))}window.addEventListener("resize",(function(){g.call(util.query(e,".cate-bar-scrolls"))})),i.on("change",(function(t){var i=util.query(e,".cate-bar-items .cate-item.active");if((t.cate==i.innerText||null==t.cate&&i.classList.contains("mr"))&&-1!=["add","change","delete"].indexOf(t.type)&&h(t.cate),"cateadd"==t.type)d(t.cate);else if("catedelete"==t.type){for(var n=util.query(e,".cate-bar-items .cate-item",!0),o=0;o<n.length;o++)if(n[o].innerText==t.cate){n[o].classList.contains("active")&&(h(),util.query(e,".cate-bar-items .cate-item.mr").classList.add("active")),n[o].remove();break}}else if("caterename"==t.type)for(n=util.query(e,".cate-bar-items .cate-item",!0),o=0;o<n.length;o++)if(n[o].innerText==t.cate){n[o].innerText=t.catename;break}})),e.innerHTML='<div class="cate-bar"><div class="cate-bar-controls"><div class="cate-left-btn">{{cate-left}}</div></div><div class="cate-bar-scrolls"><div class="cate-bar-items"><div class="cate-item mr active">默认</div></div></div><div class="cate-bar-controls r"><div class="cate-right-btn">{{cate-right}}</div><div class="cate-add-btn">{{cate-add}}</div></div></div><ul class="link-list"></ul>'.replace("{{cate-left}}",util.getGoogleIcon("e314")).replace("{{cate-right}}",util.getGoogleIcon("e315")).replace("{{cate-add}}",util.getGoogleIcon("e145")),i.ready((function(){function n(t){if(t<0)return 0;var i=util.query(e,".cate-bar-scrolls").scrollWidth-util.query(e,".cate-bar-scrolls").getBoundingClientRect().width;return t>i?i:void 0}i.getCates((function(t){t.data.forEach((function(t){d(t)}))})),util.query(e,".cate-item.mr").onclick=function(){try{util.query(e,".cate-bar-items .cate-item.active").classList.remove("active")}catch(t){}this.classList.add("active"),h()},util.query(e,".cate-add-btn").onclick=function(){p()},util.query(e,".cate-left-btn").onclick=function(){util.query(e,".cate-bar-scrolls").scrollTo({left:n(util.query(e,".cate-bar-scrolls").scrollLeft-util.query(e,".cate-bar-scrolls").getBoundingClientRect().width/2),behavior:"smooth"})},util.query(e,".cate-right-btn").onclick=function(){util.query(e,".cate-bar-scrolls").scrollTo({left:n(util.query(e,".cate-bar-scrolls").scrollLeft+util.query(e,".cate-bar-scrolls").getBoundingClientRect().width/2),behavior:"smooth"})},util.query(e,".cate-bar-scrolls").onscroll=function(){g.call(this)},g.call(util.query(e,".cate-bar-scrolls")),k(t.get("enabledCate")),w(t.get("linksize"))})),new MutationObserver((function(){setTimeout(f,1)})).observe(util.query(e,".cate-bar-items"),{childList:!0}),void 0===t.get("enabledCate")&&t.set("enabledCate",!1),t.get("linksize")||t.set("linksize","m");var m=new SettingGroup({title:"链接"}),y=new SettingItem({type:"boolean",title:"链接分组",message:"(Alt+G)启用链接分组功能来管理链接",get:function(){return t.get("enabledCate")},callback:function(e){t.set("enabledCate",e),k(e)}}),b=new SettingItem({type:"select",title:"链接大小",message:"修改链接显示的大小",init:function(){return{xs:"很小",s:"小",m:"中",l:"大",xl:"很大"}},get:function(){return t.get("linksize")},callback:function(e){t.set("linksize",e),w(e)}});function k(t){h(),t?(util.query(e,".cate-bar").style.display="block",setTimeout((function(){f()}),10)):util.query(e,".cate-bar").style.display="none"}function w(t){util.query(e,".link-list").className="link-list "+t}return mainSetting.addNewGroup(m),m.addNewItem(y),m.addNewItem(b),{isShowCate:function(){return t.get("enabledCate")},setShowCate:function(e){t.set("enabledCate",e),k(e),y.reGet()},getLinkSize:function(){return t.get("linksize")},setLinkSize:function(e){-1!=["xs","s","m","l","xl"].indexOf(e)&&(t.set("linksize",e),w(e),b.reGet())},cateWidthShiPei:f}}();return i.on("change",(function(e){t.websync(e)})),util.joinObj(i,r)}(),says=function(){var t=storage("says",{sync:!0,title:"一言",desc:"QUIK起始页一言相关配置",get:async function(){var e=t.getAll(),i=quik.addon.getAddonBySessionId(e.saytype);return i&&(e.requireAddon=i.url),e},rewrite:function(t,e,i){return new Promise((function(n,o){if(i.requireAddon){var s=quik.addon.getAddonByUrl(i.requireAddon);s?(i.saytype=s.session.id,t[e]=i,n()):confirm("该一言数据需要安装插件以同步，是否安装？",(function(o){o?quik.addon.installAddon(i.requireAddon).then((function(o){i.saytype=o.session.id,t[e]=i,n()})).catch((function(t){alert(0==t?"插件取消安装，同步取消":"插件安装失败，同步取消",(function(){n()}))})):alert("已取消一言同步",(function(){n()}))}))}else t[e]=i,n()}))}}),e=util.element("div",{class:"says"});util.query(document,"main").appendChild(e);e.innerHTML=`<div class="say-inner"></div><div class="say-control">${util.getGoogleIcon("e5d4")}</div>`;var i=util.query(e,"div.say-inner"),n=util.query(e,"div.say-control"),o=new menu({list:[]}),s=new dialog({content:`<div class="closeBtn">${util.getGoogleIcon("e5cd")}</div><ul></ul>`,class:"says_info"}),a=s.getDialogDom();util.query(a,"div.closeBtn").onclick=function(){s.close()};var c,l={},r={};function u(t){l[t.key]={name:t.name,callback:t.callback,click:t.click||function(){},menu:t.menu||[{icon:util.getGoogleIcon("e14d"),title:"复制",click:function(){var t=r.say;util.copyText(t)}}]}}function d(e,n){if(util.checkSession(e)&&(e=e.id),!l[e])throw"type不存在 type:"+e;t.set("saytype",e),o.setList(l[e].menu),i.onclick=l[e].click,g(e,n),p.reGet()}function g(t,e){if(util.checkSession(t)&&(t=t.id),!l[t])throw"key不存在";i.innerText="...",i.title="加载中",l[t].callback().then((function(t){i.innerText=t.say,i.setAttribute("title",t.title),r=t,e&&e()}))}function f(t){util.query(a,"ul").innerHTML=function(){var e="";for(var i in t)e+="<li><b>"+i+":</b> "+t[i]+"</li>";return e}(),s.open()}u(function(){t.get("usersay")||t.set("usersay","海内存知己，天涯若比邻");var e=null;function i(){if(!e){var i=(e=new dialog({class:"sayseditordialog",content:'<h1>修改一言</h1><div class="content"><p><input class="says-input" type="text"/></p></div><div class="footer"><div class="cancel btn">取消</div><button class="ok btn">确定</button></div>'})).getDialogDom();util.query(i,".cancel.btn").onclick=function(){e.close()},util.query(i,".ok.btn").onclick=function(){var n=util.query(i,".says-input").value;t.set("usersay",n),g("user"),e.close()}}setTimeout((function(){var i=e.getDialogDom();e.open(),util.query(i,".says-input").value=t.get("usersay")}))}return{key:"user",name:"用户自定义",callback:function(){return new Promise((function(e,i){e({say:t.get("usersay"),title:"点击修改"})}))},click:function(){i()},menu:[{icon:util.getGoogleIcon("e3c9"),title:"修改",click:function(){i()}},{icon:util.getGoogleIcon("e14d"),title:"复制",click:function(){var t=r.say;util.copyText(t)}}]}}()),u((c={load:function(t){var e=0;!function i(){util.xhr("https://v1.hitokoto.cn/",(function(e){t(JSON.parse(e))}),(function(){++e<=5&&i()}))}()},cats:{a:"动画",b:"漫画",c:"游戏",d:"文学",e:"原创",f:"来自网络",g:"其他",h:"影视",i:"诗词",j:"网易云",k:"哲学",l:"抖机灵"}},{key:"hitokoto",name:"随机一言",callback:function(){return new Promise((function(t,e){c.load((function(e){t({say:e.hitokoto,from:e.from,uuid:e.uuid,cat:e.type,from_who:e.from_who,title:"该一言来自"+e.from+"，由"+e.from_who+"上传"})}))}))},click:function(){g("hitokoto")},menu:[{icon:util.getGoogleIcon("e5d5"),title:"刷新",click:function(){g("hitokoto")}},{icon:util.getGoogleIcon("e14d"),title:"复制",click:function(){var t=r.say;util.copyText(t)}},{icon:util.getGoogleIcon("e88e"),title:"一言详情",click:function(){var t=c.cats[r.cat];f({API:"Hitokoto (hitokoto.cn)","内容":r.say,"来源":r.from,"上传者":r.from_who,"分类":t||"未知",UUID:r.uuid})}}]})),u(function(){var t=storage("jrsc"),e={},i="jinrishici-token";function n(t,e){var i=new XMLHttpRequest;i.open("get",e),i.withCredentials=!1,i.send(),i.onreadystatechange=function(){if(4===i.readyState){var e=JSON.parse(i.responseText);"success"===e.status&&t(e)}}}return e.load=function(e){var o=t.get(i);return o?n(e,"https://v2.jinrishici.com/one.json?client=browser-sdk/1.2&X-User-Token="+encodeURIComponent(o)):n((function(n){t.set(i,n.token),e(n)}),"https://v2.jinrishici.com/one.json?client=browser-sdk/1.2")},{key:"jinrishici",name:"今日诗词",callback:function(){return new Promise((function(t,i){e.load((function(e){t({say:e.data.content,author:"("+e.data.origin.dynasty+")"+e.data.origin.author,p_title:"《"+e.data.origin.title+"》",tags:e.data.matchTags.join(" "),content:"<br>"+e.data.origin.content.join("<br>"),title:"摘自"+e.data.origin.dynasty+"·"+e.data.origin.author+"的《"+e.data.origin.title+"》"})}))}))},click:function(){g("jinrishici")},menu:[{icon:util.getGoogleIcon("e5d5"),title:"刷新",click:function(){g("jinrishici")}},{icon:util.getGoogleIcon("e14d"),title:"复制",click:function(){var t=r.say;util.copyText(t)}},{icon:util.getGoogleIcon("e88e"),title:"诗词详情",click:function(){f({API:"今日诗词（jinrishici.com）","内容":r.say,"作者":r.author,"标题":r.p_title,"全部内容":r.content})}}]}}()),setTimeout((function(){addon.on("allrun",(function(){h&&(t.set("saytype","user"),g("user"),alert("您的一言数据由于插件缺失无法显示，已为您切换为默认。"))}))})),n.onclick=function(t){t.stopPropagation();var e=n.getBoundingClientRect();o.setOffset({bottom:window.innerHeight-e.top,left:e.left-90+e.width}),o.show()},t.get("saytype")||t.set("saytype","user"),null==t.get("enabled")&&t.set("enabled",!0);var h,v=new SettingGroup({title:"一言",index:3}),p=new SettingItem({title:"一言类型",type:"select",index:1,message:"页面底部显示的一言类型",init:function(){var t={};for(var e in l)t[e]=l[e].name;return t},callback:function(t){d(t)},get:function(){return t.get("saytype")}}),m=new SettingItem({title:"显示一言",type:"boolean",message:"是否页面底部显示的一言",index:0,callback:function(i){t.set("enabled",i),i?(d(t.get("saytype")),e.style.display="",p.show()):(e.style.display="none",p.hide())},get:function(){return t.get("enabled")}});if(mainSetting.addNewGroup(v),v.addNewItem(p),v.addNewItem(m),t.get("enabled")){var y=t.get("saytype");l[y]?(o.setList(l[y].menu),i.onclick=l[y].click,g(y)):h=y}else e.style.display="none",p.hide();return{getNowSay:function(){return r},setSayType:d,addSayType:function(t){if(!util.checkSession(t.session))throw"错误的session";var e;t.key=t.session.id,u(t),p.reInit(),(e=t.key)==h&&(o.setList(l[e].menu),i.onclick=l[e].click,g(e),h=null)}}}(),card=function(){var t=util.query(document,".cards"),e=util.query(document,".top.cards"),i=function(i){this.width=i.width,this.height=i.height,this.offset=i.offset;var n=util.element("div",{class:"card"});n.innerHTML=i.content,n.style.width=i.width+"px",n.style.height=i.height+"px",i.class&&n.classList.add(i.class),i.offset&&("number"==typeof i.offset.top?n.style.top=i.offset.top+"px":"number"==typeof i.offset.bottom&&(n.style.bottom=i.offset.bottom+"px"),"number"==typeof i.offset.left?n.style.left=i.offset.left+"px":"number"==typeof i.offset.right&&(n.style.right=i.offset.right+"px")),this.el=n,i.topper?e.appendChild(n):t.appendChild(n),this.isShow=!1};return i.prototype={show:function(t){var e=this;e.isShow=!0,this.el.style.display="block",t&&t>0&&(this.el.style.transition="all "+t+"ms",this.el.offsetHeight,setTimeout((function(){e.el.style.transition="none"}),t)),this.el.style.opacity="1"},hide:function(t){var e=this;e.isShow=!1,t&&t>0?(this.el.style.transition="all "+t+"ms",setTimeout((function(){e.el.style.transition="none",e.el.style.display="none"}),t)):this.el.style.display="none",this.el.style.opacity="0"},destroy:function(){this.el.remove()},getCardDom:function(){return this.el},getOffset:function(){return this.offset},getWidth:function(){return this.width},getHeight:function(){return this.height},setWidth:function(t){this.width=t,this.el.style.width=t+"px"},setHeight:function(t){this.el.style.height=t+"px"},setOffset:function(t,e){var i=this,n=this.offset;if(e&&e>0){this.el.style.transition="all "+e+"ms";var o=this.el.getBoundingClientRect();"number"==typeof t.top?"number"==typeof n.bottom?this.el.style.bottom=window.innerHeight-t.top-o.height+"px":this.el.style.top=t.top+"px":"number"==typeof t.bottom&&("number"==typeof n.top?this.el.style.top=window.innerHeight-t.bottom-o.height+"px":this.el.style.bottom=t.bottom+"px"),"number"==typeof t.left?"number"==typeof n.right?this.el.style.right=window.innerWidth-t.left-o.width+"px":this.el.style.left=t.left+"px":"number"==typeof t.right&&("number"==typeof n.left?this.el.style.left=window.innerWidth-t.right-o.width+"px":this.el.style.right=t.right+"px"),setTimeout((function(){i.el.style.transition="none",s.call(i)}),e)}else s.call(i);function s(){this.offset=t,this.el.style.top="auto",this.el.style.left="auto",this.el.style.bottom="auto",this.el.style.right="auto","number"==typeof t.top?this.el.style.top=t.top+"px":"number"==typeof t.bottom&&(this.el.style.bottom=t.bottom+"px"),"number"==typeof t.left?this.el.style.left=t.left+"px":"number"==typeof t.right&&(this.el.style.right=t.right+"px")}}},i}(),guidecreator={create:function(t,e){if(0!=t.length){var i=new card({content:'<div class="guide-text"></div><div class="btn ok">确定</div>',class:"guide-card",offset:{top:0,left:0},width:200,topper:!0}),n=i.getCardDom(),o=0;s(),util.query(n,".btn.ok").addEventListener("click",(function(){++o>=t.length?(i.hide(300),e()):s()}))}else e();function s(){util.query(n,".guide-text").innerHTML=t[o].text,i.isShow?i.setOffset(t[o].offset,300):(i.setOffset(t[o].offset),i.show(300))}}},fcard=function(){var t=util.element("div",{class:"fcard-frame"}),e=!1;t.addEventListener("click",(function(t){e=!0})),document.querySelector("main").append(t);var i=0,n=[];function o(e){this.content=e.content,i++,this.id=i;var o=util.element("div",{class:"fcard"+(e.class?" "+e.class:"")});o.innerHTML='<div class="content">'+this.content+"<div>",t.insertBefore(o,t.firstChild),this.el=o,n.push(this),this.isShow=!0,a.style.display=""}function s(){for(var t=0;t<n.length;t++)if(n[t].isShow)return!1;return!0}o.prototype={show:function(){this.el.style.display="block",this.isShow=!0,a.style.display=""},hide:function(){this.el.style.display="none",this.isShow=!1,s()&&(a.style.display="none")},getFCardDom:function(){return this.el},destroy:function(){this.el.remove(),this.el=null,n.splice(n.indexOf(this),1),s()&&(a.style.display="none")}},o.getFCardById=function(t){for(var e=0;e<n.length;e++)if(n[e].id==t)return n[e];return null};var a=util.element("div",{class:"fcard-mob-zd"});return a.innerHTML=util.getGoogleIcon("e5cc"),a.style.display="none",document.querySelector("main").append(a),a.onclick=function(i){e=!0,t.classList.add("show"),this.classList.add("hide")},document.addEventListener("click",(function(){e?e=!1:(t.classList.remove("show"),a.classList.remove("hide"))})),o}(),background=function(){var t=new SettingGroup({title:"背景",index:3}),e=new SettingItem({title:"背景设置",message:"点击设置背景",index:0,type:"null",callback:function(){r.open()}});mainSetting.addNewGroup(t),t.addNewItem(e);var i=getEventHandle(),n=i.on,o=i.off,s=i.doevent,a=util.element("div",{class:"bgf"});util.query(document,"body").appendChild(a);var c=storage("background",{sync:!0,get:function(){return new Promise((function(t,e){var i=c.getAll();delete i.upload,"default"!=i.bg.type?i.requireAddon=quik.addon.getAddonBySessionId(i.bg.type).url:"userbg"==i.bg.data.type&&i.userbg.useidb&&(i.bg={type:"default",data:{type:"color",light:"#fff",dark:"#333"}}),i.userbg&&i.userbg.useidb?(delete i.userbg,alert("不支持同步用户上传的背景",(function(){t(i)}))):t(i)}))},rewrite:function(t,e,i){return new Promise((function(n,o){if(i.requireAddon){var s=quik.addon.getAddonByUrl(i.requireAddon);s?(i.bg.type=s.session.id,t[e]=i,n()):confirm("该背景数据需要安装插件以同步，是否安装？",(function(o){if(o){var s=addon.installAddon(i.requireAddon);s.on("error",(function(t){alert("插件安装失败，同步取消",(function(){n()}))})),s.on("wait",(function(t){t(!0)})),s.on("done",(function(o){i.bg.type=o.id,t[e]=i,n()}))}else alert("已取消背景同步",(function(){n()}))}))}else t[e]=i,n()}))},title:"背景",desc:"QUIK起始页背景相关配置"}),l=0;var r=new dialog({content:`<div class="actionbar"><h1>背景设置</h1><div class="closeBtn">${util.getGoogleIcon("e5cd")}</div></div><div class="tab_con"></div><div class="scroll_con"></div>`,class:"bg_d",mobileShowtype:dialog.SHOW_TYPE_FULLSCREEN}),u=r.getDialogDom();util.query(u,".closeBtn").onclick=function(){r.close()};var d=util.query(u,"div.tab_con"),g=util.query(u,"div.scroll_con");util.initSet(c,"bg",{type:"default",data:{type:"color",light:"#fff",dark:"#333"}});var f=function(){var e,i,n,o;util.initSet(c,"usercolor",{dark:"#333333",light:"#ffffff"}),util.initSet(c,"ivsetting",{mb:50,isbr:!1,br:6,th:1});var s,a={getImg:function(t){var e="";e=window.innerWidth<=500?"https://img.loliapi.cn/i/pe/img"+(parseInt(3095*Math.random())+1)+".webp":"https://img.loliapi.cn/i/pc/img"+(parseInt(696*Math.random())+1)+".webp",util.loadimg(e,(function(i){if(i)t({url:e,candownload:!0});else{if("siquan001.github.io"==window.location.host)return function(t){util.xhr("https://stear.cn/api/quik.php?m=bg&key=sys81a1g519lsokh0e8&host=siquan001.github.io",(function(e){e=JSON.parse(e),t({url:e.url,candoanload:!0})}),(function(){e="https://loliapi.com/acg/?_="+Date.now(),util.loadimg(e,(function(){t({url:e,candoanload:!1})}))}))};e="https://loliapi.com/acg/?_="+Date.now(),util.loadimg(e,(function(){t({url:e,candoanload:!1})}))}}))}},l={getImg:function(t){var e="https://img.gumengya.com/api/fj/"+(parseInt(4e3*Math.random())+1)+".jpg";util.loadimg(e,(function(i){i?t({url:e,candownload:!0}):(e="https://api.gumengya.com/Api/FjImg?format=image&_="+Date.now(),util.loadimg(e,(function(){t({url:e,candoanload:!1})})))}))}};if(window.isExt){s=[{thumbnail:"chrome-extension://{id}/assets/mrbgp1_th.png",img:"chrome-extension://{id}/assets/mrbgp1.webp"}];for(var r=0;r<s.length;r++)for(var d in s[r])s[r][d]=s[r][d].replace("{id}",window.extid)}else s=[{thumbnail:"https://image.gumengya.com/thumbnails/b0289db9349e17ca66be2e772cc647a5.png",img:"https://image.gumengya.cn/i/2024/06/09/66656920a034a.webp"}];var g=new iconc.icon({content:util.getGoogleIcon("e86a"),offset:"br",important:!0}),f=new iconc.icon({content:util.getGoogleIcon("f090"),offset:"br"});f.getIcon().onclick=function(){window.open(document.querySelector(".bgf img").src)};var h,v=new iconc.icon({content:util.getGoogleIcon("e88e"),offset:"br",important:!0}),p=new card({content:'<div class="copyright">...</div>\n      <div class="second">...</div>\n      <div class="title">...</div>\n      <a class="link" target="_blank" href="https://www.bing.com/">去Bing搜索</a>',offset:{right:5,bottom:50},class:"bing_info"});function m(){var t=new Date;return{light:`rgb(${256-t.getHours()},${256-t.getMinutes()},${256-t.getSeconds()})`,dark:`rgb(${t.getHours()},${t.getMinutes()},${t.getSeconds()})`}}v.getIcon().onclick=function(){var t;p.isShow?p.hide(400):(p.show(400),t=function(t){var e=p.getCardDom();util.query(e,".copyright").innerText=t.copyright,util.query(e,".second").innerText=t.second_copyright,util.query(e,".title").innerText=t.title,util.query(e,".link").href=t.link},h?t(h):util.xhr("https://bing.shangzhenyang.com/api/json",(function(e){var i=(e=JSON.parse(e)).images[0],n=i.copyright.split("(");n[1]="("+n[1],h={copyright:n[0],second_copyright:n[1],link:i.copyrightlink,title:i.title},t(h)}),(function(){t({copyright:"加载失败",second_copyright:"(© Bing)",link:"https://www.bing.com/",title:"点击前往必应"})})))},v.getIcon().title="显示壁纸详情",g.getIcon().onclick=function(){var t=document.querySelector(".bgf .full img");t&&(t.style.opacity="0");var e=this;setTimeout((function(){refreshFn.call(e)}),300)};var{ImgOrVideoSi:y,checkBgCoverStyle:b}=function(){var e=new SettingItem({title:"背景图片/视频显示设置",message:"设置背景图片/视频显示的蒙版和模糊等",type:"null",callback:function(){i.open()}});t.addNewItem(e);var i=new Setting({title:"背景图片/视频显示设置"}),n=new SettingGroup({title:"通用",index:0}),o=new SettingItem({title:"背景蒙版颜色主题",index:0,type:"select",init:function(){return{0:"跟随主题",1:"黑色",2:"白色"}},get:function(){return c.get("ivsetting").th||1},callback:function(t){var e=c.get("ivsetting");e.th=parseInt(t),c.set("ivsetting",e),r()}}),s=new SettingItem({title:"背景蒙版浓度",index:1,type:"range",init:function(){return[0,90]},get:function(){return c.get("ivsetting").mb},callback:function(t){var e=c.get("ivsetting");e.mb=t,c.set("ivsetting",e),r()}}),a=new SettingItem({title:"背景模糊",message:"可能会影响性能",type:"boolean",index:2,get:function(){return c.get("ivsetting").isbr},callback:function(t){t?l.show():l.hide();var e=c.get("ivsetting");e.isbr=t,c.set("ivsetting",e),r()}}),l=new SettingItem({title:"背景模糊程度",index:3,type:"range",init:function(){return[1,20]},get:function(){return c.get("ivsetting").br},callback:function(t){var e=c.get("ivsetting");e.br=t,c.set("ivsetting",e),r()}});function r(){if(document.querySelector(".bgf .img-sp")||document.querySelector(".bgf .video-sp")){var t=c.get("ivsetting"),e=document.querySelector("#ivbgse");e||((e=document.createElement("style")).id="ivbgse",document.head.append(e));var i="",n="";1==t.th?(d(),n="0,0,0",document.body.classList.add("t-dark"),document.body.classList.remove("t-light")):2==t.th?(d(),n="255,255,255",document.body.classList.remove("t-dark"),document.body.classList.add("t-light")):0==t.th&&(!function(){if(u)return;u=!0,quik.custom.on("colorchange",g)}(),"dark"==quik.custom.getColor()?(document.body.classList.add("t-dark"),document.body.classList.remove("t-light"),n="0,0,0"):(document.body.classList.remove("t-dark"),document.body.classList.add("t-light"),n="255,255,255")),i+=".img-sp .cover,.video-sp .cover{background-color:rgba("+n+","+t.mb/100+")}",t.isbr&&(i+=".img-sp .cover,.video-sp .cover{backdrop-filter:blur("+t.br+"px)}"),e.innerHTML=i}}i.addNewGroup(n),n.addNewItem(o),n.addNewItem(s),n.addNewItem(a),n.addNewItem(l),c.get("ivsetting").isbr||l.hide();var u=!1;function d(){u&&(u=!1,quik.custom.off("colorchange",g))}function g(t){var e=c.get("ivsetting"),i=document.querySelector("#ivbgse"),n="",o="";"dark"==t?(document.body.classList.add("t-dark"),document.body.classList.remove("t-light"),n="0,0,0"):(document.body.classList.remove("t-dark"),document.body.classList.add("t-light"),n="255,255,255"),o+=".img-sp .cover,.video-sp .cover{background-color:rgba("+n+","+e.mb/100+")}",e.isbr&&(o+=".img-sp .cover,.video-sp .cover{backdrop-filter:blur("+e.br+"px)}"),i.innerHTML=o}return r(),{ImgOrVideoSi:e,checkBgCoverStyle:r}}(),k=null,w={img:function(t,e){t.innerHTML='<div class="img-sp full"><div class="cover"></div><img src="'+(e.url||s[e.index].img)+'"/></div>',t.querySelector("img").onload=function(){this.style.opacity="1"},b(),y.show()},video:function(t,e){t.innerHTML='<div class="video-sp full"><div class="cover"></div><video src="" muted loop></video></div>',util.query(t,".video-sp video").src=e.url||s[e.index].img,util.query(t,".video-sp video").oncanplay=function(){this.play(),this.style.opacity="1"},b(),y.show()},color:function(t,e){if(t.innerHTML='<div class="color-sp full"></div>',!util.query(document.head,"style.colorSpControl")){var i=document.createElement("style");i.className="colorSpControl",document.head.appendChild(i)}util.query(document.head,"style.colorSpControl").innerHTML=`.color-sp{background-color:${e.light};}body.dark .color-sp{background-color:${e.dark};}`},api:function(t,e){function i(e){g.show(),g.getIcon().classList.add("round-anim"),e.getImg((function(e){g.getIcon().classList.remove("round-anim"),w.img(t,{url:e.url}),e.candownload&&f.show()})),refreshFn=function(){g.getIcon().classList.add("round-anim"),e.getImg((function(e){g.getIcon().classList.remove("round-anim"),w.img(t,{url:e.url}),e.candownload&&f.show()}))}}switch(e.api){case"acg":i(a);break;case"fj":i(l);break;case"bing":w.img(t,{url:"https://bing.shangzhenyang.com/api/1080p"}),f.show(),v.show();break;case"time":k=setInterval((function(){w.color(t,m())}),200)}},userbg:function(t,e){var i=c.get("userbg");if(i)if(document.body.classList.add("t-dark"),"video"==i.type)i.useidb?c.get("upload",!0,(function(e){w.video(t,{url:URL.createObjectURL(e)})})):w.video(t,{url:i.url});else if("image"==i.type){i.useidb?c.get("upload",!0,(function(e){w.img(t,{url:URL.createObjectURL(e)})})):w.img(t,{url:i.url})}},zdy:function(t,e){if(util.query(t,".zdy-sp")||(t.innerHTML='<div class="zdy-sp full"></div>'),!util.query(document.head,"style.zdySpControl")){var i=document.createElement("style");i.className="zdySpControl",document.head.appendChild(i)}util.query(document.head,"style.zdySpControl").innerHTML=`.zdy-sp{background:${e.light};}body.dark .zdy-sp{background:${e.dark};}`}},{getVideoCaptrue:q,getUserUploadUrl:x,hasUploadedImg:L,iovuploader:S}=function(){var t=new dialog({content:'<form><h1>上传背景</h1><div class="content"><p>背景类型：<input type="radio" class="uploadi" name="uploadiov" checked="checked"> 图片 <input type="radio" class="uploadv" name="uploadiov"> 视频</p><p>背景URL：<input type="url" placeholder="URL"></p><p class="tip">或者</p><p>从本地选择文件：<input type="file"></p></div><div class="footer"><div class="cancel btn">取消</div><button class="ok btn">确定</button></div></form>',class:"iovuploader"}),n=t.getDialogDom();function o(t){var e=c.get("userbg");if(e){if("video"==e.type)if(e.useidb)c.get("upload",!0,(function(e){s(URL.createObjectURL(e),(function(e){t(e)}))}));else try{s(e.url,(function(e){t(e)}))}catch(e){t(!1)}else if("image"==e.type){e.useidb?c.get("upload",!0,(function(e){t(URL.createObjectURL(e))})):t(e.url)}}else t(!1)}function s(t,e){var i=document.createElement("video");i.src=t,i.crossOrigin="anonymous",i.onloadedmetadata=function(){var t=document.createElement("canvas"),n=t.getContext("2d");t.width=i.videoWidth,t.height=i.videoHeight,i.currentTime=i.duration/4,i.oncanplay=function(){n.drawImage(i,0,0,t.width,t.height),e(t.toDataURL("image/png")),this.remove()}}}return util.query(n,".cancel").onclick=function(e){e.preventDefault(),t.close()},util.query(n,"form").onsubmit=function(s){s.preventDefault();var a=util.query(n,".uploadi").checked?"image":"video",l=util.query(n,'input[type="url"]').value,r=util.query(n,'input[type="file"]').files[0];util.query(u,".zdy .left img").src="",r?(c.set("upload",r,!0,(function(){t.close(),o((function(t){util.query(u,".zdy .left img").src=t})),i({type:"default",data:{type:"userbg"}})})),c.set("userbg",{type:a,useidb:!0})):(c.set("userbg",{type:a,url:l}),t.close(),o((function(t){util.query(e,".zdy .left img").src=t,i({type:"default",data:{type:"userbg"}})}))),util.query(e,".noBg").style.display="none",util.query(e,".hasBg").style.display="block",util.query(e,".zdy .editbtn").style.display="block"},{hasUploadedImg:function(){return!!c.get("userbg")},getUserUploadUrl:o,getVideoCaptrue:s,iovuploader:t}}(),{colorchanger:T,colorchangerf:I}=function(){var t=new dialog({content:'<form><h1>自定义背景颜色</h1><div class="content"><p>浅色模式：<input type="color" class="lightbgcolor"></p><p>深色模式：<input type="color" class="darkbgcolor"></p></div><div class="footer"><div class="cancel btn">取消</div><button class="ok btn">确定</button></div></form>'}),e=t.getDialogDom();return util.query(e,".cancel").onclick=function(e){e.preventDefault(),t.close()},util.query(e,"form").onsubmit=function(o){o.preventDefault();var s=util.query(e,".lightbgcolor").value,a=util.query(e,".darkbgcolor").value;c.set("color",{light:s,dark:a}),util.query(n,".zdy .color-left").style.backgroundColor=s,util.query(n,".zdy .color-right").style.backgroundColor=a,t.close(),i({type:"default",data:{type:"color",light:s,dark:a}})},{colorchanger:t,colorchangerf:e}}();function _(t){if(util.query(e,".bgitem",!0).forEach((function(t){t.classList.remove("selected")})),util.query(n,".bgitem",!0).forEach((function(t){t.classList.remove("selected")})),"default"==t.type)if("img"==t.data.type)try{util.query(e,'.neizhi .bgitem[data-id="'+t.data.index+'"]').classList.add("selected")}catch(t){}else"userbg"==t.data.type?util.query(e,".zdy .bgitem").classList.add("selected"):"api"==t.data.type?"time"==t.data.api?util.query(n,".api .bgitem").classList.add("selected"):util.query(e,'.api .bgitem[data-api="'+t.data.api+'"]').classList.add("selected"):"color"==t.data.type&&util.query(n,".zdy .bgitem").classList.add("selected")}function E(){document.body.classList.remove("t-dark"),g.hide(),refreshFn=function(){},clearInterval(k),f.hide(),y.hide(),v.hide()}return setTimeout((function(){_(quik.background.getbg()),quik.background.on("change",_)})),{drawer:{type:"default",init:function(t){i=t.setbg,e=t.pushBgTab({tab:"图片/视频",content:'<div class="unit-item zdy"><div class="unit-title">自定义</div><div class="unit-content"><div class="bgitem full"><div class="left"><div class="hasBg"><img src="" alt=""></div><div class="noBg"><span class="material-symbols-outlined">&#xf09b;</span></div></div><div class="right"><div class="bg-title">用户自定义背景</div><div class="bg-message">上传任意你喜欢的图片/视频作背景</div></div><div class="editbtn"><div class="btn ok">重新上传</div></div></div></div></div><div class="unit-item neizhi"><div class="unit-title">内置</div><div class="unit-content"></div></div><div class="unit-item api"><div class="unit-title">API</div><div class="unit-content"><div class="bgitem half" data-api="bing"><div class="left"><img data-src="https://bing.shangzhenyang.com/api/1080p" alt="" loading="lazy"></div><div class="right"><div class="bg-title">必应壁纸</div><div class="bg-message">获取必应首页的壁纸作为背景</div></div></div><div class="bgitem half" data-api="acg"><div class="left"><img data-src="https://www.loliapi.com/acg/" alt="" loading="lazy"></div><div class="right"><div class="bg-title">随机二次元壁纸</div><div class="bg-message">获取随机二次元壁纸作为背景，背景提供：loliapi.com</div></div></div><div class="bgitem half" data-api="fj"><div class="left"><img data-src="https://api.gumengya.com/Api/FjImg?format=image" alt="" loading="lazy"></div><div class="right"><div class="bg-title">随机风景壁纸</div><div class="bg-message">获取随机风景壁纸作为背景，背景提供：imgapi.cn</div></div></div></div></div><div class="unit-item se"><div class="u-se"><p>背景图片显示设置</p><p class="material-symbols-outlined">&#xe5cc;</p></div></div>'}),L()?(util.query(e,".noBg").style.display="none",x((function(t){util.query(e,".zdy .left img").src=t}))):(util.query(e,".hasBg").style.display="none",util.query(e,".zdy .editbtn").style.display="none"),util.query(e,".zdy .left").addEventListener("click",(function(){L()?t.setbg({type:t.type,data:{type:"userbg"}}):S.open()})),util.query(e,".zdy .editbtn").addEventListener("click",(function(){S.open();var t=c.get("userbg");t&&(util.query(iovuploaderf,'input[type="url"]').value=t.url,"image"==t.type?util.query(iovuploaderf,".uploadi").checked=!0:util.query(iovuploaderf,".uploadv").checked=!0)}));var a=util.query(e,".neizhi .unit-content");s.forEach((function(e,i){var n=util.element("div",{class:"bgitem def","data-id":i});n.innerHTML='<div class="left"><img data-src="'+e.thumbnail+'" loading="lazy"/></div>',a.appendChild(n),util.query(n,".left").onclick=function(){t.setbg({type:t.type,data:{type:"img",index:parseInt(n.getAttribute("data-id"))}})}})),util.query(e,".u-se").onclick=function(){y.callback()},util.query(e,".api.unit-item .left",!0).forEach((function(e){e.addEventListener("click",(function(){t.setbg({type:t.type,data:{type:"api",api:e.parentElement.getAttribute("data-api")}})}))})),n=t.pushBgTab({tab:"纯色",content:'<div class="unit-item zdy"><div class="unit-title">自定义颜色</div><div class="unit-content"><div class="bgitem full"><div class="left"><div class="color-left color"></div><div class="color-right color"></div></div><div class="right"><div class="bg-title">自定义纯色背景</div><div class="bg-message">将你喜欢的颜色做背景，分亮色和暗色（你也可以都设一个颜色或反着来，但不建议这么做）</div></div><div class="editbtn"><div class="btn ok">编辑</div></div></div></div></div><div class="unit-item api"><div class="unit-title">API</div><div class="unit-content"><div class="bgitem full" data-api="time"><div class="left"><div class="color-left color"></div><div class="color-right color"></div></div><div class="right"><div class="bg-title">时间的颜色</div><div class="bg-message">如果当前时间为12:34:56，那么时间的颜色就是rgb(12,34,56)，在亮色模式下就是rgb(255-12,255-34,255-56)</div></div></div></div></div>'});var l=c.get("usercolor");util.query(n,".zdy .color-left").style.backgroundColor=l.light,util.query(n,".zdy .color-right").style.backgroundColor=l.dark,util.query(n,".zdy .left").onclick=function(){var e=c.get("usercolor");t.setbg({type:t.type,data:{type:"color",light:e.light,dark:e.dark}})},util.query(n,".zdy .btn").onclick=function(){var t=c.get("usercolor");util.query(I,".lightbgcolor").value=t.light,util.query(I,".darkbgcolor").value=t.dark,T.open()};var r=m();util.query(n,".api .color-left").style.backgroundColor=r.light,util.query(n,".api .color-right").style.backgroundColor=r.dark,util.query(n,".api .left").onclick=function(){t.setbg({type:t.type,data:{type:"api",api:this.parentElement.getAttribute("data-api")}})},o=t.pushBgTab({tab:"自定义",content:'<p>浅色模式：</p><br><textarea class="gjzdytlight textarea"></textarea><p>深色模式：</p><br><textarea class="gjzdytdark textarea"></textarea> <button class="gjzdysetbtn">设置</button><p class="tip">参见 <a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/background" target="_blank">CSS | background属性</a></p>'});var u=c.get("custombglight"),d=c.get("custombgdark");util.query(o,".gjzdytlight").value=u||"",util.query(o,".gjzdytdark").value=d||"",util.query(o,".gjzdysetbtn").onclick=function(){c.set("custombglight",util.query(o,".gjzdytlight").value),c.set("custombgdark",util.query(o,".gjzdytdark").value),t.setbg({type:t.type,data:{type:"zdy",dark:util.query(o,".gjzdytdark").value,light:util.query(o,".gjzdytlight").value}}),quik.toast.show("设置成功")}},cancel:function(t){t.bgf.innerHTML="",E()},draw:function(t){var e=t.bgf,i=t.data;E(),w[i.type](e,i)}},draws:w}}(),h=f.drawer,v=[h];function p(t){var e=t.tab,i=util.element("div",{class:"tabitem","data-tab":l.toString()});d.appendChild(i),i.innerHTML=e,i.onclick=function(){m(this.getAttribute("data-tab"))};var n=util.element("div",{class:"scrollitem","data-tab":l.toString()});return g.appendChild(n),n.innerHTML=t.content,l++,n}function m(t){util.query(u,".tabitem",!0).forEach((function(t){t.classList.remove("active")})),util.query(u,".scrollitem",!0).forEach((function(t){t.style.display=""})),util.query(u,'.tabitem[data-tab="'+t+'"]').classList.add("active"),util.query(u,'.scrollitem[data-tab="'+t+'"]').style.display="block"}b(h);var y=0;function b(t){t.init({bgf:a,pushBgTab:p,setbg:x,type:t.type})}var k=null;setTimeout((function(){addon.on("allrun",(function(){k&&(k=null,c.set("bg",{type:"default",data:{type:"color",light:"#fff",dark:"#333"}}),q(c.get("bg")),alert("您的背景数据由于插件缺失无法显示，已为您切换为默认。"))}))}));var w=null;function q(t){for(var e=0;e<v.length;e++)if(t.type==v[e].type)return w&&w.type!=v[e].type&&(w.cancel({bgf:a}),w=v[e]),void v[e].draw({bgf:a,data:t.data});k=t}function x(t){c.set("bg",t),q(t),s("change",[t])}return q(c.get("bg")),m("0"),mainmenu.pushMenu({icon:util.getGoogleIcon("e1bc"),title:"背景设置",click:function(){r.open()}},mainmenu.MAIN_MENU_TOP),{pushBgDrawer:function(t){var e=t.session;try{if(!util.checkSession(e))throw"session error"}catch(t){throw new Error("背景Drawer注册失败，Session校验错误。")}var i="bgdrawer-"+y;return y++,t.type=i,v.push(t),b(t),function(t){k&&t.type==k.type&&(t.draw({bgf:a,data:k.data}),k=null)}(t),i},getbg:function(){return c.get("bg")},setbg:x,on:n,off:o,neizhiDraw:{img:f.draws.img,video:f.draws.video,color:f.draws.color}}}(),searchEditor=function(){var t=new dialog({content:'<div class="actionbar"><h1>搜索引擎列表设置</h1><div class="closeBtn">{{close}}</div></div><div class="list"><h2>内置搜索引擎</h2><div class="neizhilist"></div><h2>自定义搜索引擎</h2><div class="searchlist"></div></div><div class="footer"><button class="cancel btn">取消</button> <button class="ok btn">确定</button></div>'.replace("{{close}}",util.getGoogleIcon("e5cd")),mobileShowtype:dialog.SHOW_TYPE_FULLSCREEN,class:"search_editor"}),e=t.getDialogDom(),i=omnibox.neizhi,n=omnibox.getSearchTypeList(),o=util.query(e,".neizhilist");for(var s in i){var a=util.element("div",{class:"item","data-k":s});a.innerHTML="<img/><div>"+i[s].name+"</div>",function(t,e){util.getFavicon(i[t].link,(function(t){util.query(e,"img").src=t||util.createIcon("s")}))}(s,a),o.append(a),"bing"==s?a.addEventListener("click",(function(){toast.show("该项不可取消")})):a.addEventListener("click",(function(){this.classList.contains("active")?this.classList.remove("active"):this.classList.add("active")})),n.hasOwnProperty(s)&&(a.classList.add("active"),delete n[s])}var c="";for(var s in n)c+='<div class="item" data-k="'+s+'"><div class="icon"><img/></div><div class="url"><input value="'+n[s]+'"/></div><div class="remove">'+util.getGoogleIcon("e5cd")+"</div></div>";function l(t,e){e||util.getFavicon(n[t.getAttribute("data-k")],(function(e){util.query(t,".icon img").src=e||util.createIcon("s")})),util.query(t,".url input").oninput=function(){try{var t=this.parentElement.parentElement.querySelector(".icon img");util.getFavicon(this.value,(function(e){t.src=e||util.createIcon("s")}))}catch(t){}},util.query(t,".remove").onclick=function(){this.parentElement.remove()}}c+=`<div class="addnewitem">${util.getGoogleIcon("e145")} 添加自定义的搜索引擎</div>`,util.query(e,".searchlist").innerHTML=c,util.query(e,".searchlist .item",!0).forEach((function(t){l(t)})),util.query(e,".searchlist .addnewitem").onclick=function(){var t=util.element("div",{class:"item","data-k":"user_"+Date.now().toString().slice(3)});t.innerHTML='<div class="icon"><img src="https://cn.bing.com/favicon.ico"/></div><div class="url"><input value="https://cn.bing.com/search?q=%keyword%"/></div><div class="remove">'+util.getGoogleIcon("e5cd")+"</div>",util.query(e,".searchlist").insertBefore(t,util.query(e,".searchlist .addnewitem")),l(t,!0)},util.query(e,".closeBtn").onclick=util.query(e,".cancel.btn").onclick=function(){t.close()},util.query(e,".ok.btn").onclick=function(){var i={};util.query(e,".searchlist .item",!0).forEach((function(t){i[t.dataset.k]=t.querySelector(".url input").value})),util.query(e,".neizhilist .item.active",!0).forEach((function(t){i[t.dataset.k]=""})),(n=i)[omnibox.getSearchTypeIndex()]||omnibox.setSearchType("bing"),omnibox.setSearchList(n),t.close(),toast.show("设置成功")};var r=new SettingItem({title:"自定义搜索引擎",index:0,type:"null",message:"",callback:function(e){t.open()}});return omnibox.sg.addNewItem(r),{open:function(){t.open()}}}(),notice=function(){var t=document.querySelector(".notice-con"),e=document.querySelector(".no-notice-tip"),i='<div class="notice-actionbar"><div class="notice-title"></div><div class="notice-close-btn">{{close-btn}}</div></div><div class="notice-content"></div><div class="notice-progress"><div class="p"><div></div></div></div><div class="notice-btns"></div>',n=document.querySelector(".focus-notice"),o=0,s=!1;function a(e){var n;this.el=util.element("div",{class:"notice-item"}),t.appendChild(this.el),this.title=e.title,this.content=e.content,this.btns=e.btns||[],this.useprogress=e.useprogress,this.progress=0,(n=this).el.innerHTML=i.replace("{{close-btn}}",util.getGoogleIcon("e5cd")),util.query(n.el,".notice-close-btn").onclick=function(){n.hide()},u(n),d(n),g(n),f(n)}a.prototype={show:function(t){e.classList.remove("show"),v(1),clearTimeout(this._timeouthide),this.el.classList.add("show"),this.el.addEventListener("click",(function(t){s=!0}));var i=this;this.el.style.display="block",this.el.style.animation="noticein .3s",t&&setTimeout((function(){i.hide()}),t)},hide:function(){this.el.classList.remove("show"),document.querySelector(".notice-con .notice-item.show")||(e.classList.add("show"),v(0)),this.el.style.animation="noticeout .3s";var t=this;this._timeouthide=setTimeout((function(){t.el.style.display="none"}),300)},focus:function(){this.show(),function(t){l.push(t),1==l.length&&r()}(this)},destroy:function(){this.hide();var t=this;setTimeout((function(){t.el.remove()}),300)},setTitle:function(t){this.title=t,u(this)},setContent:function(t){this.content=t,d(this)},setBtn:function(t){this.btns=t,g(this)},setProgress:function(t){!this.useprogress||t>1||t<0||(this.progress=t,f(this))}};var c,l=[];function r(){var t=l[0],e=t.el.cloneNode(!0);n.appendChild(e),util.query(e,".notice-close-btn").onclick=function(){clearTimeout(c),e.remove(),t.hide(),l.shift(),l.length>0&&r()},g({el:e,btns:t.btns,hide:function(){t.hide(),clearTimeout(c),e.remove()},show:function(){}}),c=setTimeout((function(){e.remove(),l.shift(),l.length>0&&r()}),3e3)}function u(t){util.query(t.el,".notice-title").innerHTML=t.title}function d(t){util.query(t.el,".notice-content").innerHTML=t.content}function g(t){var e=util.query(t.el,".notice-btns");e.innerHTML="";for(var i=0;i<t.btns.length;i++)!function(i){var n=t.btns[i],o=util.element("div",{class:"btn"+(n.style?" "+n.style:"")});o.innerText=n.text,o.onclick=function(){n.click(t)},e.appendChild(o)}(i)}function f(t){t.useprogress?util.query(t.el,".notice-progress .p div").style.width=100*t.progress+"%":util.query(t.el,".notice-progress").style.display="none"}var h=new iconc.icon({content:util.getGoogleIcon("e7f4"),offset:"tl",class:"notice-icon"});function v(t){void 0===t?t=o:o=t,window.innerWidth<600&&t?h.show():h.hide()}return window.addEventListener("resize",(function(){v()})),h.getIcon().addEventListener("click",(function(){document.querySelector(".notice-sc").classList.add("show")})),document.querySelector(".notice-sc").addEventListener("click",(function(){s?s=!1:this.classList.remove("show")})),v(),function(){var t=storage("tuisong");util.initSet(t,"d",0);var e=t.get("d");util.xhr("/quik-notice.json",(function(i){if((i=JSON.parse(i)).date>e){setTimeout((function(){t.set("d",i.date)}),1e4);var n=new a({content:i.content,title:i.title,btns:i.btns.map((t=>{var e;return e=t.link?function(){n.hide(),window.open(t.link)}:function(){n.hide()},{text:t.text,style:t.style,click:e}}))});n.show()}}),(function(){}))}(),a}(),custom=(initsto=setting.settingSto,eventHandle=getEventHandle(),on=eventHandle.on,off=eventHandle.off,doevent=eventHandle.doevent,lite=function(){util.initSet(initsto,"linkblur",!0);var t=new SettingItem({index:2,title:"极简模式",message:"(Alt+X)隐藏所有图标和链接，点击LOGO显示",type:"boolean",get:function(){return!!initsto.get("lite")},callback:function(t){initsto.set("lite",t),n(t)}}),e=new SettingItem({index:3,title:"链接页面背景模糊",message:"链接页面背景一般模糊显示，关闭后正常显示",type:"boolean",get:function(){return initsto.get("linkblur")},callback:function(t){initsto.set("linkblur",t),o(t)}});tyGroup.addNewItem(t),tyGroup.addNewItem(e);var i=util.element("div",{class:"liteback"});function n(t){if(document.body.classList.remove("hiden"),document.body.classList.remove("showall"),t){if(document.body.classList.add("lite"),document.body.classList.add("hiden"),e.show(),!initsto.get("lite_firsted")){var i=document.querySelector("main .logo .imglogo").getBoundingClientRect();guidecreator.create([{text:"点击LOGO就可以显示链接和所有图标",offset:window.innerWidth>600?{top:i.top,left:i.left+i.width+10}:{top:i.top+i.height+10,left:i.left}}],(function(){initsto.set("lite_firsted",!0)}))}}else document.body.classList.remove("lite"),link.cateWidthShiPei(),e.hide()}function o(t){t?document.querySelector("main").classList.remove("noblur"):document.querySelector("main").classList.add("noblur")}return i.innerHTML=util.getGoogleIcon("e5ce"),document.querySelector("main .center").appendChild(i),i.addEventListener("click",(function(){document.body.classList.remove("showall"),document.body.classList.add("hiden")})),document.querySelector("main .center .logo").addEventListener("click",(function(){document.body.classList.add("showall"),document.body.classList.remove("hiden"),link.cateWidthShiPei()})),n(initsto.get("lite")),o(initsto.get("linkblur")),{set:function(e){e=!!e,initsto.set("lite",e),n(e),t.reGet()},get:function(){return initsto.get("lite")}}}(),logo=function(){var t=document.querySelector("main .center .logo");initsto.get("timelogo")?(initsto.set("logo","b"),initsto.remove("timelogo")):initsto.get("logo")||initsto.set("logo","a");var e=new SettingItem({index:4,title:"LOGO样式",message:"切换LOGO显示的内容",type:"select",init:function(){return{a:"普通LOGO",b:"LED时间",c:"空"}},get:function(){return initsto.get("logo")},callback:function(t){initsto.set("logo",t),s(t)}});function i(){for(var t="",e=0;e<7;e++)t+='<div class="num_line a'+e+'"></div>';return'<div class="_num">'+t+"</div>"}function n(t,e){for(var i={0:"1110111",1:"0010010",2:"1011101",3:"1011011",4:"0111010",5:"1101011",6:"1101111",7:"1010010",8:"1111111",9:"1111011"}[e],n=0;n<7;n++){var o=util.query(t,".a"+n);"1"==i[n]?o.classList.add("show"):o.classList.remove("show")}}util.query(t,".timelogo .h").innerHTML=util.query(t,".timelogo .m").innerHTML=i()+i();var o=!1;function s(e){util.query(t,".timelogo").style.display="none",util.query(t,".imglogo").style.display="none","a"==e?util.query(t,".imglogo").style.display="block":"b"==e&&(util.query(t,".timelogo").style.display="block",o||(o=!0,setInterval((function(){var e=new Date,i=util.b0(e.getHours()).toString(),o=util.b0(e.getMinutes()).toString(),s=util.query(t,".timelogo .h ._num",!0),a=util.query(t,".timelogo .m ._num",!0);n(s[0],i[0]),n(s[1],i[1]),n(a[0],o[0]),n(a[1],o[1])}),100)))}return s(initsto.get("logo")),tyGroup.addNewItem(e),{set:function(t){initsto.set("logo",t),s(t),e.reGet()},get:function(){return initsto.get("logo")}}}(),color=function(){var t=null;initsto.get("theme")||initsto.set("theme","a");var e=new SettingItem({index:1,title:"主题颜色",type:"select",message:"",get:function(){return initsto.get("theme")},callback:function(t){initsto.set("theme",t),n(t)},init:function(){return{a:"浅色",b:"深色",c:"跟随时间",d:"跟随系统"}}});tyGroup.addNewItem(e);var i=3;function n(e){var n;3!=i&&(i=!1),"b"==e?(document.body.classList.add("dark"),doevent("colorchange",["dark"]),t="dark"):"a"==e?(document.body.classList.remove("dark"),doevent("colorchange",["light"]),t="light"):"c"==e?(new Date).getHours()>=18||(new Date).getHours()<6?(document.body.classList.add("dark"),doevent("colorchange",["dark"]),t="dark"):(document.body.classList.remove("dark"),doevent("colorchange",["light"]),t="light"):"d"==e&&(window.matchMedia?3==i?(i=!0,(n=window.matchMedia("(prefers-color-scheme: dark)")).matches?document.body.classList.add("dark"):document.body.classList.remove("dark"),n.addEventListener("change",(e=>{e.matches?(document.body.classList.add("dark"),doevent("colorchange",["dark"]),t="dark"):(document.body.classList.remove("dark"),doevent("colorchange",["light"]),t="light")}))):i=!0:toast("你的浏览器不支持此功能"))}return n(initsto.get("theme")),{setTheme:function(t){initsto.set("theme",t),n(t),e.reGet()},on:on,off:off,getTheme:function(){return t}}}(),theme=function(){initsto.get("themea")||initsto.set("themea","def");var t=["dark","t-dark","t-light","dialogblur","lite","hiden","showall"],e={def:"默认主题"},i=new SettingItem({index:0,title:"主题",type:"select",message:"",get:function(){return initsto.get("themea")},callback:function(t){initsto.set("themea",t),n(t)},init:function(){return e}});function n(i){if(-1==t.indexOf(i)&&e[i])return document.body.classList.forEach((function(e){-1==t.indexOf(e)&&document.body.classList.remove(e)})),document.body.classList.add(i),doevent("dotheme",[]),o||(o=!0,s.forEach((t=>t()))),!0}tyGroup.addNewItem(i);var o=!1,s=[],a=!1;return n(initsto.get("themea"))||(a=!0,setTimeout((function(){addon.on("allrun",(function(){a&&(initsto.set("themea","def"),n("def"),alert("您的主题由于插件缺失无法显示，已为您切换为默认。"))}))}))),{addTheme:function(t,o){e[t]=o,i.reInit(),a&&t==initsto.get("themea")&&(a=!1,n(t))},removeTheme:function(t){"def"!=t&&(delete e[t],initsto.get("themea")==t&&(initsto.set("themea","def"),i.reGet()),i.reInit())},setTheme:function(t){e[t]&&(initsto.set("themea",t),n(t),i.reGet())},waitdotheme:function(t){o?t():s.push(t)}}}(),dialogblur=function(){var t=new SettingItem({index:3,title:"毛玻璃效果",message:"为所有内容开启毛玻璃效果，可能会影响性能。",type:"boolean",get:function(){return!!initsto.get("dialogblur")},callback:function(t){initsto.set("dialogblur",t),e(t)}});function e(t){t?document.body.classList.add("dialogblur"):document.body.classList.remove("dialogblur")}return tyGroup.addNewItem(t),e(initsto.get("dialogblur")),{set:function(i){i=!!i,initsto.set("dialogblur",i),e(i),t.reGet()},get:function(){return initsto.get("dialogblur")}}}(),{setLite:lite.set,isLite:lite.get,getColor:color.getTheme,setColor:color.setTheme,setTheme:theme.setTheme,addTheme:theme.addTheme,removeTheme:theme.removeTheme,isTimeLogo:function(){return"b"==logo.get()},setTimeLogo:function(){logo.set("b")},getLogo:logo.get,setLogo:logo.set,isDialogBlur:dialogblur.get,setDialogBlur:dialogblur.set,on:on,off:off,waitdotheme:theme.waitdotheme}),initsto,eventHandle,on,off,doevent,lite,logo,color,theme,dialogblur,addon=function(){var t=window.isExt?"chrome-extension://"+window.extid+"/assets/def_addon.png":"./assets/def_addon.png",e=function(){var t,e=getEventHandle();function i(t,e){return new Promise((function(i,n){var o=new XMLHttpRequest;o.open("GET",t,!0),o.onreadystatechange=function(){4==o.readyState&&200==o.status&&i(o.responseText)},o.onerror=function(){n(o.status)},o.onprogress=function(t){t.total?e&&e(t.loaded/t.total):e&&e(0)},o.send()}))}function n(t){if(0==(t=t.trim()).indexOf("/*QUIK_ADDON ")){var e=t.substring(13,t.indexOf(" */"));return"1"==(e=e.split("|"))[0]?{name:e[1],version_code:parseInt(e[2]),version:e[3],desc:e[4],author:e[5],icon:e[6],website:e[7],update:e[8],signature:e[9]}:{error:!0,msg:"un support meta version"}}return{error:!0,msg:"not QUIK addon"}}async function o(t,e,i){if("object"!=typeof e||e.error)return{msg:"插件格式错误:"+(e.msg||"META isn't an object"),error:!0};if(function(t){if(!t)return!1;for(var e=s.list(),i=0;i<e.length;i++)if(s.get(e[i]).signature==t)return!0}(e.signature))return{msg:"已安装相同插件",error:!0};var n=util.getRandomHashCache();for(var o in await new Promise((function(e){a.set(n,t,!0,e)})),e.id=n,i)void 0===e[o]&&(e[o]=i[o]);return s.set(n,e),await h(n),{id:n}}var s=storage("addon",{sync:!0,title:"插件",desc:"QUIK起始页插件数据",rewrite:function(t,e,i){return new Promise((function(n){if(0!=Object.keys(i).length){var o=new dialog({content:"<div>正在同步插件...[<span>0</span>/"+Object.keys(i).length+"]</div>",class:"dialog-addon-install",clickOtherToClose:!1});o.open();var a=o.getDialogDom(),l=0;for(var r in i){var u;i[r].url&&c(i[r].url)?d():(i[r].marketId?u=g(i[r].marketId):i[r].type?d():u=f(i[r].url),u.on("done",(function(){d()})),u.on("error",(function(){d(),alert("安装一个插件时失败")})),u.on("wait",(function(t){t(!0)})))}}else n();function d(){l++,util.query(a,"span").innerHTML=l,l==Object.keys(i).length&&(t[e]=s.getAll(),n())}}))}}),a=storage("addonscript");function c(t){var e=s.getAll();for(var i in e)if(e[i].url==t)return e[i]}var l=["初始化","获取插件信息","下载插件","等待确认","安装插件","安装成功"],r=["初始化失败","未找到插件信息","下载插件失败","插件解析错误","用户取消","安装失败"];function u(){this.statuCode=0,this.statuMsg=l[0],this.progress=0,this.errorCode=-1,this.errorMsg="",this.result=null,this.ev=getEventHandle(),this.on=this.ev.on,this.off=this.ev.off}function d(t){return function(i){i.error?t.setError(5,i.msg):(t.setStatu(5),t.setProgress(1),t.setDone(i),e.doevent("installnew",[i]))}}function g(e){var s=new u;function a(){if(t[e]){s.setProgress(.1),s.setStatu(2);var a=t[e].url;i(a,(function(t){s.setProgress(.1+.5*t)})).then((function(t){s.setProgress(.6),s.setStatu(3),o(t,n(t),{marketId:e}).then(d(s))})).catch((function(){s.setError(2,a)}))}else s.setError(1,e)}return storage.checkIDB()||s.setError(0,"浏览器不支持IndexedDB"),t?a():v().then(a),s}function f(t){var e=new u;return storage.checkIDB()||e.setError(0,"浏览器不支持IndexedDB"),e.setProgress(.1),e.setStatu(2),i(t,(function(t){e.setProgress(.1+.5*t)})).catch((function(i){e.setError(2,t)})).then((function(i){e.setProgress(.6);var s=n(i);s.error?e.setError(3,s.msg):(e.setStatu(3),e.wait({meta:s,msg:"确定是否安装此插件？"},(function(n){n?o(i,s,{url:t}).then(d(e)):e.setError(4,"")})))})),e}async function h(t){var e,i=s.get(t),n=document.createElement("script");"dev"==i.type?await new Promise(((t,n)=>{util.requestByExt({url:i.url+"index.js",method:"get",responseType:"text",then:function(i){e=i.data,t()},catch:function(){alert("开发端口出错"),n()}})})):e=await new Promise((e=>a.get(t,!0,e))),n.innerHTML=`(function(){\n      function Session(id){\n        this.id="ext_"+id;\n        this.session_token="Hvm_session_token_eoi1j2j";\n        this.isSession=true;\n      };\n      var addonData={\n        session:new Session('${t}'),\n        uninstall:function(fn){quik.addon._doonun(this.session,fn)}\n      };\n      (function(){\n        ${e}\n      })();\n    })()`,document.body.appendChild(n)}async function v(){return t||(t=await(await fetch("/addon_market/list.json")).json())}function p(){return s.list()}if(u.prototype={setProgress:function(t){this.progress=t,this.ev.doevent("progress",[t])},setStatu:function(t){this.statuCode=t,this.statuMsg=l[t],this.ev.doevent("statu",[{code:t,msg:l[t]}])},setError:function(t,e){this.errorCode=t,this.errorMsg=r[t]+" "+e,this.ev.doevent("error",[{code:t,msg:r[t]+" "+e}])},setDone:function(t){this.result=t,this.ev.doevent("done",[t])},wait:function(t,e){this.waiting=!0;var i=this;this.ev.doevent("wait",[function(n){i.waiting=!1,e(n),i._waitfn=e,i._waitd=t},t]),this._waitfn=e,this._waitd=t}},!window.addon_){var m=[];p().forEach((t=>{s.get(t).disabled||m.push(h(t))}));try{Promise.all(m).then((function(){setTimeout((function(){e.doevent("allrun",[])}),100)}))}catch(t){}}var y={};return{enable:function(t){var e=s.get(t);e.disabled=!1,s.set(t,e)},disable:function(t){var e=s.get(t);e.disabled=!0,s.set(t,e)},loadMarketData:v,installByOfficialMarket:g,installByUrl:f,installByLocal:function(t,e){e=new u,storage.checkIDB()||e.setError(0,"浏览器不支持IndexedDB"),e.setProgress(.1),e.setStatu(1);var i=n(t);return i.error?e.setError(3,i.msg):(e.setProgress(.5),e.setStatu(3),e.wait({meta:i,msg:"确定是否安装此插件？"},(function(n){n?o(t,i,{local:!0}).then(d(e)):e.setError(4,"")}))),e},installByDev:function(t){if(window.isExt){var i=util.getRandomHashCache();return s.set(i,{name:"DEVPORT:"+t,url:t,type:"dev"}),e.doevent("installnew",[{id:i}]),h(i),i}alert("请在浏览器扩展中安装开发端口")},uninstall:async function(t){var i=s.get(t);return!!i&&(s.remove(t),"dev"!=i.type&&await new Promise((e=>{a.remove(t,!0,e)})),e.doevent("uninstall",[{id:t,marketId:i.marketId}]),y[t]&&y[t](),!0)},runAddon:h,checkUpdate:async function(t){var e=s.get(t);if(!e)throw"not found addon";if(e.type)return!1;var i=e.update;if(!i)return!1;var n,o,a=await fetch((n=e.marketId?(await v())[e.marketId].url:e.url,o=i,n.substring(0,n.lastIndexOf("/"))+"/"+o));return a=await a.text(),(a=parseInt(a))>e.version_code},update:async function(t){var o=s.get(t);if(!o)return{error:!0,msg:"未找到插件"};if(o.url||o.marketId){o.marketId&&(o.url=(await v())[o.marketId].url);try{var c=await i(o.url)}catch(t){return{error:!0,msg:"代码请求失败",code:t}}var l=n(c);if(l.error)return{error:!0,msg:"META 解析失败:"+l.msg};if(l.signature!=o.signature)return{error:!0,msg:"签名校验失败"};if(l.version_code>=o.version_code){for(var r in l)o[r]=l[r];return await new Promise((function(e){a.set(t,c,!0,e)})),s.set(t,o),e.doevent("update",{id:t}),{ok:1,id:t,version_code:l.version_code}}return{error:!0,msg:"版本校验失败"}}return{error:!0,msg:"无法升级此插件"}},checkMarket:async function(e){for(var i in t||await v(),t)if(t[i].url==e){var n=JSON.parse(JSON.stringify(t[i]));return n.id=i,n}return!1},getAddonByUrl:c,getAddonBySessionId:function(t){return s.get(t)},getAddonByMarketId:function(t){var e=s.getAll();for(var i in e)if(e[i].marketId==t)return e[i]},getAddonList:p,getEnable:function(t){return!s.get(t).disabled},_doonun:function(t,e){util.checkSession(t)&&"function"==typeof e&&(y[t.id]=e)},on:e.on,off:e.off}}(),i=function(){function e(){var e=new dialog({content:'<div class="ma"><div class="sth"><img src="{deficon}" alt="图标"><p class="name">...</p><p class="version">版本：...</p></div><div class="progress"><div class="r"></div></div><div class="msg"></div><div class="btns"><div class="btn l">取消</div><div class="btn r">确定</div></div></div>'.replace("{deficon}",t),class:"addon_install_ui",clickOtherToClose:!1});this._d=e;var i=this._d.getDialogDom();util.query(i,".btns").style.display="none"}return e.prototype={bind:function(t){var e=this,i=this._d.getDialogDom();if(util.query(i,".msg").innerText=t.statuMsg+"...",util.query(i,".progress .r").style.width=100*t.progress+"%",-1!=t.errorCode&&(util.query(i,".msg").innerText=t.errorMsg,util.query(i,".progress").className="progress error",util.query(i,".btns").style.display="block",util.query(i,".btn.l").onclick=util.query(i,".btn.r").onclick=function(){e.hide(),setTimeout((function(){e.destroy()}),200)}),t.waiting){var n=t._waitfn,o=t._waitd;o.meta&&(util.query(i,".sth img").src=o.meta.icon,util.query(i,".sth .name").innerText=o.meta.name,util.query(i,".sth .version").innerText="版本："+o.meta.version),util.query(i,".msg").innerText=o.msg,util.query(i,".btns").style.display="block",util.query(i,".btn.l").onclick=function(){n(!1)},util.query(i,".btn.r").onclick=function(){n(!0)}}t.on("status",(function(t){util.query(i,".msg").innerText=t.msg})),t.on("progress",(function(t){util.query(i,".progress .r").style.width=100*t+"%"})),t.on("error",(function(t){util.query(i,".msg").innerText=t.msg,util.query(i,".progress").className="progress error",util.query(i,".btns").style.display="block",util.query(i,".btn.l").onclick=util.query(i,".btn.r").onclick=function(){e.hide(),setTimeout((function(){e.destroy()}),200)}})),t.on("wait",(function(t,e){e.meta&&(util.query(i,".sth img").src=e.meta.icon,util.query(i,".sth .name").innerText=e.meta.name,util.query(i,".sth .version").innerText="版本："+e.meta.version),util.query(i,".msg").innerText=e.msg,util.query(i,".btns").style.display="block",util.query(i,".btn.l").onclick=function(){t(!1)},util.query(i,".btn.r").onclick=function(){t(!0)}})),t.on("done",(function(){e.hide(),setTimeout((function(){e.destroy()}),200)}))},ask:function(t,e,i={}){var n=this._d.getDialogDom();util.query(n,".sth img").src=i.img||"assets/def_addon.png",util.query(n,".sth .name").innerText=i.name||"-",util.query(n,".sth .version").innerText="版本："+i.version||"-",util.query(n,".msg").innerText=t,util.query(n,".btns").style.display="block",util.query(n,".btn.l").onclick=function(){e(!1),util.query(n,".btns").style.display="none"},util.query(n,".btn.r").onclick=function(){e(!0),util.query(n,".btns").style.display="none"}},show:function(){this._d.open()},hide:function(){this._d.close()},destroy:function(){this._d.destroy()}},e}(),n=new dialog({content:'<div class="addon-bar"><div class="l"><div class="item active" data-p="0">插件管理</div><div class="item" data-p="1">插件市场</div></div><div class="r"><div class="add-btn">{{add-btn}}</div><div class="closeBtn">{{close-btn}}</div></div></div><div class="content"><div class="p gl" style="display:block"><ul></ul></div><div class="p ma"><div class="addon-search-box"><input type="text" placeholder="搜索插件"> <button>{{search}}</button></div><ul><div class="loading-p"><div class="g"></div></div></ul></div></div>'.replace("{{close-btn}}",util.getGoogleIcon("e5cd")).replace("{{search}}",util.getGoogleIcon("e8b6")).replace("{{add-btn}}",util.getGoogleIcon("e145")),mobileShowtype:dialog.SHOW_TYPE_FULLSCREEN,class:"addon-dialog"}),o=n.getDialogDom();util.query(o,".closeBtn").addEventListener("click",(()=>{n.close()}));var s=new menu({list:[{icon:util.getGoogleIcon("e157"),title:"从第三方链接添加插件",click:function(){prompt("请输入插件链接",(function(t){if(!t)return!1;var n=e.installByUrl(t),o=new i;return o.show(),o.bind(n),n.on("done",(function(t){alert("安装成功")})),!0}))}},{icon:util.getGoogleIcon("e66d"),title:"从第三方文件添加插件",click:function(){showOpenFilePicker().then((function(t){var n=t[0],o=(n.name,new FileReader),s=new i;s.show(),o.onload=function(){var t=e.installByLocal(o.result);s.bind(t),t.ondone=function(t){installing_notice.destroy(),alert("安装成功")}},o.readAsText(n)}))}},{icon:util.getGoogleIcon("e86f"),title:"添加开发者端口",click:function(){window.isExt?prompt("请输入开发者端口链接",(function(t){if(!t)return!1;e.installByDev(t),alert("安装成功")})):alert("请在浏览器扩展中安装开发端口")}}],offset:{top:0,left:0}});util.query(o,".add-btn").addEventListener("click",(function(t){t.stopPropagation();var e=this.getBoundingClientRect();s.setOffset({top:e.top+e.height,right:window.innerWidth-e.left-e.width}),s.show()})),new iconc.icon({offset:"tr",content:util.getGoogleIcon("e87b",{type:"fill"})}).getIcon().onclick=function(){n.open()};var a=util.query(o,".addon-bar .l .item",!0),c=util.query(o,".content .p",!0);a.forEach((function(t){t.onclick=function(){a.forEach((function(t){t.classList.remove("active")})),this.classList.add("active"),c.forEach((function(t){t.style.display=""})),c[this.dataset.p].style.display="block"}}));var l=util.query(o,".content .p.gl ul");function r(i){var n=e.getAddonBySessionId(i);"dev"==n.type&&(n.name="开发者端口："+n.url,n.author="dev",n.desc="开发者端口："+n.url);var o=util.query(l,'li[data-id="'+i+'"]');o||((o=util.element("li")).innerHTML='<div class="n"><img src="{deficon}" alt="" onerror="this.src=\'{deficon}\'"><div class="ds"><div class="name"><span></span><div class="official_state">官方</div><div class="disabled_state">已禁用</div></div><div class="message"><span></span> <span></span> <span></span></div></div></div><div class="d"><div class="desc"></div><div class="website"></div><div class="controls"><div class="btn ch_update">检查更新</div><div class="btn update">更新</div><div class="btn enable">启用</div><div class="btn disable">禁用</div><div class="btn uninstall" style="display:block">卸载</div></div></div>'.replace(/{deficon}/g,t),o.dataset.id=i,l.appendChild(o),o.onclick=function(t){l.querySelectorAll("li").forEach((function(t){t.classList.remove("active")})),this.classList.add("active")},util.query(o,".ch_update").onclick=function(){a.innerHTML="检查更新中...";var t=this;t.style.display="",e.checkUpdate(i).then((function(e){e?(a.innerHTML="发现新版本",util.query(o,".update").style.display="block"):(t.style.display="block",a.innerHTML="已是最新版本")}))},util.query(o,".update").onclick=function(){a.innerHTML="更新中...";var t=this;t.style.display="",e.update(i).then((function(e){e.error?(a.innerHTML="更新失败:"+e.msg,t.style.display="block"):(r(i),a.innerHTML="更新完成，刷新生效",util.query(o,".ch_update").style.display="inline-block")}))},util.query(o,".enable").onclick=function(){a.innerHTML="已启用，刷新生效",e.enable(i),util.query(o,".disable").style.display="block",util.query(o,".disabled_state").style.display="none",this.style.display=""},util.query(o,".disable").onclick=function(){a.innerHTML="已禁用，刷新生效",e.disable(i),util.query(o,".enable").style.display="block",util.query(o,".disabled_state").style.display="",this.style.display=""},util.query(o,".uninstall").onclick=function(){confirm("你真的要卸载吗？此操作不可恢复！",(function(t){t&&(a.innerHTML="正在卸载...",e.uninstall(i).then((function(t){t.error?alert("卸载出现错误："+t.msg):alert("卸载成功，刷新生效")})))}))}),util.query(o,".n>img").src=n.icon||t,util.query(o,".n .ds .name span").innerText=n.name;var s=util.query(o,".n .ds .message span",!0);s[0].innerText=n.author||"不详",s[1].innerText=n.version||"",s[2].innerText="",util.query(o,".d .desc").innerText=n.desc||"",util.query(o,".d .website").innerText=n.website||"";var a=util.query(o,".message span",!0)[2];n.type||(util.query(o,".ch_update").style.display="block"),n.disabled?(util.query(o,".enable").style.display="block",util.query(o,".disabled_state").style.display=""):(util.query(o,".disable").style.display="block",util.query(o,".disabled_state").style.display="none"),n.marketId?util.query(o,".official_state").style.display="":util.query(o,".official_state").style.display="none"}e.getAddonList().forEach((function(t){r(t)})),e.on("installnew",(function(t){r(t.id)})),e.on("update",(function(t){r(t.id)})),e.on("uninstall",(function(t){var e=util.query(l,'li[data-id="'+t.id+'"]');e&&e.remove()}));var u=util.query(o,".content .p.ma ul"),d=!1;function g(){e.loadMarketData().then((function(t){for(var e in u.querySelector(".loading-p").remove(),t)f(t[e],e)})).catch((function(){u.innerHTML='<p>加载失败，点击<a href="javascript:;">重试</a></p>',util.query(u,"a").onclick=function(){u.innerHTML='<div class="loading-p"><div class="g"></div></div>',g()}}))}function f(i,n){var o=util.element("li");o.innerHTML='<div class="n"><img src="{deficon}" alt="" onerror="this.src=\'{deficon}\'"><div class="ds"><div class="name"><span></span><div class="official_state">官方</div></div><div class="message"><span></span> <span></span> <span></span></div></div></div><div class="d"><div class="desc"></div><div class="website"></div><div class="controls"><div class="btn installed">已安装</div><div class="btn update">更新</div><div class="btn install" style="display:block">安装</div></div></div>'.replace(/{deficon}/g,t),o.dataset.id=n,o.onclick=function(t){u.querySelectorAll("li").forEach((function(t){t.classList.remove("active")})),this.classList.add("active")},util.query(o,".n>img").src=i.icon||t,util.query(o,".n .ds .name span").innerText=i.name;var s=util.query(o,".n .ds .message span",!0);s[0].innerText=i.author||"不详",s[1].innerText=i.version||"",s[2].innerText="",util.query(o,".d .desc").innerText=i.desc||"",util.query(o,".d .website").innerText=i.website||"",u.appendChild(o);var a=e.getAddonByMarketId(n);a&&(util.query(o,".btn.install").style.display="",a.version_code<i.version_code?util.query(o,".btn.update").style.display="block":util.query(o,".btn.installed").style.display="block"),util.query(o,".btn.install").addEventListener("click",(function(){this.style.display="",s[2].innerText="正在安装...(0%)";var t=e.installByOfficialMarket(n);t.on("progress",(function(t){s[2].innerText="正在安装...("+parseInt(100*t)+"%)"})),t.on("done",(function(){s[2].innerText="安装完成",util.query(o,".btn.installed").style.display="block",toast.show("插件 “"+i.name+"” 安装完成")})),t.on("error",(function(t){s[2].innerText="安装出错（"+t.msg+"）",util.query(o,".btn.install").style.display="block",toast.show("插件 “"+i.name+"” 安装出错（"+t.msg+"）")}))})),util.query(o,".btn.update").addEventListener("click",(function(){this.style.display="",s[2].innerText="正在更新...",e.update(a.id).then((function(){s[2].innerText="更新完成",util.query(o,".btn.installed").style.display="block",toast.show("插件 “"+i.name+"” 更新完成")}))}))}util.query(o,'.l .item[data-p="1"]').addEventListener("click",(function(){d||(d=!0,g())})),e.on("uninstall",(function(t){if(t.marketId){var e=util.query(u,'li[data-id="'+t.marketId+'"]');e&&(util.query(e,".btn.install").style.display="block",util.query(e,".btn.installed").style.display="")}}));var h=util.query(o,".addon-search-box");function v(t){util.query(u,"li",!0).forEach((function(e){-1==util.query(e,".name span").innerText.indexOf(t)?e.style.display="none":e.style.display=""}))}return util.query(h,"input").addEventListener("keydown",(function(t){"Enter"==t.key&&this.value.trim()&&v(this.value.trim())})),util.query(h,"input").addEventListener("input",(function(){this.value.trim()||util.query(u,"li",!0).forEach((function(t){t.style.display=""}))})),util.query(h,"button").addEventListener("click",(function(t){util.query(h,"input").value.trim()&&v(this.value.trim())})),window.addon_&&alert("已在安全模式下运行，插件功能已关闭！"),e.upinstallByOfficialMarket=function(t){return new Promise((function(n,o){if(e.getAddonByMarketId(t))o({code:-3,msg:"插件已安装"});else{var s=new i;s.show(),e.loadMarketData().then((function(i){i[t]?s.ask("要安装插件 “"+i[t].name+"” 吗？（该插件来自官方商店）",(function(i){if(i){var a=e.installByOfficialMarket(t);s.bind(a),a.on("done",(function(t){alert("安装成功"),n({code:0,result:t})})),a.on("error",(function(t){o({code:-2,msg:"安装错误",err:t})}))}else o({code:-1,msg:"用户取消"})}),{img:i[t].icon,name:i[t].name,version:i[t].version}):o({code:-2,msg:"插件ID不存在"})}))}}))},e.upinstallByUrl=function(t){return new Promise((function(n,o){if(e.getAddonByUrl(t))o({code:-3,msg:"插件已安装"});else{var s=new i;s.show(),s.ask("要安装来自 "+t+" 的插件吗？",(function(i){if(i){var a=e.installByUrl(t);s.bind(a),a.on("done",(function(t){alert("安装成功"),n({code:0,result:t})})),a.on("error",(function(t){o({code:-2,msg:"安装错误",err:t})}))}else o({code:-1,msg:"用户取消"}),s.hide(),setTimeout((function(){s.destroy()}),200)}))}}))},e.upuninstall=function(t){return new Promise((function(i,n){e.getAddonBySessionId(t)?confirm("要卸载 "+e.getAddonBySessionId(t).name+" 吗？",(function(o){o?e.uninstall(t).then((function(t){t.error?(alert("卸载出现错误："+t.msg),n({code:-3,msg:"卸载出现错误",err:t})):(alert("卸载成功，刷新生效"),i({code:0,result:t}))})):n({code:-2,msg:"用户取消"})})):n({code:-1,msg:"没有该插件"})}))},e.upupdate=function(t){return new Promise((function(i,n){e.getAddonBySessionId(t)?confirm("要更新 "+e.getAddonBySessionId(t).name+" 吗？",(function(o){o?e.update(t).then((function(e){e.error?(alert("更新出现错误："+e.msg),n({code:-3,msg:"更新出现错误",err:e})):(alert("更新成功，刷新生效"),i({code:0,result:e}),r(t))})):n({code:-2,msg:"用户取消"})})):n({code:-1,msg:"没有该插件"})}))},e}();let{alert:alert,confirm:confirm,prompt:prompt}=(base='<div class="def_dialog"><h1>提示</h1><div class="content">$0</div><div class="footer">$1<button class="ok btn">确定</button></div></div>',emptyFn=function(){},{alert:function(t,e){e||(e=emptyFn);var i=new dialog({content:base.replace("$0","").replace("$1",""),clickOtherToClose:!1});setTimeout((function(){i.open()}),10);var n=i.getDialogDom();util.query(n,".content").innerText=t,util.query(n,".ok").onclick=function(){e(),i.close(),setTimeout((function(){i.destroy()}),299)}},confirm:function(t,e){e||(e=emptyFn);var i=new dialog({content:base.replace("$0","").replace("$1",'<button class="cancel btn">取消</button>'),clickOtherToClose:!1});setTimeout((function(){i.open()}),10);var n=i.getDialogDom();util.query(n,".content").innerText=t,util.query(n,".ok").onclick=function(){e(!0),i.close(),setTimeout((function(){i.destroy()}),299)},util.query(n,".cancel").onclick=function(){e(!1),i.close(),setTimeout((function(){i.destroy()}),299)}},prompt:function(t,e){e||(e=emptyFn);var i=new dialog({content:base.replace("$0",'<p class="c"></p><p><input type="text"/></p>').replace("$1",'<button class="cancel btn">取消</button>'),clickOtherToClose:!1});setTimeout((function(){i.open()}),10);var n=i.getDialogDom();util.query(n,".content .c").innerText=t,util.query(n,".ok").onclick=function(){e(util.query(n,".content input").value),i.close(),setTimeout((function(){i.destroy()}),299)},util.query(n,".cancel").onclick=function(){e(""),i.close(),setTimeout((function(){i.destroy()}),299)},util.query(n,".content input").focus(),util.query(n,".content input").addEventListener("keydown",(function(t){"Enter"==t.key&&(e(this.value),i.close(),setTimeout((function(){i.destroy()}),299))}))}});var base,emptyFn,sync=function(){var{getJSON:t,setJSON:e}=function(){async function t(t){var e={};for(var i in t)if("string"==typeof t[i]&&"^"==t[i][0]){var n={"^_t":"db","^_k":t[i],"^_d":await localforage.getItem(t[i])};try{JSON.stringify(n),e[i]=n}catch(t){}}else e[i]=t[i];return e}async function e(t,e,i){for(var n in i)if("db"==i[n]["^_t"]&&i[n]["^_k"]){if(!quik.storage.checkIDB())throw new Error("Your browser is not support indexedDB,Please update your browser.");await localforage.setItem(i[n]["^_k"],i[n]["^_d"]),t[e][n]=i[n]["^_k"]}else t[e][n]=i[n]}return{getJSON:async function(e){for(var i=getStorageList(),n=getAllStorage(),o={},s=0;s<e.length;s++){var a=e[s];if(i[a]){o[a]={title:i[a].title||a,desc:i[a].desc||"",addon:i[a].addon,data:null};try{i[a]&&i[a].sync&&(i[a].get?o[a].data=await i[a].get():o[a].data=await t(n[a]))}catch(t){throw new Error("在获取 "+a+" 时遇到错误",t)}}}return o},setJSON:async function(t,i){var n=getStorageList(),o=getAllStorage(),s={};for(var a in t)if(i[a])if(n[a]){if(s[a]=o[a],"rewrite"==i[a])"function"==typeof n[a].rewrite?await n[a].rewrite(s,a,t[a].data):await e(s,a,t[a].data);else if("compare"==i[a]){if("function"!=typeof n[a].compare)throw new Error(a+" 不支持compare");await n[a].compare(s,a,t[a].data)}}else t[a].addon;var c=JSON.parse(localStorage.quik2);for(var a in s)c[a]=s[a];localStorage.quik2=JSON.stringify(c),alert("数据导入成功，请重新加载页面",(function(){-1!=location.hash.indexOf(";")?location.hash=location.hash.split(";")[0]+";newnow":location.hash="#newnow",location.reload()}))}}}(),i=new SettingGroup({title:"数据",index:4}),n=new SettingItem({title:"导出数据",message:"导出数据到文件",type:"null",callback:o});function o(){u.open();var t=getStorageList();for(var e in t)if(t[e]&&t[e].sync){var i=t[e],n=document.createElement("div");n.classList.add("item"),n.innerHTML=`<input type="checkbox"/><div class="message">\n        <div class="title">${i.title||e}</div>\n        <div class="desc">${i.desc||""}</div>\n      </div>`,n.dataset.key=e,util.query(d,".exportslist").appendChild(n),util.query(n,"input").checked=!0}}var s=new SettingItem({title:"导入数据",message:"从文件导入数据",type:"null",callback:a});function a(){showOpenFilePicker().then((function(t){var e=t[0];if(e)try{var i=new FileReader;i.onload=function(t){c(r=JSON.parse(t.target.result))},i.readAsText(e)}catch(t){alert("读取文件有误！")}}))}function c(t){r=t;var e=getStorageList();for(var i in g.open(),t)l(t[i],i,e)}function l(t,e,i){var n=document.createElement("div");if(!i[e]&&t.addon&&!addon.getAddonByUrl(t.addon)){n.classList.add("item");var o=!1;function s(i){n.innerHTML=`<input type="checkbox" disabled/><div class="message">\n            <div class="title">${t.title||e}</div>\n            <div class="desc">需要安装插件以同步：${i}</div>\n          </div>\n          <div class="installbtn">安装</div>`,n.querySelector(".installbtn").addEventListener("click",(function(){var i;this.classList.contains("ing")||(this.classList.contains("err")&&this.classList.remove("err"),this.innerHTML="安装中...",this.classList.add("ing"),(i=o?addon.installByOfficialMarket(t.addon.replace("market:","")):addon.installByUrl(t.addon)).on("error",(function(t){n.querySelector(".installbtn").innerHTML="安装失败",this.classList.add("err")})),i.on("wait",(function(t){t(!0)})),i.on("done",(function(i){n.remove(),setTimeout((function(){l(t,e,getStorageList())}),10)})))}))}return 0==t.addon.indexOf("market:")?(n.innerHTML="加载中...",o=!0,addon.loadMarketData().then((function(e){e[t.addon.replace("market:","")]&&s(e[t.addon.replace("market:","")].name)}))):s(t.addon),n.dataset.key=e,void util.query(f,".importslist").appendChild(n)}i[e]&&(n.classList.add("item"),n.innerHTML=`<input type="checkbox"/><div class="message">\n      <div class="title">${t.title||e}</div>\n      <div class="desc">${t.desc||""}</div>\n    </div>`,i[e].compare&&(n.innerHTML+='<select>\n        <option value="compare">对比</option>\n        <option value="rewrite">覆盖</option>\n      </select>',util.query(n,"select").value="compare"),n.dataset.key=e,util.query(f,".importslist").appendChild(n),util.query(n,"input").checked=!0)}i.addNewItem(n),i.addNewItem(s),mainSetting.addNewGroup(i);var r=null,u=new dialog({content:`<div class="actionbar">\n      <h1>导出数据</h1>\n      <div class="closeBtn">${util.getGoogleIcon("e5cd")}</div>\n    </div>\n    <div class="exportslist">\n    </div>\n    <div class="btns">\n      <div class="btn cancel">取消</div>\n      <div class="btn ok">导出</div>\n    </div>`,class:"sync-dialog",mobileShowtype:dialog.SHOW_TYPE_FULLSCREEN}),d=u.getDialogDom();util.query(d,".closeBtn").onclick=util.query(d,".cancel").onclick=function(){u.close()},util.query(d,".ok").onclick=function(){var e=[];util.query(d,".exportslist .item",!0).forEach((function(t){util.query(t,"input").checked&&e.push(t.dataset.key)})),t(e).then((function(t){var e,i,n;e=JSON.stringify(t),i="quik-2-exportdata.json",(n=document.createElement("a")).href=URL.createObjectURL(new Blob([e],{type:"application/json"})),n.download=i,n.click()})),u.close()};var g=new dialog({content:`<div class="actionbar">\n      <h1>导入数据</h1>\n      <div class="closeBtn">${util.getGoogleIcon("e5cd")}</div>\n    </div>\n    <div class="importslist">\n    </div>\n    <div class="btns">\n      <div class="btn cancel">取消</div>\n      <div class="btn ok">导入</div>\n    </div>`,class:"sync-dialog",mobileShowtype:dialog.SHOW_TYPE_FULLSCREEN}),f=g.getDialogDom();util.query(f,".closeBtn").onclick=util.query(f,".cancel").onclick=function(){r=null,g.close()},util.query(f,".ok").onclick=function(){var t={};util.query(f,".importslist .item",!0).forEach((function(e){util.query(e,"input").checked&&(util.query(e,"select")?t[e.dataset.key]=util.query(e,"select").value:t[e.dataset.key]="rewrite")})),e(r,t),g.close()};var{registerWebSync:h,unregister:v,isSync:p}=function(){var e=storage("websync");e.get("wait")||e.set("wait",[]);var i,n=e.get("yesid");async function o(t){i=t,await i.isLogin()||await i.login(),!function(){var t=location.hash.slice(1);-1!=t.indexOf(";")&&(t=t.split(";")[1]);if("newnow"==t)return!0}()?await new Promise((function(t,n){i.getLastReq().then((o=>{if(o!=e.get("last_req")){var a=s.getDialogDom();if("no"==o)l();else{var r=new Date(o).toLocaleString()+"的更改";util.query(a,".last_req").innerText=r,util.query(a,".btn.ok").onclick=function(){!async function(){var t=new dialog({content:"获取中。。。"});t.open();var e=await i.getAll();t.close(),c(e.data)}()},util.query(a,".btn.cancel").onclick=function(){l().then(t).catch(n)}}}})).catch(n)})):await l(),function(){for(var t=e.get("wait"),i=0;i<t.length;i++)t[i].sp||(t[i].value=storage(t[i].key).getAll()),r(t[i]);storage.on("websync",(function(t){var i=Date.now();t.id=i,function(t){var i=e.get("wait");t.sp?i.push(t):i.push({key:t.key,id:t.id});e.set("wait",i),a.show()}(t),r(t)}))}()}var s=new dialog({content:'<div>\n            <p>您的在线存档与本地存档存在冲突:</p>\n            <p class="last_req"></p>\n            <p>你要：</p>\n        </div>\n        <div class="btns">\n            <div class="btn ok">从在线同步</div>\n            <div class="btn cancel">本地覆盖在线</div>\n        </div>'}),a=new iconc.icon({content:util.getGoogleIcon("eb5a"),offset:"br",important:!0});async function l(){a.show();var n=t(Object.keys(getStorageList())),o=Date.now();await i.updateAll(n,o),e.set("last_req",o),a.hide()}function r(t){i.update(t,(function(i){i?(e.set("last_req",reqId),function(t){e.set("last_req",t);for(var i=e.get("wait"),n=0;n<i.length;n++)if(i[n].id==t){i.splice(n,1);break}e.set("wait",i),0==i.length&&a.hide()}(reqId)):new notice({title:"云同步",content:"数据（"+new Date(reqId).toLocaleString()+"的更改）同步失败了，是否重试？",btns:[{text:"确定",click:function(){r(t)}},{text:"取消",click:function(){}}]}).show()}))}return a.hide(),{registerWebSync:function(t,i,s){util.checkDetailsCorrect(t,["isLogin","login","getLastReq","getAll","update","updateAll"])?util.checkSession(i)?n!=i.id?comfirm('插件 "'+addon.getAddonById(i.id)+'" 申请提供数据云同步功能，是否同意？',(function(a){a?(n=i.id,e.set("yesid",n),e.remove("last_reqid"),s({code:0,msg:"OK"}),o(t)):s({code:-1,msg:"用户取消"})})):(s({code:0,msg:"OK"}),o(t).catch((function(t){new notice({title:"云同步",content:"云同步初始化失败，请检查网络连接后刷新"}).show()}))):s({code:-3,msg:"session不正确"}):s({code:-2,msg:"格式不正确"})},unregister:function(t){util.checkSession(t)?n==t.id&&e.remove("yesid"):cb({code:-3,msg:"session不正确"})},isSync:function(){return!!n}}}(),m=function(){var t=new SettingItem({title:"QUIK 1",message:"从 QUIK 1 中导入数据",type:"null",callback:e});function e(){var t=new dialog({content:"正在加载模块..."});t.open();var e=util.element("script",{src:"./quik1.js"});document.body.append(e),window.quik1to2=function(e){window.quik1to2=null,e(c),t.close()}}return i.addNewItem(t),e}();return{getJSON:t,setJSON:e,openImport:a,openExport:o,registerWebSync:h,unregister:v,isSync:p,openQUIK1:m}}(),hotkey=void document.addEventListener("keydown",(function(t){"s"==t.key&&t.altKey?(t.preventDefault(),mainSetting.open()):"x"==t.key&&t.altKey?(t.preventDefault(),custom.setLite(!custom.isLite())):"g"==t.key&&t.altKey&&(t.preventDefault(),link.setShowCate(!link.isShowCate()))})),ignores=function(){var t=new SettingGroup({title:"关于",index:5});mainSetting.addNewGroup(t);var e=new SettingItem({type:"null",title:"关于QUIK起始页",index:1,callback:function(){c.open()}}),i=new SettingItem({type:"null",title:"更新日志",index:2,callback:function(){r.open(),d||function(){d=!0;var t=util.element("script",{src:"./updates.js"});document.body.append(t),window.connectUpdates=function(t){util.query(u,".version_list div").innerHTML=function(){var e="";for(var i in t)e+=g(i,t[i]);return e}(),window.connectUpdates=null},t.onload=function(){t.remove()}}()}}),n=new SettingItem({type:"null",title:"用户协议和隐私政策",index:3,callback:function(){h.open()}}),o=new SettingItem({type:"null",title:"特别鸣谢",index:4,callback:function(){v.open()}}),s=(o=new SettingItem({type:"null",title:"提供反馈",index:5,callback:function(){window.open("./feedback.html")}}),new SettingItem({type:"null",title:"加入官方QQ群",message:"在官方QQ群可以查看最新消息，也是处理建议最快的地方，更有机会参与新功能测试",index:5,callback:a}));function a(){window.open("https://qm.qq.com/q/6nOculioy4"),confirm("如果没有跳转至QQ，点击确定复制群号：971915865",(function(t){t&&util.copyText("971915865")}))}t.addNewItem(e),t.addNewItem(i),t.addNewItem(n),t.addNewItem(o),t.addNewItem(s),mainmenu.pushMenu({icon:util.getGoogleIcon("e88e"),title:"关于QUIK",click:function(){c.open()}},1),mainmenu.pushMenu({icon:util.getGoogleIcon("e0bf"),title:"加入官方QQ群",click:a},1);var c=new dialog({content:'<div class="about-dialog"><div class="close">{{close-btn}}</div><div class="ab-logo"><svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 456 128"><circle cx="64" cy="64" r="40" stroke="black" stroke-width="3" fill="transparent"/><line x1="74" y1="74" x2="104" y2="104" style="stroke:rgb(0,0,0);stroke-width:3;"/><path d="M148 24L148 68Q148 104 180 104Q212 104 212 68L212 24" style="fill:transparent;stroke:rgb(0,0,0);stroke-width:3;"></path><path d="M276 24L306 24M291 24L291 104M276 104L306 104" style="fill:transparent;stroke:rgb(0,0,0);stroke-width:3;"></path><path d="M384 24L384 104M424 26L384 68M424 102L384 68" style="fill:transparent;stroke:rgb(0,0,0);stroke-width:3;"></path></svg></div><div class="t ver">当前版本: <span></span></div><div class="t intro">介绍: QUIK起始页是由前端爱好者<a href="https://siquan001.github.io/?ref=quik" target="_blank">陈思全</a>编写的一个简洁、实用的浏览器主页</div><div class="t license">版权声明: 本项目以GPL 3.0协议声明，版权归原作者所有。</div><div class="t thanks">感谢这些项目或可爱的人为QUIK起始页提供的支持: <a href="javascript:;">点击查看</a></div><div class="t feedback">反馈: chensiquan2023@qq.com</div></div>'.replace("{{close-btn}}",util.getGoogleIcon("e5cd")),mobileShowtype:dialog.SHOW_TYPE_FULLSCREEN}),l=c.getDialogDom();util.query(l,".close").onclick=function(){c.close()},util.query(l,".t.thanks a").onclick=function(){v.open()},setTimeout((function(){util.query(l,".ver span").innerText=window.version.version}));var r=new dialog({content:`<div class="actionbar">\n      <h1>更新日志</h1>\n      <div class="closeBtn">${util.getGoogleIcon("e5cd")}</div>\n    </div>\n    <div class="version_list"><div></div></div>`,mobileShowtype:dialog.SHOW_TYPE_FULLSCREEN,class:"update_dia"}),u=r.getDialogDom();util.query(u,".closeBtn").onclick=function(){r.close()};var d=!1;function g(t,e){for(var i="",n={new:"新增",del:"删除",fix:"修复",change:"修改",thanks:"感谢"},o=e.updates,s=0;s<o.length;s++)i+='<div class="update_item"><div class="update_item_tag '+o[s].tag+'"><div>'+n[o[s].tag]+'</div></div><div class="update_item_content">'+o[s].content+"</div></div>";return'<div class="version_item"><div class="version_item_title">'+t+'</div><div class="version_item_update_time">发布时间：'+e.time+'</div><div class="version_update">'+i+"</div></div>"}util.query(u,".version_list div").innerHTML="正在加载更新日志...";var f='<h1>QUIK起始页用户协议与隐私政策</h1><p><b>请务必认真阅读！</b></p><h2>一、QUIK起始页简介</h2><p>QUIK起始页（以下简称本产品）是一个由个人开发者（<a href="https://siquan001.github.io/" target="_blank">陈思全</a>）编写的一个开源免费的纯前端项目，以GPL 3.0 license声明，版权归原作者所有</p><h2>二、用户使用须知</h2><p>1.使用本产品即代表您同意本条款的所有内容。</p><p>2.<b>下面的插件使用须知更重要</b></p><p>3.本产品中的大部分图标使用Google开源的Material Outlined图标。</p><p>4.本产品中一言的“随机一言”功能由hitokoto.cn提供，如若出现有关一言的“随机一言”的内容相关问题，请联系hitokoto.cn，本产品不负责任</p><p>5.本产品中一言的“今日诗词”功能由jinrishici.com提供，如若出现有关一言的“今日诗词”的内容相关问题，请联系jinrishici.com，本产品不负责任</p><p>6.本产品中的搜索联想功能由百度提供，如若出现有关搜索联想的内容相关问题，请联系百度，本产品不负责任</p><p>7.本产品中背景的“必应壁纸”功能由bing.shangzhenyang.com和必应提供，如若出现有关背景的“必应壁纸”的图片内容相关问题，请联系bing.shangzhenyang.com和必应，本产品不负责任</p><p>8.本产品中背景的“随机二次元壁纸”功能由loliapi.com提供，如若出现有关背景的“随机二次元壁纸”的图片内容相关问题，请联系loliapi.com，本产品不负责任</p><p>9.本产品中背景的“随机风景壁纸”功能由api.gumengya.com提供，如若出现有关背景的“随机风景壁纸”的图片内容相关问题，请联系api.gumengya.com，本产品不负责任</p><p>10.本产品中搜索框的“自动翻译”功能由api.gumengya.com和api.oioweb.cn提供，如若出现有关搜索框的“自动翻译”的内容相关问题，请联系api.gumengya.com，本产品不负责任</p><p>11.本产品的随机背景API均支持下载壁纸，但这些壁纸仅能用做壁纸，禁止商业化使用</p><h2>三、插件使用须知</h2><p>1.本产品提供插件拓展功能，使用本产品的插件拓展功能即代表您知晓并同意本条款的所有内容。</p><p>2.安装官方提供的插件需要您同意插件的用户协议与隐私政策，若与本协议存在出入，以本协议为准</p><p>3.安装来自第三方的不明插件是十分不安全的行为，同时请保证您的设备未被病毒程序感染，<b>否则本产品不能保证您的数据安全和使用安全！</b></p><h2>四、隐私政策</h2><p>1.本产品本身属于纯前端项目，不会收集您的任何信息，您的所有数据都会存在本地</p><p>2.如您安装了插件，插件可能会收集您的一些信息，详见插件的用户协议与隐私政策。</p><p>3.本产品中使用的一些API和站点服务提供者可能会收集您的IP地址、Cookie等信息用于数据分析和安全防护等</p>';var h=new dialog({content:` <div class="close">${util.getGoogleIcon("e5cd")}</div><div class="lic-con">${f}</div>`,mobileShowtype:dialog.SHOW_TYPE_FULLSCREEN,class:"lic-dialog"});util.query(h.getDialogDom(),".close").onclick=function(){h.close()};var v=new dialog({content:`<div class="close">${util.getGoogleIcon("e5cd")}</div><div class="thank-con"><h1>特别鸣谢</h1><h2>感谢以下项目对QUIK的支持</h2><ul><li><a href="https://github.com/localForage/localForage" target="_blank">localforage</a> - 为indexedDB的管理提供一个方便的类似于localStorage的API</li><li><a href="https://github.com/siquan001/rem/" target="_blank">REM</a> - 简单的模块化工具（我做的）</li></ul><h2>感谢以下服务对QUIK的支持</h2><ul><li><a href="https://loliapi.com/" target="_blank">loliapi</a> - 双端自适应随机二次元图片API提供</li><li><a href="https://api.gumengya.com/" target="_blank">故梦API</a> - 随机风景图片API,随机一言API提供</li><li><a href="https://bing.com/" target="_blank">必应</a> | <a href="https://bing.shangzhenyang.com/" target="_blank">bing.shangzhenyang.com</a> - 每日必应壁纸API提供</li><li><a href="https://jinrishici.com/" target="_blank">jinrishici.com</a> - 随机诗词API提供</li><li><a href="https://baidu.com/" target="_blank">百度</a> - 搜索联想API提供</li><li><a href="https://github.com/" target="_blank">Github</a> - 静态网站托管服务提供</li></ul><h2>感谢所有QUIK用户和支持QUIK的人</h2><p style="padding-left: 20px;">没有你们，就没有现在的QUIK起始页。</p></div>`,class:"thank-dialog",mobileShowtype:dialog.SHOW_TYPE_FULLSCREEN});return util.query(v.getDialogDom(),".close").onclick=function(){v.close()},{lic:f}}();!function(){window.version_code=87,window.version={version:"2.2.4",version_code:window.version_code,updateTime:"2024/8/10",log:[{tag:"fix",content:"修复一些已知问题"}]},"serviceWorker"in navigator&&!window._dev&&(navigator.serviceWorker.ready.then((function(t){window.swReg=t,quik.util.xhr("./version",(function(e){var i=parseInt(e);i>version_code&&(quik.toast.show("发现新版本(版本序号："+i+")，正在更新"),t.active.postMessage("update"))}),(function(){}))})),navigator.serviceWorker.addEventListener("message",(function(t){"updated"==t.data&&quik.confirm("新版本已准备就绪，是否刷新页面",(function(t){t&&(localStorage.setItem("__q__s__","1"),location.reload())}))})));var t=null;function e(t){for(var e="",i={new:"新增",del:"删除",fix:"修复",change:"修改",thanks:"感谢"},n=0;n<t.length;n++)e+='<div class="update_item"><div class="update_item_tag '+t[n].tag+'"><div>'+i[t[n].tag]+'</div></div><div class="update_item_content">'+t[n].content+"</div></div>";return e}localStorage.getItem("__q__s__")&&(t||(t=new dialog({content:`<h1>版本更新</h1><div class="version_item">\n<div class="version_item_title">版本号：${window.version.version}</div>\n<div class="version_item_update_time">发布时间：${window.version.updateTime}</div>\n<div class="version_update">${e(window.version.log)}</div>\n</div><div class="footer"><div class="btn ok">我知道了</div></div>`,class:"update_dialog"}),util.query(t.getDialogDom(),".btn.ok").onclick=function(){t.close()}),setTimeout((function(){t.open()})),localStorage.removeItem("__q__s__"))}(),function(){var t=storage("safe");function e(){var t,e=location.hash.slice(1);-1!=e.indexOf(";")&&(t=e.split(";")[0],e=e.split(";")[1]),"safe"==e?(location.hash="#"+(t?t+";":"")+"safe_called",location.reload()):"safe_called"==e&&(location.hash="#"+(t?t+";":""),window.addon_=!1,alert("已阻止所有插件运行，请修改设置或删除插件"))}window.addEventListener("hashchange",e),window.addEventListener("visibilitychange",(function(){"hidden"==document.visibilityState?document.body.style.display="none":(document.body.style.display="block",link.cateWidthShiPei())})),e();var i=new SettingGroup({title:"高级",index:5}),n=new SettingItem({title:"性能模式",message:"强制关闭所有滤镜和动画效果",index:1,type:"boolean",get:function(){return!!t.get("xnse")},callback:function(e){t.set("xnse",e),s(e)}});i.addNewItem(n);var o=new SettingItem({title:"清除数据",message:"清除QUIK起始页的所有数据",index:2,type:"null",callback:function(){confirm("确定要清除所有数据吗？",(function(t){if(t){!function t(){prompt("请在下方输入“clearAll”，并再次确定是否要清除所有数据，此操作无法恢复。",(function(e){if("clearAll"==e){var i=storage("oobe").getAll();localStorage.quik2=JSON.stringify({oobe:i}),localforage.clear().then((function(){location.reload()}))}else e&&t()}))}()}}))}});function s(t){if(t){var e=util.element("style");e.id="xnse",e.innerHTML="*{filter:none!important;backdrop-filter:none!important;animation:none!important;transition:none!important;}",document.head.append(e)}else try{document.getElementById("xnse").remove()}catch(t){}}i.addNewItem(o),mainSetting.addNewGroup(i),s(!!t.get("xnse")),window.addEventListener("offline",l),window.addEventListener("online",l);var a=new iconc.icon({content:util.getGoogleIcon("f239"),offset:"br",important:!0});a.getIcon().style.color="red";var c=new notice({title:"断网提醒",content:"您的网络已断开，请尽快重连！"});function l(){window.navigator.onLine?(c.hide(),a.hide()):(c.show(),c.focus(),a.show())}l()}(),function(){var t=storage("oobe");if(t.get("agree"))l();else{var e=ignores.lic,i=0,n='<div class="part a1">{{part1}}</div><div class="part a2">{{part2}}</div>',o=['<div class="lic-c">{{lic}}</div><div class="btns"><div class="btn cancel">不同意</div><div class="btn ok">同意</div></div>','<div class="imglogo"><svg xmlns="http://www.w3.org/2000/svg" style="stroke: #000;" version="1.1" viewBox="0 0 456 128"><circle cx="64" cy="64" r="40" stroke-width="3" fill="transparent"/><line x1="74" y1="74" x2="104" y2="104" style="stroke-width:3;"/><path d="M148 24L148 68Q148 104 180 104Q212 104 212 68L212 24" style="fill:transparent;stroke-width:3;"></path><path d="M276 24L306 24M291 24L291 104M276 104L306 104" style="fill:transparent;stroke-width:3;"></path><path d="M384 24L384 104M424 26L384 68M424 102L384 68" style="fill:transparent;stroke-width:3;"></path></svg></div><div class="biaoyu">2.0版本，焕新归来！</div><div class="clist"><div class="item a">开始使用</div><div class="item b">导入数据</div><div class="item c">从QUIK1.x还原</div></div>'];o.forEach((function(t,e){n=n.replace("{{part"+(e+1)+"}}",t)})),n=n.replace("{{lic}}",e);var s=new dialog({content:n,class:"oobedia",mobileShowtype:dialog.SHOW_TYPE_FULLSCREEN,clickOtherToClose:!1}),a=s.getDialogDom();function c(){if(i>0&&(util.query(a,".part.a"+i).classList.remove("show"),util.query(a,".part.a"+i).classList.add("n")),i==o.length)return s.close(),void l();i++,setTimeout((function(){util.query(a,".part.a"+i).classList.add("show")}),200)}util.query(a,".part.a1 .btn.ok").onclick=function(){t.set("agree",!0),c()},util.query(a,".part.a1 .btn.cancel").onclick=function(){location.href="about:blank"},util.query(a,".part.a2 .item.a").onclick=function(){c()},util.query(a,".part.a2 .item.b").onclick=function(){c(),sync.openImport()},util.query(a,".part.a2 .item.c").onclick=function(){c(),sync.openQUIK1()},c(),s.open()}function l(){t.get("guided")||guidecreator.create([{text:"点击左下角的"+util.getGoogleIcon("e8b8",{type:"fill"})+"就可以打开设置，你可以在设置里个性化你的QUIK起始页",offset:{bottom:40,left:0}},{text:"QUIK起始页提供插件来拓展QUIK起始页的功能，点击"+util.getGoogleIcon("e87b",{type:"fill"})+"看看插件市场里是否有中意的吧",offset:{top:40,right:40}}],(function(){t.set("guided",!0)}))}if(t.get("jlcs")){if(-1!=t.get("jlcs")&&(t.set("jlcs",t.get("jlcs")+1),t.get("jlcs")>=2)){t.set("jlcs",-1);var r=new notice({title:"作者想说",content:"<div class='joinqqnot'>因为该起始页为纯前端项目，所以作者没有办法记录使用人数。</div><div class='joinqqnot'>如果你正在使用QUIK起始页的话，作者希望你能够加入QUIK起始页唯一官方QQ群，让作者知道QUIK起始页正在为人们发挥着作用，这将会给作者提供很大的动力来维护和更新QUIK起始页这个免费开源的项目。</div><div class='joinqqnot'>同时，QQ群是受理建议最快的渠道，并且你也有机会参与QUIK起始页的一些试验功能的测试。非常感谢！</div><div class='joinqqnot'>群号：971915865</div>",btns:[{text:"前往加入",style:"ok",click:function(){r.hide(),alert("再次表示感谢！",(function(){window.open("https://qm.qq.com/q/6nOculioy4")}))}}]});r.show()}}else t.set("jlcs",1)}();var _upaddon={},pbls=["runAddon","enable","disable","upupdate","upinstallByUrl","upinstallByOfficialMarket","upuninstall","installByLocal"];for(var k in addon)-1==pbls.indexOf(k)&&(_upaddon[k]=addon[k]);_upaddon.update=addon.upupdate,_upaddon.installByUrl=addon.upinstallByUrl,_upaddon.installByOfficialMarket=addon.upinstallByOfficialMarket,_upaddon.uninstall=addon.upuninstall,window.quik={searchEditor:searchEditor,guidecreator:guidecreator,fcard:fcard,custom:custom,sync:sync,addon:_upaddon,storage:storage,omnibox:omnibox,util:util,link:link,dialog:dialog,toast:toast,says:says,menu:menu,iconc:iconc,background:background,mainmenu:mainmenu,Setting:Setting,SettingGroup:SettingGroup,SettingItem:SettingItem,mainSetting:mainSetting,notice:notice,tyGroup:tyGroup,alert:alert,confirm:confirm,prompt:prompt,card:card,getEventHandle:getEventHandle},window.util=util,custom.waitdotheme((function(){clearTimeout(loadingtimeout),document.querySelector(".loading-f").classList.add("h"),document.querySelector(".loading-f").style.display="none",document.querySelector("main").style.display="block",document.querySelector("main").style.opacity="1",onshows_fns.forEach((function(t){t()})),link.cateWidthShiPei()}));var f="@font-face {\n    font-family: 'Material Symbols Outlined';\n    font-style: normal;\n    font-weight: 100 700;\n    src: url($0) format('woff2');\n  }";window.isExt?util.addStyle(f.replace("$0","chrome-extension://"+window.extid+"/assets/google-icon.woff2")):util.addStyle(f.replace("$0","https://gstatic.loli.net/s/materialsymbolsoutlined/v164/kJEhBvYX7BgnkSrUwT8OhrdQw4oELdPIeeII9v6oFsI.woff2"))})();